fileVersion: 1
id: bc77961e-3f6d-4c35-86df-4ffa1be0326a
name: FCT_SALES
operation:
  config:
    postSQL: ""
    preSQL: ""
    testsEnabled: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: RMH_SQL_SERVER_SERVICE_STG
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 38ece501-a4dd-4891-9166-b035ad1dfc61
          stepCounter: bc77961e-3f6d-4c35-86df-4ffa1be0326a
        config: {}
        dataType: VARCHAR(32)
        description: ""
        name: ORDER_ID
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1b5d9612-628b-4517-9ff3-080bc53eced9
                stepCounter: a8dc3768-318c-40bf-8190-ae4883daa82a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2460c386-7244-4753-a773-cf9df50e80bd
          stepCounter: bc77961e-3f6d-4c35-86df-4ffa1be0326a
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: YR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 29f9328c-989c-4f3f-a931-925f07ec97df
                stepCounter: a8dc3768-318c-40bf-8190-ae4883daa82a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 19f065e5-e4a4-46b3-a4dd-8908b845b2e0
          stepCounter: bc77961e-3f6d-4c35-86df-4ffa1be0326a
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: PRD
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ecf755ae-c566-4b34-b698-f036f15c1983
                stepCounter: a8dc3768-318c-40bf-8190-ae4883daa82a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b66bf068-b414-4800-bc34-de1656ac81b7
          stepCounter: bc77961e-3f6d-4c35-86df-4ffa1be0326a
        config: {}
        dataType: VARCHAR(44)
        description: ""
        name: SLSPN_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6f77f9a9-edb8-4f5f-b947-2d3edf6d76b0
                stepCounter: a8dc3768-318c-40bf-8190-ae4883daa82a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d549f279-a56a-4ab7-879a-85bea2eb342c
          stepCounter: bc77961e-3f6d-4c35-86df-4ffa1be0326a
        config: {}
        dataType: VARCHAR(16)
        description: ""
        name: JOB_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 72172770-795e-44a4-88ee-f53988745145
                stepCounter: a8dc3768-318c-40bf-8190-ae4883daa82a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 25ae6d24-0935-453a-9be1-c8ab8339e653
          stepCounter: bc77961e-3f6d-4c35-86df-4ffa1be0326a
        config: {}
        dataType: TIMESTAMP_NTZ(9)
        description: ""
        name: INVOICE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 13793f0b-0726-4172-885c-c873e418e0f3
                stepCounter: a8dc3768-318c-40bf-8190-ae4883daa82a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dcad0834-6410-459d-9f20-cdc9d72d70f0
          stepCounter: bc77961e-3f6d-4c35-86df-4ffa1be0326a
        config: {}
        dataType: VARCHAR(100)
        description: ""
        name: SHIP_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f813ca12-1dcb-400e-8e5d-e7fd6fdcd0b9
                stepCounter: a8dc3768-318c-40bf-8190-ae4883daa82a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f5e3a29a-a1b8-4cde-b928-70cbeb8da8d9
          stepCounter: bc77961e-3f6d-4c35-86df-4ffa1be0326a
        config: {}
        dataType: VARCHAR(32)
        description: ""
        name: ITEM_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: eacb7e92-1edd-4651-9f1b-61386dad4fb9
                stepCounter: a8dc3768-318c-40bf-8190-ae4883daa82a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: da92be74-d1a7-445b-8bfa-29084a3b35d5
          stepCounter: bc77961e-3f6d-4c35-86df-4ffa1be0326a
        config: {}
        dataType: VARCHAR(16)
        description: Joins to DIM_CUSTOMER ID
        name: CUST_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 256bf39a-a98d-4066-a1c2-f90461dac16b
                stepCounter: a8dc3768-318c-40bf-8190-ae4883daa82a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4883824b-382c-49c4-818d-71defe103c7d
          stepCounter: bc77961e-3f6d-4c35-86df-4ffa1be0326a
        config: {}
        dataType: VARCHAR(80)
        description: ""
        name: SHIP_COUNTRY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5d9188f2-4ec0-450d-ab31-db038819d129
                stepCounter: a8dc3768-318c-40bf-8190-ae4883daa82a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5918bf0b-6a3e-4c87-a3e2-c316ae942786
          stepCounter: bc77961e-3f6d-4c35-86df-4ffa1be0326a
        config: {}
        dataType: VARCHAR(20)
        description: ""
        name: SHIP_ZIP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: becda6b5-a45d-4292-b0e8-dbe0c4077440
                stepCounter: a8dc3768-318c-40bf-8190-ae4883daa82a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4aee0141-2cf2-4399-ac68-b77ef0e48822
          stepCounter: bc77961e-3f6d-4c35-86df-4ffa1be0326a
        config: {}
        dataType: VARCHAR(10)
        description: ""
        name: SHIP_ST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bdd364cf-a707-4377-bb62-7a27f1f5e1c7
                stepCounter: a8dc3768-318c-40bf-8190-ae4883daa82a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e06380a3-26d6-4e35-959c-ba8f531d8c02
          stepCounter: bc77961e-3f6d-4c35-86df-4ffa1be0326a
        config: {}
        dataType: VARCHAR(40)
        description: ""
        name: SHIP_CITY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c88082c2-d55d-478e-8bb5-68794a5aa1e3
                stepCounter: a8dc3768-318c-40bf-8190-ae4883daa82a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ca9391f9-1656-45f8-8138-3b4d26868a45
          stepCounter: bc77961e-3f6d-4c35-86df-4ffa1be0326a
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: QTY_SHIPPED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 11a9dc4b-4590-48f3-9afd-8732b728bc58
                stepCounter: a8dc3768-318c-40bf-8190-ae4883daa82a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cd1858ea-2d60-4ba6-9d1e-77a93659f755
          stepCounter: bc77961e-3f6d-4c35-86df-4ffa1be0326a
        config: {}
        dataType: NUMBER(19,4)
        description: ""
        name: NET_PRICE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9937b02a-60d4-498a-bdc5-052f5a4b74a6
                stepCounter: a8dc3768-318c-40bf-8190-ae4883daa82a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4e2712e7-b94e-4c95-8997-fa313ca38c92
          stepCounter: bc77961e-3f6d-4c35-86df-4ffa1be0326a
        config: {}
        dataType: NUMBER(15,2)
        description: ""
        name: EDF
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d106b5ef-626b-48f5-bf42-f7184d2d2715
                stepCounter: a8dc3768-318c-40bf-8190-ae4883daa82a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0f054edd-4458-45ec-a9a3-9d8f063e9024
          stepCounter: bc77961e-3f6d-4c35-86df-4ffa1be0326a
        config: {}
        dataType: NUMBER(38, 2)
        description: ""
        name: REVENUE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ad1d9f2b-d413-4fe6-98a2-08187ae4eaa6
                stepCounter: a8dc3768-318c-40bf-8190-ae4883daa82a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fbda9a57-75f7-4081-8060-ba401ac7e116
          stepCounter: bc77961e-3f6d-4c35-86df-4ffa1be0326a
        config: {}
        dataType: NUMBER(16,2)
        description: ""
        name: GROSS_AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3030a36b-23d0-43ea-bfea-ce4d59ffaeca
                stepCounter: a8dc3768-318c-40bf-8190-ae4883daa82a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a8005824-b97b-469d-8a75-8989ffa034dc
          stepCounter: bc77961e-3f6d-4c35-86df-4ffa1be0326a
        config: {}
        dataType: NUMBER(38, 2)
        description: ""
        name: TOTAL_COST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3b3a6896-b27c-42ae-a86b-b53017421f76
                stepCounter: a8dc3768-318c-40bf-8190-ae4883daa82a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3db4541b-a0ee-43d8-acd6-f89523a59721
          stepCounter: bc77961e-3f6d-4c35-86df-4ffa1be0326a
        config: {}
        dataType: NUMBER(38,2)
        description: ""
        name: GROSS_PROFIT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b1dbda7e-8684-470a-ac32-347b1a523e0b
                stepCounter: a8dc3768-318c-40bf-8190-ae4883daa82a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 78b075f1-6123-4394-aa43-9682e54fe4e7
          stepCounter: bc77961e-3f6d-4c35-86df-4ffa1be0326a
        config: {}
        dataType: NUMBER(38, 2)
        description: ""
        name: PROFIT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3f72c010-4107-4bf9-9e59-0a4bf16f6216
                stepCounter: a8dc3768-318c-40bf-8190-ae4883daa82a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 00ce7fc2-5e9a-4142-980c-c83fdc33e055
          stepCounter: bc77961e-3f6d-4c35-86df-4ffa1be0326a
        config: {}
        dataType: TIMESTAMP_TZ(9)
        description: ""
        name: ORDER_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 84b7727d-034b-4060-a15d-54057a5728d7
                stepCounter: a8dc3768-318c-40bf-8190-ae4883daa82a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 66660973-f66e-4300-a70c-8c2caf285446
          stepCounter: bc77961e-3f6d-4c35-86df-4ffa1be0326a
        config: {}
        dataType: VARCHAR(40)
        description: ""
        name: FIELD_7
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: af080b71-2452-4cbd-88fa-38bbc7be020b
                stepCounter: a8dc3768-318c-40bf-8190-ae4883daa82a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1d393d3a-6c44-4899-b767-5f39e98ec27b
          stepCounter: bc77961e-3f6d-4c35-86df-4ffa1be0326a
        config: {}
        dataType: VARCHAR(8)
        description: ""
        name: PROD_GROUP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5a26bdf5-6990-48b0-a9db-bc7ac7f19d1b
                stepCounter: a8dc3768-318c-40bf-8190-ae4883daa82a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e5c3c18b-d49d-497b-aade-dec558085f2f
          stepCounter: bc77961e-3f6d-4c35-86df-4ffa1be0326a
        config: {}
        dataType: VARCHAR(8)
        description: ""
        name: SEGMENT_KEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d6deb7cd-521f-4876-8d34-58751ed72da0
                stepCounter: a8dc3768-318c-40bf-8190-ae4883daa82a
            transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 05f202c3-df7c-41fe-9455-23ba04b9ae93
          stepCounter: bc77961e-3f6d-4c35-86df-4ffa1be0326a
        config: {}
        dataType: VARCHAR(40)
        defaultValue: ""
        description: ""
        keyColumnType: None
        name: IS_SERVICE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: |
              CASE    
                  WHEN LEFT("ORDER_ID", 1) = '3'
                  THEN 'YES'
                  ELSE 'NO'
              END 
        systemColumnType: None
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 1652d667-48dd-405a-95a3-1a7d8745a1cb
          stepCounter: bc77961e-3f6d-4c35-86df-4ffa1be0326a
        config: {}
        dataType: DATE
        defaultValue: ""
        description: ""
        keyColumnType: None
        name: TRANSACTION_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: CONCAT("YR", '-', "PRD", '-', '01')
        systemColumnType: None
    cteString: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          STG_SALES_TRANSACTIONS_WITH_CALCULATIONS_PROFIT: a8dc3768-318c-40bf-8190-ae4883daa82a
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: RMH_SQL_SERVER_SERVICE_STG
            nodeName: STG_SALES_TRANSACTIONS_WITH_CALCULATIONS_PROFIT
        join:
          joinCondition: |
            FROM {{ ref('RMH_SQL_SERVER_SERVICE_STG', 'STG_SALES_TRANSACTIONS_WITH_CALCULATIONS_PROFIT') }} "STG_SALES_TRANSACTIONS_WITH_CALCULATIONS_PROFIT"
             WHERE "PROD_GROUP" NOT IN ('103', '103F', '199', '199F', '331', '331F', '333', '333F', 
                                            '399', '399F', '450', '450F', '453', '453F', '490', '490F', '499', '499F')
            
            
        name: FCT_SALES
        noLinkRefs: []
  name: FCT_SALES
  overrideSQL: false
  schema: ""
  sqlType: Fact
  type: sql
  version: 1
type: Node

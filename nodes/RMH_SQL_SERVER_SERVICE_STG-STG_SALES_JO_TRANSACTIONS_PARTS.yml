fileVersion: 1
id: 878a4dfe-e150-4eed-a289-7763a1784758
name: STG_SALES_JO_TRANSACTIONS_PARTS
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: RMH_SQL_SERVER_SERVICE_STG
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2af9a4d9-c9b3-400e-b238-d7d3a9fd0c94
          stepCounter: 878a4dfe-e150-4eed-a289-7763a1784758
        config: {}
        dataType: VARCHAR(16)
        description: ""
        name: JOB_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ac1ee190-2026-4c0c-98ee-a4461b09a824
                stepCounter: 21b6706f-2ac8-4bac-801b-8121fee9a187
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 864f8242-91ef-400f-b9c8-e490c9f7b6e4
          stepCounter: 878a4dfe-e150-4eed-a289-7763a1784758
        config: {}
        dataType: TIMESTAMP_NTZ(9)
        description: ""
        name: CREATEDDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cd7da670-8d8f-4364-af0e-4e81848099c9
                stepCounter: 21b6706f-2ac8-4bac-801b-8121fee9a187
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 98003eb9-4f6e-48a6-a275-ddbdf7be313c
          stepCounter: 878a4dfe-e150-4eed-a289-7763a1784758
        config: {}
        dataType: VARCHAR(60)
        description: ""
        name: SHIP_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ffdbabf6-7115-40d7-8dd5-e5a6f0711410
                stepCounter: 27720352-8ff5-4e56-8f86-14485d69316e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 649511af-15f3-4f5e-a60e-29299f958729
          stepCounter: 878a4dfe-e150-4eed-a289-7763a1784758
        config: {}
        dataType: VARCHAR(50)
        description: ""
        name: SHIP_COMPLETE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2e975b56-6e86-4747-bf8e-f625b71ca44f
                stepCounter: 27720352-8ff5-4e56-8f86-14485d69316e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cb6aeb13-7d51-4029-9d6e-61ff1ba933f9
          stepCounter: 878a4dfe-e150-4eed-a289-7763a1784758
        config: {}
        dataType: VARCHAR(40)
        description: ""
        name: SHIP_COUNTRY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3a972521-2819-487e-be79-fd36b46b2a74
                stepCounter: 27720352-8ff5-4e56-8f86-14485d69316e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dad67a6b-3c9b-4a72-a9ac-005de38f1ce7
          stepCounter: 878a4dfe-e150-4eed-a289-7763a1784758
        config: {}
        dataType: VARCHAR(10)
        description: ""
        name: SHIP_STATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d2f56137-3338-48cf-96c6-cf3ed95efa5a
                stepCounter: 27720352-8ff5-4e56-8f86-14485d69316e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 271cc500-11ee-4d5a-8e71-a80cb9306662
          stepCounter: 878a4dfe-e150-4eed-a289-7763a1784758
        config: {}
        dataType: VARCHAR(20)
        description: ""
        name: SHIP_ZIP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 62af2b52-f6b2-4073-9a1c-439a4402e8c3
                stepCounter: 27720352-8ff5-4e56-8f86-14485d69316e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e3c2db01-ed7a-4e56-93d5-d7f41a9747fa
          stepCounter: 878a4dfe-e150-4eed-a289-7763a1784758
        config: {}
        dataType: VARCHAR(40)
        description: ""
        name: SHIP_CITY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0d1475d4-44df-4ab3-bfea-b027b0210bde
                stepCounter: 27720352-8ff5-4e56-8f86-14485d69316e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1c32aff4-96a4-4a9f-a66c-a06b4b2a2a93
          stepCounter: 878a4dfe-e150-4eed-a289-7763a1784758
        config: {}
        dataType: VARCHAR(2000)
        description: ""
        name: SLSPN_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 004a0b92-930f-464e-82d5-89e66ba0df18
                stepCounter: 21b6706f-2ac8-4bac-801b-8121fee9a187
            transform: "'Parts'"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 32433b18-4699-4b01-8daf-26d0decdea84
          stepCounter: 878a4dfe-e150-4eed-a289-7763a1784758
        config: {}
        dataType: NUMBER(15,2)
        description: ""
        name: COMM_ALLOCATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e3e47295-624f-4061-8671-7f89835e2312
                stepCounter: 21b6706f-2ac8-4bac-801b-8121fee9a187
            transform: "100"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8396ef25-c2d0-4344-a327-7f223bf8d7de
          stepCounter: 878a4dfe-e150-4eed-a289-7763a1784758
        config: {}
        dataType: NUMBER(15,2)
        description: ""
        name: GROSS_AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 74776ced-38dd-4887-bcb8-0cec7df49ab8
                stepCounter: 27720352-8ff5-4e56-8f86-14485d69316e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ffc5284b-deb1-4e72-a756-972e952c9936
          stepCounter: 878a4dfe-e150-4eed-a289-7763a1784758
        config: {}
        dataType: TIMESTAMP_NTZ(9)
        description: ""
        name: ATIME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7f21c793-3074-4ddb-9524-396626517e0f
                stepCounter: 27720352-8ff5-4e56-8f86-14485d69316e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b21c027d-8306-4031-b7aa-c00cfd2b3a55
          stepCounter: 878a4dfe-e150-4eed-a289-7763a1784758
        config: {}
        dataType: TIMESTAMP_NTZ(9)
        description: ""
        name: JO_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 75854497-a442-4e54-b630-b58f58a2f884
                stepCounter: 21b6706f-2ac8-4bac-801b-8121fee9a187
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 32c9fd2a-90b6-42fd-aa92-c929eedd9e61
          stepCounter: 878a4dfe-e150-4eed-a289-7763a1784758
        config: {}
        dataType: VARCHAR(16)
        description: ""
        name: CUST_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9db0b5c0-8d91-4896-9034-4ddc84014162
                stepCounter: 27720352-8ff5-4e56-8f86-14485d69316e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 42abe29f-f31d-4f4e-9403-d8628a170e82
          stepCounter: 878a4dfe-e150-4eed-a289-7763a1784758
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: SEQ_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7a555172-bfc5-450b-9d3d-a4f023cd01ae
                stepCounter: 3a9d2d43-84c5-4973-80e7-b9c73c2232f7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 11df9ae3-e801-455c-8a76-4346085079b1
          stepCounter: 878a4dfe-e150-4eed-a289-7763a1784758
        config: {}
        dataType: VARCHAR(40)
        description: ""
        name: SOURCE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 17c23392-b13e-4eac-be99-8efbe088ccca
                stepCounter: 3a9d2d43-84c5-4973-80e7-b9c73c2232f7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8fbb3e39-b4e4-4a5a-a4fa-28bebc5c96c0
          stepCounter: 878a4dfe-e150-4eed-a289-7763a1784758
        config: {}
        dataType: VARCHAR(2000)
        description: ""
        name: FIELD_7
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cdf748c3-66de-4527-ab22-4e1eb001b9b2
                stepCounter: 27720352-8ff5-4e56-8f86-14485d69316e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5c957b9a-508b-49e1-9b9d-6f3b6fa0fc26
          stepCounter: 878a4dfe-e150-4eed-a289-7763a1784758
        config: {}
        dataType: VARCHAR(8)
        description: ""
        name: ITEM_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3a2292b0-c635-46cf-9e41-cddea2ebb553
                stepCounter: 27720352-8ff5-4e56-8f86-14485d69316e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 46c2c9d0-9632-466d-b0ff-0daadf4de43b
          stepCounter: 878a4dfe-e150-4eed-a289-7763a1784758
        config: {}
        dataType: VARCHAR(8)
        description: ""
        name: PROD_GROUP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8accbf1e-0807-47ed-b0d9-3a38b774188e
                stepCounter: ff14b386-d96c-4cb6-ac64-244703e4ef8e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 49b52baf-f626-459e-88cb-01b2e2cabc5e
          stepCounter: 878a4dfe-e150-4eed-a289-7763a1784758
        config: {}
        dataType: VARCHAR(50)
        description: ""
        name: DESCRIPTION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1c7c3504-2fa8-401d-955d-d8071abed474
                stepCounter: ff14b386-d96c-4cb6-ac64-244703e4ef8e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2a421201-ec11-41cc-bed7-1c3d3bb763ed
          stepCounter: 878a4dfe-e150-4eed-a289-7763a1784758
        config: {}
        dataType: NUMBER(16,2)
        description: ""
        name: CREDIT_AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4e577fc4-2684-4990-a6d1-4446f4ddcbe0
                stepCounter: 3a9d2d43-84c5-4973-80e7-b9c73c2232f7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5bdd44cc-ea22-471d-893a-b046780f482f
          stepCounter: 878a4dfe-e150-4eed-a289-7763a1784758
        config: {}
        dataType: NUMBER(38,2)
        description: ""
        name: GL_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 38845293-eab5-464b-b601-bdc1be3390e5
                stepCounter: 3a9d2d43-84c5-4973-80e7-b9c73c2232f7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3babb7d3-d3a4-4a8d-baf2-6bd9e8773d4e
          stepCounter: 878a4dfe-e150-4eed-a289-7763a1784758
        config: {}
        dataType: NUMBER(16,2)
        description: ""
        name: DEBIT_AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7be8dfc8-49a8-4d91-bed1-29f3903109d1
                stepCounter: 3a9d2d43-84c5-4973-80e7-b9c73c2232f7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 99fe24e8-92d0-4a3b-b230-d7b06848427b
          stepCounter: 878a4dfe-e150-4eed-a289-7763a1784758
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: YR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a438ed08-66c5-4e3c-a4fb-2b7fa358e3d4
                stepCounter: 3a9d2d43-84c5-4973-80e7-b9c73c2232f7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 39914f55-3419-41cd-b022-3d78c1c7b5c0
          stepCounter: 878a4dfe-e150-4eed-a289-7763a1784758
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: PRD
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ed34ca05-cfba-4772-8abd-f7ef2245c38a
                stepCounter: 3a9d2d43-84c5-4973-80e7-b9c73c2232f7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 515e1218-3481-41d7-bd1f-5887e1379a32
          stepCounter: 878a4dfe-e150-4eed-a289-7763a1784758
        config: {}
        dataType: TIMESTAMP_NTZ(9)
        description: ""
        name: GL_CREATEDDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 528a704f-1a2b-4480-a136-27d0341d809e
                stepCounter: 3a9d2d43-84c5-4973-80e7-b9c73c2232f7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b03a4e1b-456d-4df4-aad2-ec12b500a8e5
          stepCounter: 878a4dfe-e150-4eed-a289-7763a1784758
        config: {}
        dataType: VARCHAR(12)
        description: ""
        name: VENDOR_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 33edee7f-bbc6-4310-af47-8393eeb894a8
                stepCounter: 3a9d2d43-84c5-4973-80e7-b9c73c2232f7
            transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 1e1724ff-d6a8-4e09-b430-1732b7e8aefb
          stepCounter: 878a4dfe-e150-4eed-a289-7763a1784758
        config: {}
        dataType: NUMBER(15,2)
        defaultValue: ""
        description: ""
        keyColumnType: None
        name: EDF
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: |-
              CASE
              		WHEN "STG_JOB"."CREATE_DATE" < '01/01/2025' THEN 0
              		WHEN "STG_JOB"."JOB_NO" IN ('40-400582') THEN 0
              		WHEN LEFT("STG_PR_GROUP"."PROD_GROUP",3) IN ('180','181') AND ("STG_GL_DETAIL"."SOURCE_CODE" = 'SA' OR ("STG_GL_DETAIL"."SOURCE_CODE" = 'CS' AND "GL_CODE" BETWEEN 40000 AND 49999)) THEN ("CREDIT_AMT" - "DEBIT_AMT") * 2 / 100
              		WHEN LEFT("STG_PR_GROUP"."PROD_GROUP",3) IN ('100','146','171','147','172','173','174','175','176','177','178','179','183','184','185','186','187','188','189','190','400','402','404','406','408','411','412','414','416','420','424','426','427','448','550','551','552')
              		AND ("STG_GL_DETAIL"."SOURCE_CODE" = 'SA' OR ("STG_GL_DETAIL"."SOURCE_CODE" = 'CS' AND "GL_CODE" BETWEEN 40000 AND 49999)) THEN ("CREDIT_AMT" - "DEBIT_AMT") * 1 / 100
                      WHEN "STG_JOB"."CREATE_DATE" > '11/14/2025' AND LEFT("STG_PR_GROUP"."PROD_GROUP",3) IN ('326') AND ("STG_GL_DETAIL"."SOURCE_CODE" = 'SA' OR ("STG_GL_DETAIL"."SOURCE_CODE" = 'CS' AND "GL_CODE" BETWEEN 40000 AND 49999)) THEN ("CREDIT_AMT" - "DEBIT_AMT") * 2 / 100
              		ELSE 0 
              END
        systemColumnType: None
    cteString: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          STG_GL_DETAIL: 3a9d2d43-84c5-4973-80e7-b9c73c2232f7
          STG_JOB: 27720352-8ff5-4e56-8f86-14485d69316e
          STG_JOB_ORDER: 21b6706f-2ac8-4bac-801b-8121fee9a187
          STG_JOB_TYPE: 22ec5440-d364-4300-a552-c74cc32143bd
          STG_PR_GROUP: ff14b386-d96c-4cb6-ac64-244703e4ef8e
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: RMH_SQL_SERVER_SERVICE_STG
            nodeName: STG_GL_DETAIL
          - locationName: RMH_SQL_SERVER_SERVICE_STG
            nodeName: STG_JOB
          - locationName: RMH_SQL_SERVER_SERVICE_STG
            nodeName: STG_JOB_ORDER
          - locationName: RMH_SQL_SERVER_SERVICE_STG
            nodeName: STG_JOB_TYPE
          - locationName: RMH_SQL_SERVER_SERVICE_STG
            nodeName: STG_PR_GROUP
        join:
          joinCondition: |-
            FROM {{ ref('RMH_SQL_SERVER_SERVICE_STG', 'STG_JOB_ORDER') }} "STG_JOB_ORDER"
            LEFT JOIN {{ ref('RMH_SQL_SERVER_SERVICE_STG', 'STG_GL_DETAIL') }} "STG_GL_DETAIL"
            ON "STG_JOB_ORDER"."JOB_NO" = "STG_GL_DETAIL"."JOB_NO" AND "STG_JOB_ORDER"."CHG_ORD_NO" = "STG_GL_DETAIL"."CHGORDNO"
            LEFT JOIN {{ ref('RMH_SQL_SERVER_SERVICE_STG', 'STG_JOB') }} "STG_JOB"
            ON "STG_JOB_ORDER"."JOB_NO" = "STG_JOB"."JOB_NO"
            LEFT JOIN {{ ref('RMH_SQL_SERVER_SERVICE_STG', 'STG_JOB_TYPE') }} "STG_JOB_TYPE"
            ON "STG_JOB"."TYPE_CODE" = "STG_JOB_TYPE"."TYPE_CODE"
            LEFT JOIN {{ ref('RMH_SQL_SERVER_SERVICE_STG', 'STG_PR_GROUP') }} "STG_PR_GROUP"
            ON "STG_JOB"."TYPE_CODE" = "STG_PR_GROUP"."PROD_GROUP"


            WHERE   "STG_PR_GROUP"."PROD_GROUP" IN ('103', '103F', '199', '199F', '331', '331F', '333', '333F', '399', '399F', '450', '450F', '453', '453F', '490', '490F', '499', '499F')
        name: STG_SALES_JO_TRANSACTIONS_PARTS
        noLinkRefs: []
  name: STG_SALES_JO_TRANSACTIONS_PARTS
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node

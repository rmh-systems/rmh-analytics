fileVersion: 1
id: cfaf03ac-c795-4418-8a84-8e7cafdaac02
name: STG_SALES_WO_TRANSACTIONS_LA_SLPSN_1
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: RMH_SQL_SERVER_SERVICE_STG
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7833a946-1319-40df-a83e-169939a4ccd5
          stepCounter: cfaf03ac-c795-4418-8a84-8e7cafdaac02
        config: {}
        dataType: VARCHAR(12)
        description: ""
        name: WO_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 751d67e7-01fd-4804-b7e4-6e47a43a77b6
                stepCounter: af53fc6c-dbe9-49dc-a793-5a3298e9d4cb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0d869e62-c45d-486d-9742-d8af8ab6142c
          stepCounter: cfaf03ac-c795-4418-8a84-8e7cafdaac02
        config: {}
        dataType: TIMESTAMP_TZ(9)
        description: ""
        name: UTCCREATEDDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b6a21077-ceec-4255-a855-2d6185d5237b
                stepCounter: af53fc6c-dbe9-49dc-a793-5a3298e9d4cb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 73f5feae-6e2f-40ff-a576-7aea2f115b06
          stepCounter: cfaf03ac-c795-4418-8a84-8e7cafdaac02
        config: {}
        dataType: VARCHAR(80)
        description: ""
        name: SHIP_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a05354bd-2a7b-47ef-8b2b-a553f04b2dd2
                stepCounter: af53fc6c-dbe9-49dc-a793-5a3298e9d4cb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1c08b782-55eb-46e8-b3c5-f17c29985049
          stepCounter: cfaf03ac-c795-4418-8a84-8e7cafdaac02
        config: {}
        dataType: BOOLEAN
        description: ""
        name: SHIP_COMPLETE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 747987b4-638b-4cfc-8b4e-8fea7708808e
                stepCounter: af53fc6c-dbe9-49dc-a793-5a3298e9d4cb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2428581a-be49-466d-98d9-b17874f17bda
          stepCounter: cfaf03ac-c795-4418-8a84-8e7cafdaac02
        config: {}
        dataType: VARCHAR(80)
        description: ""
        name: SHIP_COUNTRY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e6a3440c-fde7-4dfe-a31c-33ff28f92a5c
                stepCounter: af53fc6c-dbe9-49dc-a793-5a3298e9d4cb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4640a721-856f-4cc9-80c2-e4cf19673cb7
          stepCounter: cfaf03ac-c795-4418-8a84-8e7cafdaac02
        config: {}
        dataType: VARCHAR(10)
        description: ""
        name: SHIP_ST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fb72461d-5692-4e99-8950-889b9504bcb1
                stepCounter: af53fc6c-dbe9-49dc-a793-5a3298e9d4cb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2abd5641-d9ab-4de0-8d90-e3c9ee71f79d
          stepCounter: cfaf03ac-c795-4418-8a84-8e7cafdaac02
        config: {}
        dataType: VARCHAR(44)
        description: ""
        name: SLSPN_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0e9a8a67-fdb0-4eb4-b45c-c32a43120015
                stepCounter: af53fc6c-dbe9-49dc-a793-5a3298e9d4cb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c7cce6be-64c8-4683-b3c4-08656d5ace95
          stepCounter: cfaf03ac-c795-4418-8a84-8e7cafdaac02
        config: {}
        dataType: NUMBER(15,2)
        description: ""
        name: COMM_ALLOCATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7698cfec-991e-4f61-984b-f7ecc85f9999
                stepCounter: af53fc6c-dbe9-49dc-a793-5a3298e9d4cb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9a7b65f8-5499-43bd-aefe-107e69bb1a7f
          stepCounter: cfaf03ac-c795-4418-8a84-8e7cafdaac02
        config: {}
        dataType: VARCHAR(20)
        description: ""
        name: SHIP_ZIP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 432bb3ad-248f-4599-8ab4-887a9ce3a794
                stepCounter: af53fc6c-dbe9-49dc-a793-5a3298e9d4cb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 03fa4156-f276-4c5b-84af-969f41afe2c0
          stepCounter: cfaf03ac-c795-4418-8a84-8e7cafdaac02
        config: {}
        dataType: VARCHAR(40)
        description: ""
        name: SHIP_CITY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a7534456-3ebd-414a-9d03-91b66ace64b5
                stepCounter: af53fc6c-dbe9-49dc-a793-5a3298e9d4cb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 70202d0c-4fe1-420b-a474-3f80788913f3
          stepCounter: cfaf03ac-c795-4418-8a84-8e7cafdaac02
        config: {}
        dataType: NUMBER(15,4)
        description: ""
        name: GROSS_AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 95c6182e-c199-4567-a164-2e95e83b6b4a
                stepCounter: af53fc6c-dbe9-49dc-a793-5a3298e9d4cb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 87a20042-5903-4848-8cc9-af47d8163ba2
          stepCounter: cfaf03ac-c795-4418-8a84-8e7cafdaac02
        config: {}
        dataType: VARCHAR(10)
        description: ""
        name: ATIME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 66d3e911-cc41-43f0-bcf0-2bf74d77ec75
                stepCounter: af53fc6c-dbe9-49dc-a793-5a3298e9d4cb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 07e4bb1f-e79d-486e-b9d9-13cb81c7b6a5
          stepCounter: cfaf03ac-c795-4418-8a84-8e7cafdaac02
        config: {}
        dataType: VARCHAR(16)
        description: ""
        name: JOB_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 397f2826-534e-434a-8e66-10db8b53f1f4
                stepCounter: af53fc6c-dbe9-49dc-a793-5a3298e9d4cb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dbcec375-7bed-4b11-a901-85e3e2c8d435
          stepCounter: cfaf03ac-c795-4418-8a84-8e7cafdaac02
        config: {}
        dataType: TIMESTAMP_NTZ(9)
        description: ""
        name: WO_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3a967bbd-7058-4eb8-b866-e7ac1bebe212
                stepCounter: af53fc6c-dbe9-49dc-a793-5a3298e9d4cb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5593513d-595a-4b57-8cb8-2eb3c1998c99
          stepCounter: cfaf03ac-c795-4418-8a84-8e7cafdaac02
        config: {}
        dataType: VARCHAR(12)
        description: ""
        name: VENDOR_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: "' '"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3e764069-c50d-4750-b652-d64d546731a0
          stepCounter: cfaf03ac-c795-4418-8a84-8e7cafdaac02
        config: {}
        dataType: VARCHAR(16)
        description: ""
        name: CUST_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: "' '"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2398c6e8-208c-4aaf-8c7a-e3d702ecc749
          stepCounter: cfaf03ac-c795-4418-8a84-8e7cafdaac02
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: SEQ_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: "0"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 66288747-92cf-4c9f-92f6-cfad047752ce
          stepCounter: cfaf03ac-c795-4418-8a84-8e7cafdaac02
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: QTY_SHIPPED
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: "0"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8c35d129-fd9b-45da-8df5-ec291b93b13c
          stepCounter: cfaf03ac-c795-4418-8a84-8e7cafdaac02
        config: {}
        dataType: NUMBER(17,4)
        description: ""
        name: COST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a787ecf8-2c5b-472e-ad15-372f3a379a56
                stepCounter: b4ffac55-8cb6-480d-8822-bda521cdbf24
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e24546d4-2798-43ef-a096-80ef9ce085a2
          stepCounter: cfaf03ac-c795-4418-8a84-8e7cafdaac02
        config: {}
        dataType: VARCHAR(40)
        description: ""
        name: FIELD_7
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: debe9b81-16aa-4daa-9cf5-3a5092759b4d
                stepCounter: af53fc6c-dbe9-49dc-a793-5a3298e9d4cb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7bf97748-412f-4fbb-9311-3252a0b4d0f7
          stepCounter: cfaf03ac-c795-4418-8a84-8e7cafdaac02
        config: {}
        dataType: VARCHAR(32)
        description: ""
        name: ITEM_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: "'Labor'"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a060a73c-d203-49c5-9d91-d9ed4ee77849
          stepCounter: cfaf03ac-c795-4418-8a84-8e7cafdaac02
        config: {}
        dataType: VARCHAR(8)
        description: ""
        name: UOM_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: "' '"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ce379dc6-59ec-4e33-9b9c-0867d15c510c
          stepCounter: cfaf03ac-c795-4418-8a84-8e7cafdaac02
        config: {}
        dataType: VARCHAR(8)
        description: ""
        name: COMM_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0be355c1-3408-450b-8bb0-9f4198b58f04
                stepCounter: af53fc6c-dbe9-49dc-a793-5a3298e9d4cb
            transform: |-
              CASE 
                  WHEN "STG_WO"."FIELD_10" = 'DIRECT' THEN 'DIR' WHEN "STG_WO"."FIELD_10" = 'INSTOCK' THEN 'INS' 
                  ELSE ''
              END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ac428e97-53cf-4c8d-aac9-3dfaff62e19d
          stepCounter: cfaf03ac-c795-4418-8a84-8e7cafdaac02
        config: {}
        dataType: NUMBER(7,2)
        description: ""
        name: COMM_RATE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: "0"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dbcd2d00-f060-4538-8b66-04ad5c91c6db
          stepCounter: cfaf03ac-c795-4418-8a84-8e7cafdaac02
        config: {}
        dataType: NUMBER(19,4)
        description: ""
        name: NET_PRICE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: "0"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: aff3b9b8-d2e2-4e8a-8ed8-535b66eb7022
          stepCounter: cfaf03ac-c795-4418-8a84-8e7cafdaac02
        config: {}
        dataType: VARCHAR(256)
        description: ""
        name: ITEM_VENDOR
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: "' '"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a5609fd5-5bf7-4463-8357-726d8d3b00f7
          stepCounter: cfaf03ac-c795-4418-8a84-8e7cafdaac02
        config: {}
        dataType: NUMBER(18,4)
        description: ""
        name: GROSS_PRICE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: "0"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 033fff0e-92af-4e06-9320-4e89d4290845
          stepCounter: cfaf03ac-c795-4418-8a84-8e7cafdaac02
        config: {}
        dataType: VARCHAR(8)
        description: ""
        name: INVOICE_SLSPN_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: "' '"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1bda5b5c-7d3e-4767-b7e5-f354de982fc1
          stepCounter: cfaf03ac-c795-4418-8a84-8e7cafdaac02
        config: {}
        dataType: VARCHAR(16)
        description: ""
        name: DOCUMENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 50a190be-262d-4c92-bd7f-570852dafe00
                stepCounter: b4ffac55-8cb6-480d-8822-bda521cdbf24
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c7cd9ade-be3c-49e8-86ad-d07807fbd38d
          stepCounter: cfaf03ac-c795-4418-8a84-8e7cafdaac02
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: PRD
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c302ecdf-e32a-432f-8038-249b61cecb63
                stepCounter: b4ffac55-8cb6-480d-8822-bda521cdbf24
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2a01d6ac-725d-4fd1-92a2-0e7b6a3505a4
          stepCounter: cfaf03ac-c795-4418-8a84-8e7cafdaac02
        config: {}
        dataType: TIMESTAMP_NTZ(9)
        description: ""
        name: INVOICE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 22e127a7-0aa6-4c7b-a794-c5e1c4d60a4f
                stepCounter: b4ffac55-8cb6-480d-8822-bda521cdbf24
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8424c7a5-b909-4a1f-ae6e-6f8fc17f835d
          stepCounter: cfaf03ac-c795-4418-8a84-8e7cafdaac02
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: YR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 36cafd48-cc34-4688-9216-054f118dde94
                stepCounter: b4ffac55-8cb6-480d-8822-bda521cdbf24
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 11a1d404-e2f5-4ae0-8f37-135de9d1bac6
          stepCounter: cfaf03ac-c795-4418-8a84-8e7cafdaac02
        config: {}
        dataType: VARCHAR(8)
        description: ""
        name: PROD_GROUP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 96a5af32-be7e-44c5-999f-bf7a75289ca7
                stepCounter: af53fc6c-dbe9-49dc-a793-5a3298e9d4cb
            transform: |-
              CASE 
                  WHEN "STG_WO"."CALL_TYPE" = 'SINS' THEN '325' WHEN "STG_WO"."CALL_TYPE" = 'CRAN' THEN '325' WHEN "STG_WO"."CALL_TYPE" = 'PINS' THEN '400' ELSE ''
              END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 11079e6c-bf50-4de8-838f-449b55f03749
          stepCounter: cfaf03ac-c795-4418-8a84-8e7cafdaac02
        config: {}
        dataType: VARCHAR(32)
        description: ""
        name: PR_PROD_GROUP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 96a5af32-be7e-44c5-999f-bf7a75289ca7
                stepCounter: af53fc6c-dbe9-49dc-a793-5a3298e9d4cb
            transform: |-
              CASE 
                  WHEN "STG_WO"."CALL_TYPE" = 'SINS' THEN 'SCALES - OTHER'
                  WHEN "STG_WO"."CALL_TYPE" = 'CRAN' THEN 'SCALES - OTHER' 
                  WHEN "STG_WO"."CALL_TYPE" = 'PINS' THEN 'STRETCH EQUIPMENT' 
                  ELSE ''
              END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d0118418-c44a-4f03-9e5f-d6ec3704bab0
          stepCounter: cfaf03ac-c795-4418-8a84-8e7cafdaac02
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: UNIT
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: "0"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 46ff228f-4a17-4473-a96d-33727ba70cbb
          stepCounter: cfaf03ac-c795-4418-8a84-8e7cafdaac02
        config: {}
        dataType: NUMBER(13,2)
        description: ""
        name: EXTRA_CHARGE__9
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a787ecf8-2c5b-472e-ad15-372f3a379a56
                stepCounter: b4ffac55-8cb6-480d-8822-bda521cdbf24
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0ab88b78-8ddc-4b06-a7f6-5eb6935ebaa2
          stepCounter: cfaf03ac-c795-4418-8a84-8e7cafdaac02
        config: {}
        dataType: VARCHAR(8)
        description: ""
        name: CALL_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 96a5af32-be7e-44c5-999f-bf7a75289ca7
                stepCounter: af53fc6c-dbe9-49dc-a793-5a3298e9d4cb
            transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 59b229fe-3478-45ed-9435-42b8b04b75e3
          stepCounter: cfaf03ac-c795-4418-8a84-8e7cafdaac02
        config: {}
        dataType: NUMBER(15,2)
        defaultValue: ""
        description: ""
        keyColumnType: None
        name: EDF
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: "0"
        systemColumnType: None
    cteString: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          STG_INVOICE: b4ffac55-8cb6-480d-8822-bda521cdbf24
          STG_WO: af53fc6c-dbe9-49dc-a793-5a3298e9d4cb
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: RMH_SQL_SERVER_SERVICE_STG
            nodeName: STG_INVOICE
          - locationName: RMH_SQL_SERVER_SERVICE_STG
            nodeName: STG_WO
        join:
          joinCondition: |-
            FROM {{ ref('RMH_SQL_SERVER_SERVICE_STG', 'STG_INVOICE') }} "STG_INVOICE"
            LEFT JOIN {{ ref('RMH_SQL_SERVER_SERVICE_STG', 'STG_WO') }} "STG_WO"
            ON "STG_INVOICE"."DISP_NO" = "STG_WO"."WO_NO"



            WHERE "STG_WO"."CALL_TYPE" IN ('SINS', 'PINS', 'CRAN') AND "STG_INVOICE"."EXTRA_CHARGE__9" <> 0
        name: STG_SALES_WO_TRANSACTIONS_LA_SLPSN_1
        noLinkRefs: []
  name: STG_SALES_WO_TRANSACTIONS_LA_SLPSN_1
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node

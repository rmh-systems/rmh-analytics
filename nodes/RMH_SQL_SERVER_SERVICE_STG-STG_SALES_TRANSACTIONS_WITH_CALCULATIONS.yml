fileVersion: 1
id: 2d84dc99-7aec-4a21-b0b4-02b0c6bc06d4
name: STG_SALES_TRANSACTIONS_WITH_CALCULATIONS
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: RMH_SQL_SERVER_SERVICE_STG
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 79b72ec8-6fc7-4646-92b1-1b8d5266b02c
          stepCounter: 2d84dc99-7aec-4a21-b0b4-02b0c6bc06d4
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: ORDER_NO_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fadce4ea-ae9d-428d-b42b-0ca2879021b9
                stepCounter: 26612db0-e7e4-4e0a-9717-c27ac260b061
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 56cdc783-8430-4154-9d68-3527e299a574
          stepCounter: 2d84dc99-7aec-4a21-b0b4-02b0c6bc06d4
        config: {}
        dataType: VARCHAR(16)
        description: ""
        name: JOB_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8f2323cc-1456-441f-bf32-034735c5f3f3
                stepCounter: 26612db0-e7e4-4e0a-9717-c27ac260b061
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0e1ecbc6-27d4-40df-9793-2088543e2043
          stepCounter: 2d84dc99-7aec-4a21-b0b4-02b0c6bc06d4
        config: {}
        dataType: VARCHAR(32)
        description: ""
        name: ITEM_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 37f0823a-1d36-4020-a125-9d81995ecc61
                stepCounter: 26612db0-e7e4-4e0a-9717-c27ac260b061
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f5f2b117-673f-4788-a94e-10e943b0c057
          stepCounter: 2d84dc99-7aec-4a21-b0b4-02b0c6bc06d4
        config: {}
        dataType: VARCHAR(8)
        description: ""
        name: PROD_GROUP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 274a79b0-23fa-480b-8214-eb7fd423aa6d
                stepCounter: 26612db0-e7e4-4e0a-9717-c27ac260b061
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c7e0288b-3c33-4245-9983-537924d17427
          stepCounter: 2d84dc99-7aec-4a21-b0b4-02b0c6bc06d4
        config: {}
        dataType: VARCHAR(16)
        description: ""
        name: CUST_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7603c19a-5eef-4863-8b06-97518f95e877
                stepCounter: 26612db0-e7e4-4e0a-9717-c27ac260b061
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b8c2d3ef-9476-4e14-a001-f77e804a351e
          stepCounter: 2d84dc99-7aec-4a21-b0b4-02b0c6bc06d4
        config: {}
        dataType: VARCHAR(8)
        description: ""
        name: SLSPN_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a52606df-65a0-482b-8452-3b2dfa0a82ce
                stepCounter: 26612db0-e7e4-4e0a-9717-c27ac260b061
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 607d810f-bb73-4356-b0e4-bba3a92f740f
          stepCounter: 2d84dc99-7aec-4a21-b0b4-02b0c6bc06d4
        config: {}
        dataType: VARCHAR(40)
        description: ""
        name: SLSPN_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5f01e288-97c3-45d0-902d-cd58dcbd73fb
                stepCounter: 26612db0-e7e4-4e0a-9717-c27ac260b061
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fb4f18b9-d74a-4857-ae7c-4c3d175aa1b3
          stepCounter: 2d84dc99-7aec-4a21-b0b4-02b0c6bc06d4
        config: {}
        dataType: VARCHAR(100)
        description: ""
        name: SHIP_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bc3c94ee-1691-4422-a42f-19d7bbe214bf
                stepCounter: 26612db0-e7e4-4e0a-9717-c27ac260b061
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c914b645-b923-4da2-8819-4df32cf32b33
          stepCounter: 2d84dc99-7aec-4a21-b0b4-02b0c6bc06d4
        config: {}
        dataType: BOOLEAN
        description: ""
        name: SHIP_COMPLETE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9f06460c-33de-4695-b9a3-e767df507e92
                stepCounter: 26612db0-e7e4-4e0a-9717-c27ac260b061
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fcf2c993-e22d-4adf-a1c4-8f72304e1d95
          stepCounter: 2d84dc99-7aec-4a21-b0b4-02b0c6bc06d4
        config: {}
        dataType: VARCHAR(80)
        description: ""
        name: SHIP_COUNTRY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 77ad3d5b-2489-47f9-ae9c-b11d380b5551
                stepCounter: 26612db0-e7e4-4e0a-9717-c27ac260b061
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d838d09a-53bf-4b72-810b-fe0d390ea474
          stepCounter: 2d84dc99-7aec-4a21-b0b4-02b0c6bc06d4
        config: {}
        dataType: VARCHAR(10)
        description: ""
        name: SHIP_ST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3310030f-0455-43b2-86be-fba880d39b42
                stepCounter: 26612db0-e7e4-4e0a-9717-c27ac260b061
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 20e6d391-7d15-48a5-a489-b5e6aa7e0a6a
          stepCounter: 2d84dc99-7aec-4a21-b0b4-02b0c6bc06d4
        config: {}
        dataType: VARCHAR(20)
        description: ""
        name: SHIP_ZIP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a9e13ed5-2157-4e8c-9ea5-5bed9a220162
                stepCounter: 26612db0-e7e4-4e0a-9717-c27ac260b061
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c420b3a0-fae4-4e98-bc37-64e25de63519
          stepCounter: 2d84dc99-7aec-4a21-b0b4-02b0c6bc06d4
        config: {}
        dataType: VARCHAR(40)
        description: ""
        name: SHIP_CITY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5ec2d3b8-9a30-4100-850c-b48af8cfc94a
                stepCounter: 26612db0-e7e4-4e0a-9717-c27ac260b061
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d9df0204-7bc1-4d60-ab8b-bc4e2df0d617
          stepCounter: 2d84dc99-7aec-4a21-b0b4-02b0c6bc06d4
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: SEQ_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: affd1b08-e2d0-407e-82c5-e98e0f2e212f
                stepCounter: 26612db0-e7e4-4e0a-9717-c27ac260b061
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2efab453-8828-4ef9-b343-e34fbf3e07db
          stepCounter: 2d84dc99-7aec-4a21-b0b4-02b0c6bc06d4
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: QTY_SHIPPED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0ea18819-bb2b-42b2-b2ff-6dab17f7ccff
                stepCounter: 26612db0-e7e4-4e0a-9717-c27ac260b061
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 205f13f6-f278-436f-9446-ff52a8430397
          stepCounter: 2d84dc99-7aec-4a21-b0b4-02b0c6bc06d4
        config: {}
        dataType: NUMBER(19,4)
        description: ""
        name: NET_PRICE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 13ce6a01-9b97-4bbe-bfa3-089f68a8c983
                stepCounter: 26612db0-e7e4-4e0a-9717-c27ac260b061
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7f581c1a-9017-4fcd-a6d9-cc161d8f510b
          stepCounter: 2d84dc99-7aec-4a21-b0b4-02b0c6bc06d4
        config: {}
        dataType: NUMBER(16,2)
        description: ""
        name: GROSS_AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 96bdd9a9-36fd-4786-a0b4-f01f716b7826
                stepCounter: 26612db0-e7e4-4e0a-9717-c27ac260b061
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2f2c5308-9948-4fe0-a4c4-b3e8c1273517
          stepCounter: 2d84dc99-7aec-4a21-b0b4-02b0c6bc06d4
        config: {}
        dataType: NUMBER(17,4)
        description: ""
        name: COST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b50101b1-5141-4f8e-bf55-89887378f60e
                stepCounter: 26612db0-e7e4-4e0a-9717-c27ac260b061
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 82e0fbef-2cd5-4baa-b31c-4952ee95b182
          stepCounter: 2d84dc99-7aec-4a21-b0b4-02b0c6bc06d4
        config: {}
        dataType: VARCHAR(40)
        description: ""
        name: FIELD_7
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b5810e07-b7fa-4c50-93c2-a5c8ff0d285d
                stepCounter: 26612db0-e7e4-4e0a-9717-c27ac260b061
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c9829558-61cf-47fa-948d-3019a7c4c2fd
          stepCounter: 2d84dc99-7aec-4a21-b0b4-02b0c6bc06d4
        config: {}
        dataType: TIMESTAMP_NTZ(9)
        description: ""
        name: ORDER_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f2d1bb8e-e057-4920-9535-a0fc386112bd
                stepCounter: 26612db0-e7e4-4e0a-9717-c27ac260b061
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fab299f6-a210-47cb-ac71-121d0d1c5bd1
          stepCounter: 2d84dc99-7aec-4a21-b0b4-02b0c6bc06d4
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: YR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e7a05a6d-a867-45d7-ad2b-a03d9fb6a04e
                stepCounter: 26612db0-e7e4-4e0a-9717-c27ac260b061
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b67320b6-58df-4e46-82ed-51bade528fe6
          stepCounter: 2d84dc99-7aec-4a21-b0b4-02b0c6bc06d4
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: UNIT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c805907a-aa84-49c5-b043-17b82a9f3df2
                stepCounter: 26612db0-e7e4-4e0a-9717-c27ac260b061
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f80178b0-2048-4993-bc49-477ed7cd5ffd
          stepCounter: 2d84dc99-7aec-4a21-b0b4-02b0c6bc06d4
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: PRD
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e07f656a-fb11-48de-aad6-8a7a9cc4036d
                stepCounter: 26612db0-e7e4-4e0a-9717-c27ac260b061
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 20023c62-8f10-495c-bac4-e5cfc7097c44
          stepCounter: 2d84dc99-7aec-4a21-b0b4-02b0c6bc06d4
        config: {}
        dataType: VARCHAR(16)
        description: ""
        name: DOCUMENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 95f1bd7f-5631-44f0-a7ed-a785f6816ed2
                stepCounter: 26612db0-e7e4-4e0a-9717-c27ac260b061
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7e90d40e-c5ab-497b-a0fa-738ebabc4d75
          stepCounter: 2d84dc99-7aec-4a21-b0b4-02b0c6bc06d4
        config: {}
        dataType: TIMESTAMP_NTZ(9)
        description: ""
        name: INVOICE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6897af05-012d-4346-b8fc-8ccc0b4a682d
                stepCounter: 26612db0-e7e4-4e0a-9717-c27ac260b061
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 574905de-5c5b-4503-a995-cc01ef8f1f2b
          stepCounter: 2d84dc99-7aec-4a21-b0b4-02b0c6bc06d4
        config: {}
        dataType: VARCHAR(40)
        description: ""
        name: COMM_ALLOCATION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4efe1817-9675-4bea-bb22-395de4e90ef4
                stepCounter: 26612db0-e7e4-4e0a-9717-c27ac260b061
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 67ca0474-9b31-49fc-acab-ae7070d92542
          stepCounter: 2d84dc99-7aec-4a21-b0b4-02b0c6bc06d4
        config: {}
        dataType: NUMBER(15,2)
        description: ""
        name: EDF
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 326f1c60-37ca-4a9d-a18d-5cd5e7bf4957
                stepCounter: 26612db0-e7e4-4e0a-9717-c27ac260b061
            transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: ea7ab546-4b49-442c-bb83-91ee36278066
          stepCounter: 2d84dc99-7aec-4a21-b0b4-02b0c6bc06d4
        config: {}
        dataType: NUMBER(38, 2)
        defaultValue: ""
        description: ""
        keyColumnType: None
        name: REVENUE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: |-
              CASE
                  WHEN "STG_SALES_TRANSACTIONS"."UNIT" = 100
                  THEN
              ("STG_SALES_TRANSACTIONS"."QTY_SHIPPED" * "STG_SALES_TRANSACTIONS"."NET_PRICE" * ("STG_SALES_TRANSACTIONS"."COMM_ALLOCATION" / 100)) / 100
                  ELSE "STG_SALES_TRANSACTIONS"."QTY_SHIPPED" * "STG_SALES_TRANSACTIONS"."NET_PRICE" * ("STG_SALES_TRANSACTIONS"."COMM_ALLOCATION"/100)
              END
        systemColumnType: None
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 83a30de1-87d5-462d-8871-cc48ad3696ff
          stepCounter: 2d84dc99-7aec-4a21-b0b4-02b0c6bc06d4
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: ""
        keyColumnType: None
        name: TOTAL_COST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: |-
              CASE
                  WHEN "STG_SALES_TRANSACTIONS"."UNIT" = 100
                  THEN
              ("STG_SALES_TRANSACTIONS"."QTY_SHIPPED" * "STG_SALES_TRANSACTIONS"."COST") / 100
                  ELSE "STG_SALES_TRANSACTIONS"."QTY_SHIPPED" * "STG_SALES_TRANSACTIONS"."COST"
              END
        systemColumnType: None
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: b7b07d08-db11-4bfe-b849-510d00cfaa9d
          stepCounter: 2d84dc99-7aec-4a21-b0b4-02b0c6bc06d4
        config: {}
        dataType: VARCHAR(32)
        defaultValue: ""
        description: ""
        keyColumnType: None
        name: ORDER_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: CAST("ORDER_NO_NUM" as VARCHAR)
        systemColumnType: None
    cteString: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          STG_SALES_TRANSACTIONS: 26612db0-e7e4-4e0a-9717-c27ac260b061
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: RMH_SQL_SERVER_SERVICE_STG
            nodeName: STG_SALES_TRANSACTIONS
        join:
          joinCondition: |-
            FROM {{ ref('RMH_SQL_SERVER_SERVICE_STG', 'STG_SALES_TRANSACTIONS') }} "STG_SALES_TRANSACTIONS"

            WHERE "SLSPN_NAME" <> ''
        name: STG_SALES_TRANSACTIONS_WITH_CALCULATIONS
        noLinkRefs: []
  name: STG_SALES_TRANSACTIONS_WITH_CALCULATIONS
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node

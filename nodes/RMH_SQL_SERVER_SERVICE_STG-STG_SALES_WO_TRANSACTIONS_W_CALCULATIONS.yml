fileVersion: 1
id: 040b0164-c0a6-4ef8-a9ff-c8146ba1115d
name: STG_SALES_WO_TRANSACTIONS_W_CALCULATIONS
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: RMH_SQL_SERVER_SERVICE_STG
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: edf4b986-4350-49f9-b48d-57fc2e1fddb7
          stepCounter: 040b0164-c0a6-4ef8-a9ff-c8146ba1115d
        config: {}
        dataType: VARCHAR(12)
        description: ""
        name: WO_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 766640e0-48da-4327-b408-07046cec6f1c
                stepCounter: d4be5e53-1059-4603-8426-566cb7e76eef
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8187c5f3-d126-47a7-8645-258715724456
          stepCounter: 040b0164-c0a6-4ef8-a9ff-c8146ba1115d
        config: {}
        dataType: TIMESTAMP_TZ(9)
        description: ""
        name: UTCCREATEDDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2a0c58d1-6e37-4a15-ba56-78e7adc8e4ee
                stepCounter: d4be5e53-1059-4603-8426-566cb7e76eef
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 846b9061-0834-4140-acf6-a0163a16b957
          stepCounter: 040b0164-c0a6-4ef8-a9ff-c8146ba1115d
        config: {}
        dataType: VARCHAR(80)
        description: ""
        name: SHIP_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1c7da99f-576e-4aa7-8c43-ef32097b49fc
                stepCounter: d4be5e53-1059-4603-8426-566cb7e76eef
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1df76a09-4f9e-4709-aeb2-35efe481011b
          stepCounter: 040b0164-c0a6-4ef8-a9ff-c8146ba1115d
        config: {}
        dataType: BOOLEAN
        description: ""
        name: SHIP_COMPLETE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7be26a2c-c0ff-4c9b-87b1-52d42cede61c
                stepCounter: d4be5e53-1059-4603-8426-566cb7e76eef
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f0dfb404-1a3d-47f6-8f06-683a01fb461e
          stepCounter: 040b0164-c0a6-4ef8-a9ff-c8146ba1115d
        config: {}
        dataType: VARCHAR(80)
        description: ""
        name: SHIP_COUNTRY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2c562f9e-81f8-4899-b9dc-d3b92e942726
                stepCounter: d4be5e53-1059-4603-8426-566cb7e76eef
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0f302776-a66b-4b70-b632-6caadabe8ffe
          stepCounter: 040b0164-c0a6-4ef8-a9ff-c8146ba1115d
        config: {}
        dataType: VARCHAR(10)
        description: ""
        name: SHIP_ST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 93ce87a4-3e8c-49c4-87c5-42ab065b935f
                stepCounter: d4be5e53-1059-4603-8426-566cb7e76eef
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 78643fbd-8b22-4fa9-8be5-bc41500bec23
          stepCounter: 040b0164-c0a6-4ef8-a9ff-c8146ba1115d
        config: {}
        dataType: VARCHAR(20)
        description: ""
        name: SHIP_ZIP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 51ef28c5-92e0-4d7e-8a56-dc6e2bc2b7e7
                stepCounter: d4be5e53-1059-4603-8426-566cb7e76eef
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cd5fb81e-77fb-4d0c-8bf4-469f48066a6a
          stepCounter: 040b0164-c0a6-4ef8-a9ff-c8146ba1115d
        config: {}
        dataType: VARCHAR(40)
        description: ""
        name: SHIP_CITY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 112228a7-450a-43bd-9e08-ded3adb4ce3a
                stepCounter: d4be5e53-1059-4603-8426-566cb7e76eef
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4c626135-e4e9-44c4-b3c5-35c2ba3e4484
          stepCounter: 040b0164-c0a6-4ef8-a9ff-c8146ba1115d
        config: {}
        dataType: NUMBER(15,4)
        description: ""
        name: GROSS_AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ce1bedfa-5b40-43d5-9174-2b363eec1342
                stepCounter: d4be5e53-1059-4603-8426-566cb7e76eef
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 913e037d-93b3-4d20-8b72-893706d04d62
          stepCounter: 040b0164-c0a6-4ef8-a9ff-c8146ba1115d
        config: {}
        dataType: VARCHAR(10)
        description: ""
        name: ATIME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 19cc6b52-0e25-427c-aad3-508280e8af98
                stepCounter: d4be5e53-1059-4603-8426-566cb7e76eef
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d2361c58-6a43-4aa5-a76b-7c760385399a
          stepCounter: 040b0164-c0a6-4ef8-a9ff-c8146ba1115d
        config: {}
        dataType: VARCHAR(16)
        description: ""
        name: JOB_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: edd4bdbd-3ab5-4540-a138-17e8c5d30167
                stepCounter: d4be5e53-1059-4603-8426-566cb7e76eef
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fde6cffb-9fa7-4e5c-8370-7b7f0f668869
          stepCounter: 040b0164-c0a6-4ef8-a9ff-c8146ba1115d
        config: {}
        dataType: TIMESTAMP_NTZ(9)
        description: ""
        name: WO_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bed7e3b1-e88c-4e30-8b40-9fbed0eee305
                stepCounter: d4be5e53-1059-4603-8426-566cb7e76eef
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f59b2d13-08a3-4308-8ae4-70c6e1dd3cfc
          stepCounter: 040b0164-c0a6-4ef8-a9ff-c8146ba1115d
        config: {}
        dataType: VARCHAR(12)
        description: ""
        name: VENDOR_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bfbbac6d-2650-4347-aed6-8f99b80dcadf
                stepCounter: d4be5e53-1059-4603-8426-566cb7e76eef
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 36306d38-8565-458f-97fe-8d4c2b406053
          stepCounter: 040b0164-c0a6-4ef8-a9ff-c8146ba1115d
        config: {}
        dataType: VARCHAR(16)
        description: ""
        name: CUST_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 118fcc7e-be05-4e41-94af-90a4ec0900f0
                stepCounter: d4be5e53-1059-4603-8426-566cb7e76eef
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 87166dbb-a734-4ae7-94e9-f13ef1bc847c
          stepCounter: 040b0164-c0a6-4ef8-a9ff-c8146ba1115d
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: SEQ_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 253a5a78-a66d-48ee-b750-f04ba0c54a70
                stepCounter: d4be5e53-1059-4603-8426-566cb7e76eef
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3a86ac9c-5195-4a3f-8d9d-d8f6e86cf11a
          stepCounter: 040b0164-c0a6-4ef8-a9ff-c8146ba1115d
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: QTY_SHIPPED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7b235012-fd2e-44d4-b507-2898d0e05d44
                stepCounter: d4be5e53-1059-4603-8426-566cb7e76eef
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 24d470f9-c599-40df-ade2-9ad0f159d4da
          stepCounter: 040b0164-c0a6-4ef8-a9ff-c8146ba1115d
        config: {}
        dataType: NUMBER(17,4)
        description: ""
        name: COST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dea7a9de-4b6a-4abe-a440-a1d74c35920d
                stepCounter: d4be5e53-1059-4603-8426-566cb7e76eef
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cba9506a-8c6c-48bc-808f-34e1ee8857ed
          stepCounter: 040b0164-c0a6-4ef8-a9ff-c8146ba1115d
        config: {}
        dataType: VARCHAR(40)
        description: ""
        name: FIELD_7
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fd452e3e-3f22-4b3b-82c7-94d148034823
                stepCounter: d4be5e53-1059-4603-8426-566cb7e76eef
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 02fe3727-e39c-4f62-a472-18f2a4d2b125
          stepCounter: 040b0164-c0a6-4ef8-a9ff-c8146ba1115d
        config: {}
        dataType: VARCHAR(32)
        description: ""
        name: ITEM_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2457b219-de7c-460d-a4cc-f5cead50d8b3
                stepCounter: d4be5e53-1059-4603-8426-566cb7e76eef
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 774bedaa-0f92-44fc-b584-103707454c5c
          stepCounter: 040b0164-c0a6-4ef8-a9ff-c8146ba1115d
        config: {}
        dataType: VARCHAR(8)
        description: ""
        name: UOM_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 22630c28-05f0-44ca-b4e0-3963285adac1
                stepCounter: d4be5e53-1059-4603-8426-566cb7e76eef
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7a77e7aa-9de5-4fbf-98ce-5478230bd720
          stepCounter: 040b0164-c0a6-4ef8-a9ff-c8146ba1115d
        config: {}
        dataType: VARCHAR(8)
        description: ""
        name: COMM_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 74f9d220-ee6f-4c6e-b838-3248fba4eff6
                stepCounter: d4be5e53-1059-4603-8426-566cb7e76eef
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f257a42a-6bd3-4d81-a37e-f5abc2b68360
          stepCounter: 040b0164-c0a6-4ef8-a9ff-c8146ba1115d
        config: {}
        dataType: NUMBER(7,2)
        description: ""
        name: COMM_RATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c75eca3f-673f-47d5-b2d9-3553f8391b01
                stepCounter: d4be5e53-1059-4603-8426-566cb7e76eef
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: db9b35db-65e0-469f-901e-856a4e870d67
          stepCounter: 040b0164-c0a6-4ef8-a9ff-c8146ba1115d
        config: {}
        dataType: NUMBER(19,4)
        description: ""
        name: NET_PRICE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2ff16665-660b-482d-8708-71e3889cf56c
                stepCounter: d4be5e53-1059-4603-8426-566cb7e76eef
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c25e58bc-89a1-4641-b73f-efa118eb6e6b
          stepCounter: 040b0164-c0a6-4ef8-a9ff-c8146ba1115d
        config: {}
        dataType: VARCHAR(256)
        description: ""
        name: ITEM_VENDOR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 07c52efb-33d1-4e90-8dd8-dc12f4e81559
                stepCounter: d4be5e53-1059-4603-8426-566cb7e76eef
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3178ec0c-2890-4bb3-907c-5a6261050120
          stepCounter: 040b0164-c0a6-4ef8-a9ff-c8146ba1115d
        config: {}
        dataType: NUMBER(18,4)
        description: ""
        name: GROSS_PRICE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2fadea8c-e5b0-4cf2-9268-783a38fd8877
                stepCounter: d4be5e53-1059-4603-8426-566cb7e76eef
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ad007b9d-a6e4-4421-9da6-9e3f42caccd5
          stepCounter: 040b0164-c0a6-4ef8-a9ff-c8146ba1115d
        config: {}
        dataType: VARCHAR(8)
        description: ""
        name: INVOICE_SLSPN_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cf473a23-6617-488d-8488-10ee2c15a6dd
                stepCounter: d4be5e53-1059-4603-8426-566cb7e76eef
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2d14a2ea-c315-49fc-b33c-a1c03b4216c1
          stepCounter: 040b0164-c0a6-4ef8-a9ff-c8146ba1115d
        config: {}
        dataType: VARCHAR(16)
        description: ""
        name: DOCUMENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b2a4b3ad-3e42-4572-87b0-ce34790f0124
                stepCounter: d4be5e53-1059-4603-8426-566cb7e76eef
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9cb027a2-a923-47f7-93cb-51efa25fb27e
          stepCounter: 040b0164-c0a6-4ef8-a9ff-c8146ba1115d
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: PRD
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: eafd9050-6989-480c-be9a-e26387cbbf71
                stepCounter: d4be5e53-1059-4603-8426-566cb7e76eef
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1831b5b0-4794-4dbb-a644-46f90f9f9ebe
          stepCounter: 040b0164-c0a6-4ef8-a9ff-c8146ba1115d
        config: {}
        dataType: TIMESTAMP_NTZ(9)
        description: ""
        name: INVOICE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d02d1ee9-0bac-487f-aea2-1af86e3db8fb
                stepCounter: d4be5e53-1059-4603-8426-566cb7e76eef
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3e440fbb-8b1b-42cd-ba0b-5727037a5748
          stepCounter: 040b0164-c0a6-4ef8-a9ff-c8146ba1115d
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: YR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cb518193-c37c-4144-b12a-f092a97ad711
                stepCounter: d4be5e53-1059-4603-8426-566cb7e76eef
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9ccbfcd5-e45f-4f94-938c-b37e5f2a9ed9
          stepCounter: 040b0164-c0a6-4ef8-a9ff-c8146ba1115d
        config: {}
        dataType: VARCHAR(8)
        description: ""
        name: PROD_GROUP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 68033be8-1690-4bd4-af90-5bfaf8a4fef7
                stepCounter: d4be5e53-1059-4603-8426-566cb7e76eef
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 225c3163-b889-4059-a7df-cf5c817e987b
          stepCounter: 040b0164-c0a6-4ef8-a9ff-c8146ba1115d
        config: {}
        dataType: VARCHAR(32)
        description: ""
        name: PR_PROD_GROUP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bb177b45-b100-449d-b9bf-eb361f5cc006
                stepCounter: d4be5e53-1059-4603-8426-566cb7e76eef
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3d4b9a7a-7d8a-432b-93a7-6f14170c6161
          stepCounter: 040b0164-c0a6-4ef8-a9ff-c8146ba1115d
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: UNIT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d23b6105-20da-462e-8f03-a2f06227b00f
                stepCounter: d4be5e53-1059-4603-8426-566cb7e76eef
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a5104686-97ae-4d1e-bbef-4142c186b912
          stepCounter: 040b0164-c0a6-4ef8-a9ff-c8146ba1115d
        config: {}
        dataType: VARCHAR(44)
        description: ""
        name: SLSPN_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8dbacf7d-f66e-4745-886b-3fa2a5031c2e
                stepCounter: d4be5e53-1059-4603-8426-566cb7e76eef
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 169950e3-dae2-430a-ae3b-2d98b74ad600
          stepCounter: 040b0164-c0a6-4ef8-a9ff-c8146ba1115d
        config: {}
        dataType: NUMBER(15,2)
        description: ""
        name: EDF
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 69f0c78c-a8a2-4566-929b-2a4dee1a4d56
                stepCounter: d4be5e53-1059-4603-8426-566cb7e76eef
            transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: f3d8c774-014f-4105-912f-071a20fb5ba6
          stepCounter: 040b0164-c0a6-4ef8-a9ff-c8146ba1115d
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: ""
        keyColumnType: None
        name: REVENUE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: |-
              CASE
                  WHEN "STG_SALES_WO_TRANSACTIONS"."UNIT" = 100
                  THEN
              ("STG_SALES_WO_TRANSACTIONS"."QTY_SHIPPED" * "STG_SALES_WO_TRANSACTIONS"."NET_PRICE") / 100
              WHEN "STG_SALES_WO_TRANSACTIONS"."CALL_TYPE" IN ('SINS', 'PINS', 'CRAN') AND "STG_SALES_WO_TRANSACTIONS"."EXTRA_CHARGE__9" <> 0
              THEN 0
              ELSE "STG_SALES_WO_TRANSACTIONS"."QTY_SHIPPED" * "STG_SALES_WO_TRANSACTIONS"."NET_PRICE"
              END
        systemColumnType: None
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: b6291d3f-4017-4f06-8300-2137066c89e0
          stepCounter: 040b0164-c0a6-4ef8-a9ff-c8146ba1115d
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: ""
        keyColumnType: None
        name: TOTAL_COST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: |-
              CASE
                  WHEN "STG_SALES_WO_TRANSACTIONS"."UNIT" = 100
                  THEN
              ("STG_SALES_WO_TRANSACTIONS"."QTY_SHIPPED" * "STG_SALES_WO_TRANSACTIONS"."COST") / 100
                  ELSE "STG_SALES_WO_TRANSACTIONS"."QTY_SHIPPED" * "STG_SALES_WO_TRANSACTIONS"."COST"
              END
        systemColumnType: None
    cteString: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          STG_SALES_WO_TRANSACTIONS: d4be5e53-1059-4603-8426-566cb7e76eef
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: RMH_SQL_SERVER_SERVICE_STG
            nodeName: STG_SALES_WO_TRANSACTIONS
        join:
          joinCondition: |-
            FROM {{ ref('RMH_SQL_SERVER_SERVICE_STG', 'STG_SALES_WO_TRANSACTIONS') }} "STG_SALES_WO_TRANSACTIONS"

            WHERE "SLSPN_NAME" <> ''
        name: STG_SALES_WO_TRANSACTIONS_W_CALCULATIONS
        noLinkRefs: []
  name: STG_SALES_WO_TRANSACTIONS_W_CALCULATIONS
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node

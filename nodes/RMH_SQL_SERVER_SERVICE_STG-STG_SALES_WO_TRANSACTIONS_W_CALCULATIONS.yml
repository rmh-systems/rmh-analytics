fileVersion: 1
id: 040b0164-c0a6-4ef8-a9ff-c8146ba1115d
name: STG_SALES_WO_TRANSACTIONS_W_CALCULATIONS
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: RMH_SQL_SERVER_SERVICE_STG
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: edf4b986-4350-49f9-b48d-57fc2e1fddb7
          stepCounter: 040b0164-c0a6-4ef8-a9ff-c8146ba1115d
        config: {}
        dataType: VARCHAR(12)
        description: ""
        name: WO_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 308224d0-547d-4890-84ea-485bc39765cf
                stepCounter: 28539570-52ac-4cb7-bb17-9aa3209efce6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8187c5f3-d126-47a7-8645-258715724456
          stepCounter: 040b0164-c0a6-4ef8-a9ff-c8146ba1115d
        config: {}
        dataType: TIMESTAMP_TZ(9)
        description: ""
        name: UTCCREATEDDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f268149a-3724-4d84-9974-7405c9acf86a
                stepCounter: 28539570-52ac-4cb7-bb17-9aa3209efce6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 846b9061-0834-4140-acf6-a0163a16b957
          stepCounter: 040b0164-c0a6-4ef8-a9ff-c8146ba1115d
        config: {}
        dataType: VARCHAR(80)
        description: ""
        name: SHIP_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 68cb75fd-e847-4f0f-8168-29475e6896b3
                stepCounter: 28539570-52ac-4cb7-bb17-9aa3209efce6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1df76a09-4f9e-4709-aeb2-35efe481011b
          stepCounter: 040b0164-c0a6-4ef8-a9ff-c8146ba1115d
        config: {}
        dataType: BOOLEAN
        description: ""
        name: SHIP_COMPLETE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e6fdde68-048d-40e7-8a11-1a8ac8f0ad6f
                stepCounter: 28539570-52ac-4cb7-bb17-9aa3209efce6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f0dfb404-1a3d-47f6-8f06-683a01fb461e
          stepCounter: 040b0164-c0a6-4ef8-a9ff-c8146ba1115d
        config: {}
        dataType: VARCHAR(80)
        description: ""
        name: SHIP_COUNTRY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: aec6a038-682c-4ced-91d8-cf5ee3dc6488
                stepCounter: 28539570-52ac-4cb7-bb17-9aa3209efce6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0f302776-a66b-4b70-b632-6caadabe8ffe
          stepCounter: 040b0164-c0a6-4ef8-a9ff-c8146ba1115d
        config: {}
        dataType: VARCHAR(10)
        description: ""
        name: SHIP_ST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7d02acab-8e0e-4363-900a-92205dfc0727
                stepCounter: 28539570-52ac-4cb7-bb17-9aa3209efce6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 78643fbd-8b22-4fa9-8be5-bc41500bec23
          stepCounter: 040b0164-c0a6-4ef8-a9ff-c8146ba1115d
        config: {}
        dataType: VARCHAR(20)
        description: ""
        name: SHIP_ZIP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 10a98cb9-6a3e-4b9d-b9d3-b5524c1c28fe
                stepCounter: 28539570-52ac-4cb7-bb17-9aa3209efce6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cd5fb81e-77fb-4d0c-8bf4-469f48066a6a
          stepCounter: 040b0164-c0a6-4ef8-a9ff-c8146ba1115d
        config: {}
        dataType: VARCHAR(40)
        description: ""
        name: SHIP_CITY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c1c21661-639e-4b22-8b29-2cd85ab4d4ab
                stepCounter: 28539570-52ac-4cb7-bb17-9aa3209efce6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4c626135-e4e9-44c4-b3c5-35c2ba3e4484
          stepCounter: 040b0164-c0a6-4ef8-a9ff-c8146ba1115d
        config: {}
        dataType: NUMBER(15,4)
        description: ""
        name: GROSS_AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a5698f55-8a9a-4d28-b517-c2145c3f39b4
                stepCounter: 28539570-52ac-4cb7-bb17-9aa3209efce6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 913e037d-93b3-4d20-8b72-893706d04d62
          stepCounter: 040b0164-c0a6-4ef8-a9ff-c8146ba1115d
        config: {}
        dataType: VARCHAR(10)
        description: ""
        name: ATIME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 36ca06da-dec4-4829-a57c-55ba62b9f8ce
                stepCounter: 28539570-52ac-4cb7-bb17-9aa3209efce6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d2361c58-6a43-4aa5-a76b-7c760385399a
          stepCounter: 040b0164-c0a6-4ef8-a9ff-c8146ba1115d
        config: {}
        dataType: VARCHAR(16)
        description: ""
        name: JOB_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f881e3e2-288f-46b6-8646-51719c88ad43
                stepCounter: 28539570-52ac-4cb7-bb17-9aa3209efce6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fde6cffb-9fa7-4e5c-8370-7b7f0f668869
          stepCounter: 040b0164-c0a6-4ef8-a9ff-c8146ba1115d
        config: {}
        dataType: TIMESTAMP_NTZ(9)
        description: ""
        name: WO_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c3994fdc-3006-499a-89d2-f220a0a39a8b
                stepCounter: 28539570-52ac-4cb7-bb17-9aa3209efce6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f59b2d13-08a3-4308-8ae4-70c6e1dd3cfc
          stepCounter: 040b0164-c0a6-4ef8-a9ff-c8146ba1115d
        config: {}
        dataType: VARCHAR(12)
        description: ""
        name: VENDOR_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: abbbabcf-895a-4a0c-a857-1bf435ce64f8
                stepCounter: 28539570-52ac-4cb7-bb17-9aa3209efce6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 36306d38-8565-458f-97fe-8d4c2b406053
          stepCounter: 040b0164-c0a6-4ef8-a9ff-c8146ba1115d
        config: {}
        dataType: VARCHAR(16)
        description: ""
        name: CUST_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d5acb406-574b-4d45-b460-bcd3e31c7400
                stepCounter: 28539570-52ac-4cb7-bb17-9aa3209efce6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 87166dbb-a734-4ae7-94e9-f13ef1bc847c
          stepCounter: 040b0164-c0a6-4ef8-a9ff-c8146ba1115d
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: SEQ_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 99464d7e-aa82-4a63-9867-70b32590ace3
                stepCounter: 28539570-52ac-4cb7-bb17-9aa3209efce6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3a86ac9c-5195-4a3f-8d9d-d8f6e86cf11a
          stepCounter: 040b0164-c0a6-4ef8-a9ff-c8146ba1115d
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: QTY_SHIPPED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9676752c-2fff-4ac3-8812-46f5f6286328
                stepCounter: 28539570-52ac-4cb7-bb17-9aa3209efce6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 24d470f9-c599-40df-ade2-9ad0f159d4da
          stepCounter: 040b0164-c0a6-4ef8-a9ff-c8146ba1115d
        config: {}
        dataType: NUMBER(17,4)
        description: ""
        name: COST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3902424a-aa59-4812-9f23-0da06e2c7bb4
                stepCounter: 28539570-52ac-4cb7-bb17-9aa3209efce6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cba9506a-8c6c-48bc-808f-34e1ee8857ed
          stepCounter: 040b0164-c0a6-4ef8-a9ff-c8146ba1115d
        config: {}
        dataType: VARCHAR(40)
        description: ""
        name: FIELD_7
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a024f720-3299-4b78-9a9a-0076cbcea581
                stepCounter: 28539570-52ac-4cb7-bb17-9aa3209efce6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 02fe3727-e39c-4f62-a472-18f2a4d2b125
          stepCounter: 040b0164-c0a6-4ef8-a9ff-c8146ba1115d
        config: {}
        dataType: VARCHAR(32)
        description: ""
        name: ITEM_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 797e370d-fd53-4975-a808-af7640e9f064
                stepCounter: 28539570-52ac-4cb7-bb17-9aa3209efce6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 774bedaa-0f92-44fc-b584-103707454c5c
          stepCounter: 040b0164-c0a6-4ef8-a9ff-c8146ba1115d
        config: {}
        dataType: VARCHAR(8)
        description: ""
        name: UOM_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cf59d987-5736-400c-bb25-f1aecf673541
                stepCounter: 28539570-52ac-4cb7-bb17-9aa3209efce6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7a77e7aa-9de5-4fbf-98ce-5478230bd720
          stepCounter: 040b0164-c0a6-4ef8-a9ff-c8146ba1115d
        config: {}
        dataType: VARCHAR(8)
        description: ""
        name: COMM_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 28ce12f6-8811-43bd-8151-114e8c2a23a8
                stepCounter: 28539570-52ac-4cb7-bb17-9aa3209efce6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f257a42a-6bd3-4d81-a37e-f5abc2b68360
          stepCounter: 040b0164-c0a6-4ef8-a9ff-c8146ba1115d
        config: {}
        dataType: NUMBER(7,2)
        description: ""
        name: COMM_RATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 30f4bc0a-0f31-4644-9260-85aa1dabc661
                stepCounter: 28539570-52ac-4cb7-bb17-9aa3209efce6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: db9b35db-65e0-469f-901e-856a4e870d67
          stepCounter: 040b0164-c0a6-4ef8-a9ff-c8146ba1115d
        config: {}
        dataType: NUMBER(19,4)
        description: ""
        name: NET_PRICE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 061a6deb-f4f7-4768-9b91-b7b66421454d
                stepCounter: 28539570-52ac-4cb7-bb17-9aa3209efce6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c25e58bc-89a1-4641-b73f-efa118eb6e6b
          stepCounter: 040b0164-c0a6-4ef8-a9ff-c8146ba1115d
        config: {}
        dataType: VARCHAR(256)
        description: ""
        name: ITEM_VENDOR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c35f9ea9-ec70-4d94-8ce0-fc2340c82816
                stepCounter: 28539570-52ac-4cb7-bb17-9aa3209efce6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3178ec0c-2890-4bb3-907c-5a6261050120
          stepCounter: 040b0164-c0a6-4ef8-a9ff-c8146ba1115d
        config: {}
        dataType: NUMBER(18,4)
        description: ""
        name: GROSS_PRICE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a3f89b46-fd02-40e8-ad00-609a3e04b4a1
                stepCounter: 28539570-52ac-4cb7-bb17-9aa3209efce6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ad007b9d-a6e4-4421-9da6-9e3f42caccd5
          stepCounter: 040b0164-c0a6-4ef8-a9ff-c8146ba1115d
        config: {}
        dataType: VARCHAR(8)
        description: ""
        name: INVOICE_SLSPN_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7904c4e4-92f9-49e7-9f02-97ce6c3a2b17
                stepCounter: 28539570-52ac-4cb7-bb17-9aa3209efce6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2d14a2ea-c315-49fc-b33c-a1c03b4216c1
          stepCounter: 040b0164-c0a6-4ef8-a9ff-c8146ba1115d
        config: {}
        dataType: VARCHAR(16)
        description: ""
        name: DOCUMENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e8f4b2ad-9174-40fc-91bd-92c2ceb9bb31
                stepCounter: 28539570-52ac-4cb7-bb17-9aa3209efce6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9cb027a2-a923-47f7-93cb-51efa25fb27e
          stepCounter: 040b0164-c0a6-4ef8-a9ff-c8146ba1115d
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: PRD
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0568e7c2-021c-40a0-a958-47428a2c541a
                stepCounter: 28539570-52ac-4cb7-bb17-9aa3209efce6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1831b5b0-4794-4dbb-a644-46f90f9f9ebe
          stepCounter: 040b0164-c0a6-4ef8-a9ff-c8146ba1115d
        config: {}
        dataType: TIMESTAMP_NTZ(9)
        description: ""
        name: INVOICE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6831b03c-e26e-4355-a0e4-c825a249f4a0
                stepCounter: 28539570-52ac-4cb7-bb17-9aa3209efce6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3e440fbb-8b1b-42cd-ba0b-5727037a5748
          stepCounter: 040b0164-c0a6-4ef8-a9ff-c8146ba1115d
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: YR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4b6ec405-6bb1-4cf9-90da-3c2ed11bf959
                stepCounter: 28539570-52ac-4cb7-bb17-9aa3209efce6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9ccbfcd5-e45f-4f94-938c-b37e5f2a9ed9
          stepCounter: 040b0164-c0a6-4ef8-a9ff-c8146ba1115d
        config: {}
        dataType: VARCHAR(8)
        description: ""
        name: PROD_GROUP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cc6514c4-4ef4-46d6-98cf-1ac81b9e55f6
                stepCounter: 28539570-52ac-4cb7-bb17-9aa3209efce6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 225c3163-b889-4059-a7df-cf5c817e987b
          stepCounter: 040b0164-c0a6-4ef8-a9ff-c8146ba1115d
        config: {}
        dataType: VARCHAR(8)
        description: ""
        name: PR_PROD_GROUP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5e632abe-a8ed-478d-9840-5574b0482232
                stepCounter: 28539570-52ac-4cb7-bb17-9aa3209efce6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3d4b9a7a-7d8a-432b-93a7-6f14170c6161
          stepCounter: 040b0164-c0a6-4ef8-a9ff-c8146ba1115d
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: UNIT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f4178e0a-c906-4fd9-b670-c9e43a0a9ea5
                stepCounter: 28539570-52ac-4cb7-bb17-9aa3209efce6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a5104686-97ae-4d1e-bbef-4142c186b912
          stepCounter: 040b0164-c0a6-4ef8-a9ff-c8146ba1115d
        config: {}
        dataType: VARCHAR(44)
        description: ""
        name: SLSPN_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 12d5af6c-ee2b-4469-a751-2f02ece2c3d0
                stepCounter: 28539570-52ac-4cb7-bb17-9aa3209efce6
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 16785e33-3012-4ed6-8fa5-270e3e6b8ad7
          stepCounter: 040b0164-c0a6-4ef8-a9ff-c8146ba1115d
        config: {}
        dataType: VARCHAR(8)
        description: ""
        name: SLSPN_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 252cea15-065d-4e35-85de-7aa93bec7685
                stepCounter: 28539570-52ac-4cb7-bb17-9aa3209efce6
            transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: f3d8c774-014f-4105-912f-071a20fb5ba6
          stepCounter: 040b0164-c0a6-4ef8-a9ff-c8146ba1115d
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: ""
        keyColumnType: None
        name: REVENUE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: |-
              CASE
                  WHEN "STG_SALES_WO_TRANSACTIONS"."UNIT" = 100
                  THEN
              ("STG_SALES_WO_TRANSACTIONS"."QTY_SHIPPED" * "STG_SALES_WO_TRANSACTIONS"."NET_PRICE") / 100
              WHEN "STG_SALES_WO_TRANSACTIONS"."CALL_TYPE" IN ('SINS', 'PINS', 'CRAN') AND "STG_SALES_WO_TRANSACTIONS"."EXTRA_CHARGE__9" <> 0
              THEN 0
              ELSE "STG_SALES_WO_TRANSACTIONS"."QTY_SHIPPED" * "STG_SALES_WO_TRANSACTIONS"."NET_PRICE"
              END
        systemColumnType: None
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: b6291d3f-4017-4f06-8300-2137066c89e0
          stepCounter: 040b0164-c0a6-4ef8-a9ff-c8146ba1115d
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: ""
        keyColumnType: None
        name: TOTAL_COST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: |-
              CASE
                  WHEN "STG_SALES_WO_TRANSACTIONS"."UNIT" = 100
                  THEN
              ("STG_SALES_WO_TRANSACTIONS"."QTY_SHIPPED" * "STG_SALES_WO_TRANSACTIONS"."COST") / 100
                  ELSE "STG_SALES_WO_TRANSACTIONS"."QTY_SHIPPED" * "STG_SALES_WO_TRANSACTIONS"."COST"
              END
        systemColumnType: None
    cteString: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          STG_SALES_WO_TRANSACTIONS: 28539570-52ac-4cb7-bb17-9aa3209efce6
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: RMH_SQL_SERVER_SERVICE_STG
            nodeName: STG_SALES_WO_TRANSACTIONS
        join:
          joinCondition: FROM {{ ref('RMH_SQL_SERVER_SERVICE_STG', 'STG_SALES_WO_TRANSACTIONS') }} "STG_SALES_WO_TRANSACTIONS"
        name: STG_SALES_WO_TRANSACTIONS_W_CALCULATIONS
        noLinkRefs: []
  name: STG_SALES_WO_TRANSACTIONS_W_CALCULATIONS
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node

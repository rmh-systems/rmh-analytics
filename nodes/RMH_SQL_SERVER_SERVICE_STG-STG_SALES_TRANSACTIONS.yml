fileVersion: 1
id: a999c6b5-0f58-4e4e-a95a-a429ea2b4ee2
name: STG_SALES_TRANSACTIONS
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: RMH_SQL_SERVER_SERVICE_STG
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 672dd3ec-e20b-48fa-8524-9abcf9240768
          stepCounter: a999c6b5-0f58-4e4e-a95a-a429ea2b4ee2
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: SEQ_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a8c4811f-bd99-4ffa-9f9a-cbb1fad82302
                stepCounter: 1b7e4ba2-1e35-469e-89a2-8f4a4c0b58a7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bfd0994d-6e4d-4e1f-9fd9-c310bb5453d5
          stepCounter: a999c6b5-0f58-4e4e-a95a-a429ea2b4ee2
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: ORDER_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 20b4c4f1-dd81-446d-9ebc-308bfdc30c4d
                stepCounter: 1b7e4ba2-1e35-469e-89a2-8f4a4c0b58a7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9f843522-3a0f-4629-b168-90262e84a6e6
          stepCounter: a999c6b5-0f58-4e4e-a95a-a429ea2b4ee2
        config: {}
        dataType: VARCHAR(32)
        description: ""
        name: ITEM_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 974ab70c-0540-4cbc-a99b-349922af02d7
                stepCounter: 1b7e4ba2-1e35-469e-89a2-8f4a4c0b58a7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6571cce3-7574-4f1e-8206-611588961d4d
          stepCounter: a999c6b5-0f58-4e4e-a95a-a429ea2b4ee2
        config: {}
        dataType: VARCHAR(16)
        description: ""
        name: CUST_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7f23fd79-0e60-409e-80e7-c944e58f588b
                stepCounter: 1b7e4ba2-1e35-469e-89a2-8f4a4c0b58a7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e8ddb3cb-74e2-4477-95c4-f21f4c999b14
          stepCounter: a999c6b5-0f58-4e4e-a95a-a429ea2b4ee2
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: QTY_SHIPPED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bc179312-bbf8-46e1-8630-81dfe942a37f
                stepCounter: 1b7e4ba2-1e35-469e-89a2-8f4a4c0b58a7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 767f7963-803c-4d45-8627-edc8389cd87b
          stepCounter: a999c6b5-0f58-4e4e-a95a-a429ea2b4ee2
        config: {}
        dataType: NUMBER(19,4)
        description: ""
        name: NET_PRICE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 61065fa5-37bd-4234-99e6-15057be6f868
                stepCounter: 1b7e4ba2-1e35-469e-89a2-8f4a4c0b58a7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e9c5719d-ab46-4b19-b040-a48d73f2e0be
          stepCounter: a999c6b5-0f58-4e4e-a95a-a429ea2b4ee2
        config: {}
        dataType: NUMBER(17,4)
        description: ""
        name: COST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 15e4d3da-897b-4db5-a8eb-1208d3fe9ac5
                stepCounter: 1b7e4ba2-1e35-469e-89a2-8f4a4c0b58a7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 44033ac0-d140-4e95-9260-78f090229cb2
          stepCounter: a999c6b5-0f58-4e4e-a95a-a429ea2b4ee2
        config: {}
        dataType: BOOLEAN
        description: ""
        name: DROP_SHIP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3d0956c1-c002-47c5-9ba1-43d91bcdd05c
                stepCounter: 1b7e4ba2-1e35-469e-89a2-8f4a4c0b58a7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 22f5ef65-585d-45b1-be7a-f2b93735daa7
          stepCounter: a999c6b5-0f58-4e4e-a95a-a429ea2b4ee2
        config: {}
        dataType: VARCHAR(6)
        description: ""
        name: PURCHASE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 96c9c39e-cf96-4165-ba87-a5422e76fbe7
                stepCounter: 1b7e4ba2-1e35-469e-89a2-8f4a4c0b58a7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 21e7854a-135f-4e32-8747-8ce273e0132b
          stepCounter: a999c6b5-0f58-4e4e-a95a-a429ea2b4ee2
        config: {}
        dataType: VARCHAR(80)
        description: ""
        name: FIELD_9
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a8158137-def5-4e2b-8ec2-a27089dd3d87
                stepCounter: 1b7e4ba2-1e35-469e-89a2-8f4a4c0b58a7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a5de8df1-d4cf-4633-b584-fc8835f85bf4
          stepCounter: a999c6b5-0f58-4e4e-a95a-a429ea2b4ee2
        config: {}
        dataType: VARCHAR(16)
        description: ""
        name: DOCUMENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 50a190be-262d-4c92-bd7f-570852dafe00
                stepCounter: b4ffac55-8cb6-480d-8822-bda521cdbf24
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1d19c61b-d6ff-48b2-ab04-e2f682ddc07e
          stepCounter: a999c6b5-0f58-4e4e-a95a-a429ea2b4ee2
        config: {}
        dataType: TIMESTAMP_NTZ(9)
        description: ""
        name: INVOICE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 22e127a7-0aa6-4c7b-a794-c5e1c4d60a4f
                stepCounter: b4ffac55-8cb6-480d-8822-bda521cdbf24
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4e56812c-65ee-41ae-bef1-c42dbfcd7023
          stepCounter: a999c6b5-0f58-4e4e-a95a-a429ea2b4ee2
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: YR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 36cafd48-cc34-4688-9216-054f118dde94
                stepCounter: b4ffac55-8cb6-480d-8822-bda521cdbf24
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 581db9d7-70f8-48e7-841f-fed19ac97f4c
          stepCounter: a999c6b5-0f58-4e4e-a95a-a429ea2b4ee2
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: PRD
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dff2464c-7ecd-4db3-b84b-6e40a519d885
                stepCounter: b4ffac55-8cb6-480d-8822-bda521cdbf24
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a78e8093-fb60-4813-aa33-fbde0c4e6b60
          stepCounter: a999c6b5-0f58-4e4e-a95a-a429ea2b4ee2
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: INVOICE_ORDER_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b3d38e1f-df18-4825-a7bd-682eab1bd801
                stepCounter: b4ffac55-8cb6-480d-8822-bda521cdbf24
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a20c10dc-c5a8-4d3b-8b54-5e28ec1f917c
          stepCounter: a999c6b5-0f58-4e4e-a95a-a429ea2b4ee2
        config: {}
        dataType: VARCHAR(100)
        description: ""
        name: SHIP_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8b1504d3-2232-4566-82e3-5487b5f732c0
                stepCounter: baf88c36-1be1-415d-9501-0d76524ba4f0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2851433a-2ab3-4c47-a7e8-058fd39dd96c
          stepCounter: a999c6b5-0f58-4e4e-a95a-a429ea2b4ee2
        config: {}
        dataType: VARCHAR(40)
        description: ""
        name: FIELD_1
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 453d4b08-54d9-4266-ac42-0f94b30a1227
                stepCounter: baf88c36-1be1-415d-9501-0d76524ba4f0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b726eade-922a-4062-b8d2-6238d4d5c3b5
          stepCounter: a999c6b5-0f58-4e4e-a95a-a429ea2b4ee2
        config: {}
        dataType: VARCHAR(40)
        description: ""
        name: FIELD_2
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5a7cb830-5f8d-43e9-bda7-49d493f70bf3
                stepCounter: baf88c36-1be1-415d-9501-0d76524ba4f0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f6558716-62c2-48a5-8449-982c36d9dcf0
          stepCounter: a999c6b5-0f58-4e4e-a95a-a429ea2b4ee2
        config: {}
        dataType: VARCHAR(40)
        description: ""
        name: FIELD_7
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d61f15a3-d7ba-4c10-8db2-d5178c9e97ba
                stepCounter: baf88c36-1be1-415d-9501-0d76524ba4f0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bcc3fafe-c974-4693-921a-a3118f151b50
          stepCounter: a999c6b5-0f58-4e4e-a95a-a429ea2b4ee2
        config: {}
        dataType: VARCHAR(40)
        description: ""
        name: ORDER_FIELD_9
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c141a9a2-65a8-4af5-abd2-3c11e831ec10
                stepCounter: baf88c36-1be1-415d-9501-0d76524ba4f0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 684dd894-5564-453c-ac42-83592fa3f1d5
          stepCounter: a999c6b5-0f58-4e4e-a95a-a429ea2b4ee2
        config: {}
        dataType: TIMESTAMP_NTZ(9)
        description: ""
        name: CREATEDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 918e3e58-0435-4d9f-9adc-c19e4a1cfefc
                stepCounter: baf88c36-1be1-415d-9501-0d76524ba4f0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f4e2cde4-4c49-4a45-a4ac-7edeba515570
          stepCounter: a999c6b5-0f58-4e4e-a95a-a429ea2b4ee2
        config: {}
        dataType: VARCHAR(8)
        description: ""
        name: PROD_GROUP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e2eecae4-12d4-4837-8a16-1ad76223ecdc
                stepCounter: cad668ae-9b21-4063-b9da-af244d04642b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 401acbd7-aadb-4223-93c9-65f190812897
          stepCounter: a999c6b5-0f58-4e4e-a95a-a429ea2b4ee2
        config: {}
        dataType: VARCHAR(8)
        description: ""
        name: PR_PROD_GROUP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8accbf1e-0807-47ed-b0d9-3a38b774188e
                stepCounter: ff14b386-d96c-4cb6-ac64-244703e4ef8e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d54028f2-2d67-4cab-9929-4401291458d2
          stepCounter: a999c6b5-0f58-4e4e-a95a-a429ea2b4ee2
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: UNIT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c9be4938-4130-4718-8f77-a7cfd9513504
                stepCounter: 85deb06d-fa39-4a43-886a-872cc4b5d22d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: aa4dd463-a7f9-46cb-9f0f-fb712e5b180d
          stepCounter: a999c6b5-0f58-4e4e-a95a-a429ea2b4ee2
        config: {}
        dataType: VARCHAR(44)
        description: ""
        name: SLSPN_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bf1482f0-e535-4584-8e14-1a5ae42725f9
                stepCounter: 812ca5a4-268b-464c-a887-e37bafa4477a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 82dc906c-8f8d-4cfb-a67e-ccd44598f43c
          stepCounter: a999c6b5-0f58-4e4e-a95a-a429ea2b4ee2
        config: {}
        dataType: VARCHAR(8)
        description: ""
        name: SLSPN_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7856795f-a62d-47b8-afd8-63de2d2e75f2
                stepCounter: 812ca5a4-268b-464c-a887-e37bafa4477a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2391a952-f1f3-4288-9c74-c0f34964d2c8
          stepCounter: a999c6b5-0f58-4e4e-a95a-a429ea2b4ee2
        config: {}
        dataType: NUMBER(7,4)
        description: ""
        name: COMMRATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 01a68902-b977-47b4-a3cf-b1a79b9652d3
                stepCounter: 524357f5-661c-4658-ad6f-e583be291bbd
            transform: ""
    cteString: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          STG_INVOICE: b4ffac55-8cb6-480d-8822-bda521cdbf24
          STG_INVOICE_LINE: 1b7e4ba2-1e35-469e-89a2-8f4a4c0b58a7
          STG_ITEM: cad668ae-9b21-4063-b9da-af244d04642b
          STG_ORDER: baf88c36-1be1-415d-9501-0d76524ba4f0
          STG_PR_GROUP: ff14b386-d96c-4cb6-ac64-244703e4ef8e
          STG_PYSLSPNPRODCOMM: 524357f5-661c-4658-ad6f-e583be291bbd
          STG_SALESPER: 812ca5a4-268b-464c-a887-e37bafa4477a
          STG_UOM: 85deb06d-fa39-4a43-886a-872cc4b5d22d
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: RMH_SQL_SERVER_SERVICE_STG
            nodeName: STG_INVOICE
          - locationName: RMH_SQL_SERVER_SERVICE_STG
            nodeName: STG_INVOICE_LINE
          - locationName: RMH_SQL_SERVER_SERVICE_STG
            nodeName: STG_ITEM
          - locationName: RMH_SQL_SERVER_SERVICE_STG
            nodeName: STG_ORDER
          - locationName: RMH_SQL_SERVER_SERVICE_STG
            nodeName: STG_PR_GROUP
          - locationName: RMH_SQL_SERVER_SERVICE_STG
            nodeName: STG_PYSLSPNPRODCOMM
          - locationName: RMH_SQL_SERVER_SERVICE_STG
            nodeName: STG_SALESPER
          - locationName: RMH_SQL_SERVER_SERVICE_STG
            nodeName: STG_UOM
        join:
          joinCondition: |-
            FROM {{ ref('RMH_SQL_SERVER_SERVICE_STG', 'STG_INVOICE_LINE') }} "STG_INVOICE_LINE"
            INNER JOIN {{ ref('RMH_SQL_SERVER_SERVICE_STG', 'STG_INVOICE') }} "STG_INVOICE"
            ON "STG_INVOICE_LINE"."SEQ_NO" = "STG_INVOICE"."SEQ_NO"
            INNER JOIN {{ ref('RMH_SQL_SERVER_SERVICE_STG', 'STG_ORDER') }} "STG_ORDER"
            ON "STG_INVOICE_LINE"."ORDER_NO" = "STG_ORDER"."ORDER_NO"
            INNER JOIN {{ ref('RMH_SQL_SERVER_SERVICE_STG', 'STG_ITEM') }} "STG_ITEM"
            ON "STG_INVOICE_LINE"."ITEM_NO" = "STG_ITEM"."ITEM_NO"
            INNER JOIN {{ ref('RMH_SQL_SERVER_SERVICE_STG', 'STG_PR_GROUP') }} "STG_PR_GROUP"
            ON "STG_ITEM"."PROD_GROUP" = "STG_PR_GROUP"."PROD_GROUP"
            INNER JOIN {{ ref('RMH_SQL_SERVER_SERVICE_STG', 'STG_UOM') }} "STG_UOM"
            ON "STG_INVOICE_LINE"."UOM_CODE" = "STG_UOM"."UOM_CODE"
            LEFT JOIN {{ ref('RMH_SQL_SERVER_SERVICE_STG', 'STG_SALESPER') }} "STG_SALESPER"
            ON "STG_ORDER"."FIELD_1" = "STG_SALESPER"."SLSPN_NAME"
            LEFT JOIN {{ ref('RMH_SQL_SERVER_SERVICE_STG', 'STG_PYSLSPNPRODCOMM') }} "STG_PYSLSPNPRODCOMM"
            ON "STG_SALESPER"."SLSPN_CODE" = "STG_PYSLSPNPRODCOMM"."SLSPNCODE" 
            AND CASE 
            WHEN "STG_INVOICE_LINE"."FIELD_9" = 'DIRECT' THEN 'DIR'
            WHEN "STG_INVOICE_LINE"."FIELD_9" = 'INSTOCK' THEN 'INS'
            WHEN COALESCE("STG_INVOICE_LINE"."FIELD_9", '') = '' AND "STG_ORDER"."FIELD_9" = 'DIRECT' THEN 'DIR'
            WHEN COALESCE("STG_INVOICE_LINE"."FIELD_9", '') = '' AND "STG_ORDER"."FIELD_9" = 'INSTOCK' THEN 'INS'
            ELSE ''
            END = "STG_PYSLSPNPRODCOMM"."REFERENCE1"
            AND "STG_ITEM"."PROD_GROUP" = "STG_PYSLSPNPRODCOMM"."REFERENCE2"
            WHERE "STG_PR_GROUP"."PROD_GROUP" NOT IN ('103', '103F', '199', '199F', '331', '331F', '333', '333F', 
                                            '399', '399F', '450', '450F', '453', '453F', '490', '490F', '499', '499F')
        name: STG_SALES_TRANSACTIONS
        noLinkRefs: []
  name: STG_SALES_TRANSACTIONS
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node

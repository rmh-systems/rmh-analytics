fileVersion: 1
id: ee5e282c-0c3b-4773-b692-13cb686eb1c3
name: STG_BOOKINGS_BR_SO_SLSPN3
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: RMH_SQL_SERVER_SERVICE_STG
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f13b67a7-6fb6-4b7d-98ca-ad8d02395b63
          stepCounter: ee5e282c-0c3b-4773-b692-13cb686eb1c3
        config: {}
        dataType: VARCHAR(16)
        description: ""
        name: TRANS_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ea8dd44a-ba4e-497b-90a1-ac74947efe2d
                stepCounter: 9edf3a3a-1a63-4bca-a514-31ec56c6859a
            transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 347f25b1-667d-4050-822e-a8250fd8e420
          stepCounter: ee5e282c-0c3b-4773-b692-13cb686eb1c3
        config: {}
        dataType: VARCHAR(32)
        defaultValue: ""
        description: ""
        keyColumnType: None
        name: SLSPN_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: |-
              CASE
                  WHEN IFNULL("STG_ORDER"."FIELD_5",'') IN ('House Account','House Account PKG') AND "STG_ORDER"."USER_ID" IN ('kreeves','birmiter','pcrawford','dwiley','kskinner','aburgraff','bborchardt','bborchar','kgrandgenett','nwelch','tchafa','rscholl','tbruns','jmetz') THEN 'House Acct - IA'
                  WHEN IFNULL("STG_ORDER"."FIELD_5",'') IN ('House Account','House Account PKG') AND"STG_ORDER"."USER_ID" IN ('rwilkins','aforeman','bhoover','mwalker') THEN 'House Acct - NE'
                  WHEN IFNULL("STG_ORDER"."FIELD_5",'') IN ('House Account','House Account PKG') AND"STG_ORDER"."USER_ID" IN ('ccocasse','pmlsna','rholland') THEN 'House Acct - MN'
                  WHEN IFNULL("STG_ORDER"."FIELD_5",'') IN ('House Account','House Account PKG') AND"STG_ORDER"."USER_ID" IN ('sprisant','igarlanger','jfernandez') THEN 'House Acct - IL'
                  WHEN IFNULL("STG_ORDER"."FIELD_5",'') IN ('House Account - IL') THEN 'House Acct - IL'
                  WHEN IFNULL("STG_ORDER"."FIELD_5",'') IN ('House Account','House Account PKG') AND "STG_ORDER"."SHIP_ST" IN ('MN') THEN 'House Acct - MN'
                  ELSE IFNULL("STG_ORDER"."FIELD_5",'') 
              END
        systemColumnType: None
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1cb2d8a5-cde7-4589-8e33-c9943b8c6ec8
          stepCounter: ee5e282c-0c3b-4773-b692-13cb686eb1c3
        config: {}
        dataType: NUMBER
        description: ""
        name: YEAR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f62ca6ab-4a35-4009-ae28-16ff42d4d9d8
                stepCounter: 9edf3a3a-1a63-4bca-a514-31ec56c6859a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 41d9c4e2-4348-49bf-b9ff-1dd50e71ccde
          stepCounter: ee5e282c-0c3b-4773-b692-13cb686eb1c3
        config: {}
        dataType: NUMBER
        description: ""
        name: PRD
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0e53b146-69c4-4f0f-9cb7-1ff6694ce58d
                stepCounter: 9edf3a3a-1a63-4bca-a514-31ec56c6859a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 198e8107-85df-43cd-bc7e-1fb2e07b5a24
          stepCounter: ee5e282c-0c3b-4773-b692-13cb686eb1c3
        config: {}
        dataType: VARCHAR(16)
        description: ""
        name: ORDER_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 38cd296d-451b-4d49-a280-17c14456f6d0
                stepCounter: 9edf3a3a-1a63-4bca-a514-31ec56c6859a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b2e11aad-7284-49ce-b041-3f980b4365ef
          stepCounter: ee5e282c-0c3b-4773-b692-13cb686eb1c3
        config: {}
        dataType: DATE
        description: ""
        name: ORDER_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 27f63432-1f74-4c53-9aee-868562cfc3c3
                stepCounter: 9edf3a3a-1a63-4bca-a514-31ec56c6859a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: bc59d578-7860-48c6-866e-8e0e4be7225a
          stepCounter: ee5e282c-0c3b-4773-b692-13cb686eb1c3
        config: {}
        dataType: VARCHAR(32)
        description: ""
        name: ORDER_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e5555d8d-eaa9-4da5-9494-2180e300fcac
                stepCounter: 9edf3a3a-1a63-4bca-a514-31ec56c6859a
            transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 4c2d3733-9bba-4641-a9fa-3a0fdf50b8bf
          stepCounter: ee5e282c-0c3b-4773-b692-13cb686eb1c3
        config: {}
        dataType: VARCHAR(100)
        defaultValue: ""
        description: ""
        keyColumnType: None
        name: SHIP_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8b1504d3-2232-4566-82e3-5487b5f732c0
                stepCounter: baf88c36-1be1-415d-9501-0d76524ba4f0
            transform: ""
        systemColumnType: None
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 27f11bf0-f423-43ca-b401-fcf63d34b876
          stepCounter: ee5e282c-0c3b-4773-b692-13cb686eb1c3
        config: {}
        dataType: VARCHAR(32)
        defaultValue: ""
        description: ""
        keyColumnType: None
        name: SHIP_CITY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ce15d226-67de-4673-ba80-dab86db6b2b6
                stepCounter: baf88c36-1be1-415d-9501-0d76524ba4f0
            transform: ""
        systemColumnType: None
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: eb9b1234-16d2-40f4-88eb-8cb158d06e5d
          stepCounter: ee5e282c-0c3b-4773-b692-13cb686eb1c3
        config: {}
        dataType: VARCHAR(32)
        defaultValue: ""
        description: ""
        keyColumnType: None
        name: SHIP_STATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bd2114b5-5c4f-41ce-9be4-996f7b3bd035
                stepCounter: baf88c36-1be1-415d-9501-0d76524ba4f0
            transform: ""
        systemColumnType: None
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 31e3b124-9f0f-43f1-a62b-39ca342e388e
          stepCounter: ee5e282c-0c3b-4773-b692-13cb686eb1c3
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: ""
        keyColumnType: None
        name: BOOKINGS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: "\"STG_BOOKINGS_TSO\".\"SALE_AMT\" * \"STG_ORDER\".\"FIELD_6\" / 100"
        systemColumnType: None
    cteString: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          STG_BOOKINGS_TSO: 9edf3a3a-1a63-4bca-a514-31ec56c6859a
          STG_ORDER: baf88c36-1be1-415d-9501-0d76524ba4f0
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: RMH_SQL_SERVER_SERVICE_STG
            nodeName: STG_BOOKINGS_TSO
          - locationName: RMH_SQL_SERVER_SERVICE_STG
            nodeName: STG_ORDER
        join:
          joinCondition: |-
            FROM {{ ref('RMH_SQL_SERVER_SERVICE_STG', 'STG_ORDER') }} "STG_ORDER"
            INNER JOIN {{ ref('RMH_SQL_SERVER_SERVICE_STG', 'STG_BOOKINGS_TSO') }} "STG_BOOKINGS_TSO"
            ON "STG_ORDER"."ORDER_NO" = "STG_BOOKINGS_TSO"."ORDER_NO"
        name: STG_BOOKINGS_BR_SO_SLSPN3
        noLinkRefs: []
  name: STG_BOOKINGS_BR_SO_SLSPN3
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node

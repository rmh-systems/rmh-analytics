fileVersion: 1
id: dbef99fb-172e-4e42-84f1-bdd79dac0a59
name: STG_SALES_WO_TRANSACTIONS_PARTS
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: RMH_SQL_SERVER_SERVICE_STG
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cdf0d5f8-5b0f-44ca-b646-55c84ff31c76
          stepCounter: dbef99fb-172e-4e42-84f1-bdd79dac0a59
        config: {}
        dataType: VARCHAR(12)
        description: ""
        name: WO_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 751d67e7-01fd-4804-b7e4-6e47a43a77b6
                stepCounter: af53fc6c-dbe9-49dc-a793-5a3298e9d4cb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fb15c9ba-d502-4eef-ace9-5344e232f5d7
          stepCounter: dbef99fb-172e-4e42-84f1-bdd79dac0a59
        config: {}
        dataType: TIMESTAMP_TZ(9)
        description: ""
        name: UTCCREATEDDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b6a21077-ceec-4255-a855-2d6185d5237b
                stepCounter: af53fc6c-dbe9-49dc-a793-5a3298e9d4cb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 352dc9dd-6af6-4022-b0ce-1433195ebb43
          stepCounter: dbef99fb-172e-4e42-84f1-bdd79dac0a59
        config: {}
        dataType: VARCHAR(80)
        description: ""
        name: SHIP_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a05354bd-2a7b-47ef-8b2b-a553f04b2dd2
                stepCounter: af53fc6c-dbe9-49dc-a793-5a3298e9d4cb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d4fea4ea-bedf-4863-aa92-14233c60d8d8
          stepCounter: dbef99fb-172e-4e42-84f1-bdd79dac0a59
        config: {}
        dataType: BOOLEAN
        description: ""
        name: SHIP_COMPLETE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 747987b4-638b-4cfc-8b4e-8fea7708808e
                stepCounter: af53fc6c-dbe9-49dc-a793-5a3298e9d4cb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 04fc5156-ce63-41b5-ba41-833c933f6d09
          stepCounter: dbef99fb-172e-4e42-84f1-bdd79dac0a59
        config: {}
        dataType: VARCHAR(80)
        description: ""
        name: SHIP_COUNTRY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e6a3440c-fde7-4dfe-a31c-33ff28f92a5c
                stepCounter: af53fc6c-dbe9-49dc-a793-5a3298e9d4cb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9a05a317-b5da-4c75-b932-126b42fde45c
          stepCounter: dbef99fb-172e-4e42-84f1-bdd79dac0a59
        config: {}
        dataType: VARCHAR(10)
        description: ""
        name: SHIP_ST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fb72461d-5692-4e99-8950-889b9504bcb1
                stepCounter: af53fc6c-dbe9-49dc-a793-5a3298e9d4cb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 02315893-52b1-410f-b460-0c66e43a9e66
          stepCounter: dbef99fb-172e-4e42-84f1-bdd79dac0a59
        config: {}
        dataType: VARCHAR(44)
        description: ""
        name: SLSPN_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: "'Parts'"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3d44f2fa-4c10-4241-a117-a5b62ff0f5dc
          stepCounter: dbef99fb-172e-4e42-84f1-bdd79dac0a59
        config: {}
        dataType: VARCHAR(1000)
        description: ""
        name: COMM_ALLOCATION
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: "100"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8c1d3011-92f1-46e4-a2bb-b6192c42fb92
          stepCounter: dbef99fb-172e-4e42-84f1-bdd79dac0a59
        config: {}
        dataType: VARCHAR(20)
        description: ""
        name: SHIP_ZIP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 432bb3ad-248f-4599-8ab4-887a9ce3a794
                stepCounter: af53fc6c-dbe9-49dc-a793-5a3298e9d4cb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8bbff236-a474-4e31-8b28-d51c659337fd
          stepCounter: dbef99fb-172e-4e42-84f1-bdd79dac0a59
        config: {}
        dataType: VARCHAR(40)
        description: ""
        name: SHIP_CITY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a7534456-3ebd-414a-9d03-91b66ace64b5
                stepCounter: af53fc6c-dbe9-49dc-a793-5a3298e9d4cb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 63d34681-1de5-43a5-8685-3db9dedbdc8c
          stepCounter: dbef99fb-172e-4e42-84f1-bdd79dac0a59
        config: {}
        dataType: NUMBER(15,4)
        description: ""
        name: GROSS_AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 95c6182e-c199-4567-a164-2e95e83b6b4a
                stepCounter: af53fc6c-dbe9-49dc-a793-5a3298e9d4cb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: da052264-600d-49e0-9fbb-5d0b48843359
          stepCounter: dbef99fb-172e-4e42-84f1-bdd79dac0a59
        config: {}
        dataType: VARCHAR(10)
        description: ""
        name: ATIME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 66d3e911-cc41-43f0-bcf0-2bf74d77ec75
                stepCounter: af53fc6c-dbe9-49dc-a793-5a3298e9d4cb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4673b678-f682-4fa5-8ae5-10f553dbe3dd
          stepCounter: dbef99fb-172e-4e42-84f1-bdd79dac0a59
        config: {}
        dataType: VARCHAR(16)
        description: ""
        name: JOB_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 397f2826-534e-434a-8e66-10db8b53f1f4
                stepCounter: af53fc6c-dbe9-49dc-a793-5a3298e9d4cb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4517f3cd-bf6a-4681-bc0a-dfbf6fcf4f4b
          stepCounter: dbef99fb-172e-4e42-84f1-bdd79dac0a59
        config: {}
        dataType: TIMESTAMP_NTZ(9)
        description: ""
        name: WO_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3a967bbd-7058-4eb8-b866-e7ac1bebe212
                stepCounter: af53fc6c-dbe9-49dc-a793-5a3298e9d4cb
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3ed68791-bb08-446f-8efa-0b68f99579fd
          stepCounter: dbef99fb-172e-4e42-84f1-bdd79dac0a59
        config: {}
        dataType: VARCHAR(12)
        description: ""
        name: VENDOR_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1d6f2f94-8c2e-4dca-a7e9-d83c30f6177f
                stepCounter: 1b7e4ba2-1e35-469e-89a2-8f4a4c0b58a7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fe1648ae-788e-4704-85bb-b88ce685b9fa
          stepCounter: dbef99fb-172e-4e42-84f1-bdd79dac0a59
        config: {}
        dataType: VARCHAR(16)
        description: ""
        name: CUST_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7f23fd79-0e60-409e-80e7-c944e58f588b
                stepCounter: 1b7e4ba2-1e35-469e-89a2-8f4a4c0b58a7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: da8bb6aa-d133-479b-85c8-55a5757a49f5
          stepCounter: dbef99fb-172e-4e42-84f1-bdd79dac0a59
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: SEQ_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a8c4811f-bd99-4ffa-9f9a-cbb1fad82302
                stepCounter: 1b7e4ba2-1e35-469e-89a2-8f4a4c0b58a7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a3d766b8-e46c-44b4-a927-0419c9bac8ed
          stepCounter: dbef99fb-172e-4e42-84f1-bdd79dac0a59
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: QTY_SHIPPED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bc179312-bbf8-46e1-8630-81dfe942a37f
                stepCounter: 1b7e4ba2-1e35-469e-89a2-8f4a4c0b58a7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5e702373-6c20-41d1-8546-a238d1ad7eca
          stepCounter: dbef99fb-172e-4e42-84f1-bdd79dac0a59
        config: {}
        dataType: NUMBER(17,4)
        description: ""
        name: COST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 15e4d3da-897b-4db5-a8eb-1208d3fe9ac5
                stepCounter: 1b7e4ba2-1e35-469e-89a2-8f4a4c0b58a7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0ccddc61-1004-4a89-a837-26db5fbd3edc
          stepCounter: dbef99fb-172e-4e42-84f1-bdd79dac0a59
        config: {}
        dataType: VARCHAR(40)
        description: ""
        name: FIELD_7
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8bc87336-715d-468a-86cf-8ea8c556781f
                stepCounter: 1b7e4ba2-1e35-469e-89a2-8f4a4c0b58a7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0246670c-4012-410c-b330-17fc6c364f95
          stepCounter: dbef99fb-172e-4e42-84f1-bdd79dac0a59
        config: {}
        dataType: VARCHAR(32)
        description: ""
        name: ITEM_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 974ab70c-0540-4cbc-a99b-349922af02d7
                stepCounter: 1b7e4ba2-1e35-469e-89a2-8f4a4c0b58a7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2a036f58-230a-4f5a-852a-4f9976b2fe89
          stepCounter: dbef99fb-172e-4e42-84f1-bdd79dac0a59
        config: {}
        dataType: VARCHAR(8)
        description: ""
        name: UOM_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cee26fac-b398-4f3e-a497-167f606e056b
                stepCounter: 1b7e4ba2-1e35-469e-89a2-8f4a4c0b58a7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d11791b3-a17d-4abd-af1b-c645e3d3bea4
          stepCounter: dbef99fb-172e-4e42-84f1-bdd79dac0a59
        config: {}
        dataType: VARCHAR(8)
        description: ""
        name: COMM_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dece6967-3546-4830-a44c-6833267df59a
                stepCounter: 1b7e4ba2-1e35-469e-89a2-8f4a4c0b58a7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: cf976544-e761-4275-aec9-5b7b9b2567e2
          stepCounter: dbef99fb-172e-4e42-84f1-bdd79dac0a59
        config: {}
        dataType: NUMBER(7,2)
        description: ""
        name: COMM_RATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1d8b7293-0d0f-42c6-b115-84ce3ed2c583
                stepCounter: 1b7e4ba2-1e35-469e-89a2-8f4a4c0b58a7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 39518cbf-3195-4b31-a0df-0f78bb91a7f2
          stepCounter: dbef99fb-172e-4e42-84f1-bdd79dac0a59
        config: {}
        dataType: NUMBER(19,4)
        description: ""
        name: NET_PRICE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 61065fa5-37bd-4234-99e6-15057be6f868
                stepCounter: 1b7e4ba2-1e35-469e-89a2-8f4a4c0b58a7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c63d2889-0339-4961-8220-dcaac43c4625
          stepCounter: dbef99fb-172e-4e42-84f1-bdd79dac0a59
        config: {}
        dataType: VARCHAR(256)
        description: ""
        name: ITEM_VENDOR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c3ed559e-b40c-4b67-bc25-696972ea5853
                stepCounter: 1b7e4ba2-1e35-469e-89a2-8f4a4c0b58a7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 35472244-cffc-4683-b022-51d02748fdf3
          stepCounter: dbef99fb-172e-4e42-84f1-bdd79dac0a59
        config: {}
        dataType: NUMBER(18,4)
        description: ""
        name: GROSS_PRICE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c0c83dec-8de0-424e-940f-01b52dfbc8d4
                stepCounter: 1b7e4ba2-1e35-469e-89a2-8f4a4c0b58a7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c8e6b16a-8268-4d78-b06a-b43151ae8b44
          stepCounter: dbef99fb-172e-4e42-84f1-bdd79dac0a59
        config: {}
        dataType: VARCHAR(8)
        description: ""
        name: INVOICE_SLSPN_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cd9dbb1d-8880-4b0a-9677-43729e2377f9
                stepCounter: 1b7e4ba2-1e35-469e-89a2-8f4a4c0b58a7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3cc26888-2a13-4d39-bdae-d61fd45020f7
          stepCounter: dbef99fb-172e-4e42-84f1-bdd79dac0a59
        config: {}
        dataType: VARCHAR(16)
        description: ""
        name: DOCUMENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 50a190be-262d-4c92-bd7f-570852dafe00
                stepCounter: b4ffac55-8cb6-480d-8822-bda521cdbf24
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1a8d62ac-d363-42f0-ad14-f4006b867046
          stepCounter: dbef99fb-172e-4e42-84f1-bdd79dac0a59
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: PRD
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c302ecdf-e32a-432f-8038-249b61cecb63
                stepCounter: b4ffac55-8cb6-480d-8822-bda521cdbf24
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 47ba1471-5402-4023-b4e8-1a0611923124
          stepCounter: dbef99fb-172e-4e42-84f1-bdd79dac0a59
        config: {}
        dataType: TIMESTAMP_NTZ(9)
        description: ""
        name: INVOICE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 22e127a7-0aa6-4c7b-a794-c5e1c4d60a4f
                stepCounter: b4ffac55-8cb6-480d-8822-bda521cdbf24
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b3f80ae2-fd7a-4e85-8f95-41d2e257613a
          stepCounter: dbef99fb-172e-4e42-84f1-bdd79dac0a59
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: YR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 36cafd48-cc34-4688-9216-054f118dde94
                stepCounter: b4ffac55-8cb6-480d-8822-bda521cdbf24
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0af02ee4-31dc-4298-9eba-c2ee1272df21
          stepCounter: dbef99fb-172e-4e42-84f1-bdd79dac0a59
        config: {}
        dataType: VARCHAR(8)
        description: ""
        name: PROD_GROUP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e2eecae4-12d4-4837-8a16-1ad76223ecdc
                stepCounter: cad668ae-9b21-4063-b9da-af244d04642b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4ca53a12-181f-437b-94f1-2bfc55f524af
          stepCounter: dbef99fb-172e-4e42-84f1-bdd79dac0a59
        config: {}
        dataType: VARCHAR(8)
        description: ""
        name: PR_PROD_GROUP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8accbf1e-0807-47ed-b0d9-3a38b774188e
                stepCounter: ff14b386-d96c-4cb6-ac64-244703e4ef8e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0ce51224-8b1b-4fcc-bb45-afbbc671de30
          stepCounter: dbef99fb-172e-4e42-84f1-bdd79dac0a59
        config: {}
        dataType: VARCHAR(50)
        description: ""
        name: DESCRIPTION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1c7c3504-2fa8-401d-955d-d8071abed474
                stepCounter: ff14b386-d96c-4cb6-ac64-244703e4ef8e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 26f814b6-a8ea-484f-8dfa-74e88c6c8100
          stepCounter: dbef99fb-172e-4e42-84f1-bdd79dac0a59
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: UNIT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c9be4938-4130-4718-8f77-a7cfd9513504
                stepCounter: 85deb06d-fa39-4a43-886a-872cc4b5d22d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5bc5379c-eced-495c-8643-b2474e4e080c
          stepCounter: dbef99fb-172e-4e42-84f1-bdd79dac0a59
        config: {}
        dataType: NUMBER(13,2)
        description: ""
        name: EXTRA_CHARGE__9
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a787ecf8-2c5b-472e-ad15-372f3a379a56
                stepCounter: b4ffac55-8cb6-480d-8822-bda521cdbf24
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fd2a9bba-8bb9-48d8-a1f0-96a6d4478b08
          stepCounter: dbef99fb-172e-4e42-84f1-bdd79dac0a59
        config: {}
        dataType: VARCHAR(8)
        description: ""
        name: CALL_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 96a5af32-be7e-44c5-999f-bf7a75289ca7
                stepCounter: af53fc6c-dbe9-49dc-a793-5a3298e9d4cb
            transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 7243e1c1-deb4-4d44-953a-bd143847065e
          stepCounter: dbef99fb-172e-4e42-84f1-bdd79dac0a59
        config: {}
        dataType: NUMBER(15,2)
        defaultValue: ""
        description: ""
        keyColumnType: None
        name: EDF
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: |-
              CASE
                  WHEN "STG_INVOICE"."ORDER_NO" IN ('135367') AND "STG_UOM"."UNIT" = '100' AND LEFT("STG_ITEM"."PROD_GROUP",3) IN ('100','146','171','147','172','173','174','175','176','177','178','179','183','184','185','186','187','188','189','190','400','402','404','406','408','411','412','414','416','420','424','426','427','448','550','551','552') THEN ("STG_INVOICE_LINE"."QTY_SHIPPED" / CAST(100 AS NUMERIC(10,2))) * "STG_INVOICE_LINE"."COST" * 1.5 / 100
                  WHEN "STG_INVOICE"."ORDER_NO" IN ('135367') AND "STG_UOM"."UNIT" <> '100' AND LEFT("STG_ITEM"."PROD_GROUP",3) IN ('100','146','171','147','172','173','174','175','176','177','178','179','183','184','185','186','187','188','189','190','400','402','404','406','408','411','412','414','416','420','424','426','427','448','550','551','552') THEN ("STG_INVOICE_LINE"."QTY_SHIPPED" / CAST(100 AS NUMERIC(10,2))) * "STG_INVOICE_LINE"."COST" * 1.5 / 100
                  WHEN "STG_WO"."WO_DATE" < '01/01/2025' THEN 0
                  WHEN "STG_UOM"."UNIT" = '100' AND LEFT("STG_ITEM"."PROD_GROUP",3) IN ('180','181') THEN (("STG_INVOICE_LINE"."QTY_SHIPPED"  / CAST(100 AS NUMERIC(10,2))) * "STG_INVOICE_LINE"."NET_PRICE") * 2 / 100
                  WHEN "STG_UOM"."UNIT" <> '100' AND LEFT("STG_ITEM"."PROD_GROUP",3) IN ('180','181') THEN ("STG_INVOICE_LINE"."QTY_SHIPPED"  * "STG_INVOICE_LINE"."NET_PRICE") * 2 / 100
                  WHEN "STG_UOM"."UNIT" = '100' AND LEFT("STG_ITEM"."PROD_GROUP",3) IN ('100','146','171','147','172','173','174','175','176','177','178','179','183','184','185','186','187','188','189','190','400','402','404','406','408','411','412','414','416','420','424','426','427','448','550','551','552') THEN (("STG_INVOICE_LINE"."QTY_SHIPPED"  / CAST(100 AS NUMERIC(10,2))) * "STG_INVOICE_LINE"."NET_PRICE") * 1 / 100
                  WHEN "STG_UOM"."UNIT" <> '100' AND LEFT("STG_ITEM"."PROD_GROUP",3) IN ('100','146','171','147','172','173','174','175','176','177','178','179','183','184','185','186','187','188','189','190','400','402','404','406','408','411','412','414','416','420','424','426','427','448','550','551','552') THEN ("STG_INVOICE_LINE"."QTY_SHIPPED"  * "STG_INVOICE_LINE"."NET_PRICE") * 1 / 100
                  ELSE 0 
              END
        systemColumnType: None
    cteString: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          STG_INVOICE: b4ffac55-8cb6-480d-8822-bda521cdbf24
          STG_INVOICE_LINE: 1b7e4ba2-1e35-469e-89a2-8f4a4c0b58a7
          STG_ITEM: cad668ae-9b21-4063-b9da-af244d04642b
          STG_PR_GROUP: ff14b386-d96c-4cb6-ac64-244703e4ef8e
          STG_UOM: 85deb06d-fa39-4a43-886a-872cc4b5d22d
          STG_WO: af53fc6c-dbe9-49dc-a793-5a3298e9d4cb
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: RMH_SQL_SERVER_SERVICE_STG
            nodeName: STG_INVOICE
          - locationName: RMH_SQL_SERVER_SERVICE_STG
            nodeName: STG_INVOICE_LINE
          - locationName: RMH_SQL_SERVER_SERVICE_STG
            nodeName: STG_ITEM
          - locationName: RMH_SQL_SERVER_SERVICE_STG
            nodeName: STG_PR_GROUP
          - locationName: RMH_SQL_SERVER_SERVICE_STG
            nodeName: STG_UOM
          - locationName: RMH_SQL_SERVER_SERVICE_STG
            nodeName: STG_WO
        join:
          joinCondition: |-
            FROM {{ ref('RMH_SQL_SERVER_SERVICE_STG', 'STG_WO') }} "STG_WO"
            INNER JOIN {{ ref('RMH_SQL_SERVER_SERVICE_STG', 'STG_INVOICE_LINE') }} "STG_INVOICE_LINE"
            ON "STG_WO"."WO_NO" = "STG_INVOICE_LINE"."WONO"
            INNER JOIN {{ ref('RMH_SQL_SERVER_SERVICE_STG', 'STG_INVOICE') }} "STG_INVOICE"
            ON "STG_INVOICE_LINE"."SEQ_NO" = "STG_INVOICE"."SEQ_NO"
            INNER JOIN {{ ref('RMH_SQL_SERVER_SERVICE_STG', 'STG_ITEM') }} "STG_ITEM"
            ON "STG_INVOICE_LINE"."ITEM_NO" = "STG_ITEM"."ITEM_NO"
            INNER JOIN {{ ref('RMH_SQL_SERVER_SERVICE_STG', 'STG_PR_GROUP') }} "STG_PR_GROUP"
            ON "STG_ITEM"."PROD_GROUP" = "STG_PR_GROUP"."PROD_GROUP"
            INNER JOIN {{ ref('RMH_SQL_SERVER_SERVICE_STG', 'STG_UOM') }} "STG_UOM"
            ON "STG_INVOICE_LINE"."UOM_CODE" = "STG_UOM"."UOM_CODE"


            WHERE "STG_PR_GROUP"."PROD_GROUP" IN ('103', '103F', '199', '199F', '331', '331F', '333', '333F', '399', '399F', '450', '450F', '453', '453F', '490', '490F', '499', '499F')
        name: STG_SALES_WO_TRANSACTIONS_PARTS
        noLinkRefs: []
  name: STG_SALES_WO_TRANSACTIONS_PARTS
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node

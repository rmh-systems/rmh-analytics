fileVersion: 1
id: 2d84dc99-7aec-4a21-b0b4-02b0c6bc06d4
name: STG_SALES_TRANSACTIONS_WITH_CALCULATIONS
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: RMH_SQL_SERVER_SERVICE_RAW
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d9df0204-7bc1-4d60-ab8b-bc4e2df0d617
          stepCounter: 2d84dc99-7aec-4a21-b0b4-02b0c6bc06d4
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: SEQ_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 672dd3ec-e20b-48fa-8524-9abcf9240768
                stepCounter: a999c6b5-0f58-4e4e-a95a-a429ea2b4ee2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 79b72ec8-6fc7-4646-92b1-1b8d5266b02c
          stepCounter: 2d84dc99-7aec-4a21-b0b4-02b0c6bc06d4
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: ORDER_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bfd0994d-6e4d-4e1f-9fd9-c310bb5453d5
                stepCounter: a999c6b5-0f58-4e4e-a95a-a429ea2b4ee2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0e1ecbc6-27d4-40df-9793-2088543e2043
          stepCounter: 2d84dc99-7aec-4a21-b0b4-02b0c6bc06d4
        config: {}
        dataType: VARCHAR(32)
        description: ""
        name: ITEM_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9f843522-3a0f-4629-b168-90262e84a6e6
                stepCounter: a999c6b5-0f58-4e4e-a95a-a429ea2b4ee2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c7e0288b-3c33-4245-9983-537924d17427
          stepCounter: 2d84dc99-7aec-4a21-b0b4-02b0c6bc06d4
        config: {}
        dataType: VARCHAR(16)
        description: ""
        name: CUST_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6571cce3-7574-4f1e-8206-611588961d4d
                stepCounter: a999c6b5-0f58-4e4e-a95a-a429ea2b4ee2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2efab453-8828-4ef9-b343-e34fbf3e07db
          stepCounter: 2d84dc99-7aec-4a21-b0b4-02b0c6bc06d4
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: QTY_SHIPPED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e8ddb3cb-74e2-4477-95c4-f21f4c999b14
                stepCounter: a999c6b5-0f58-4e4e-a95a-a429ea2b4ee2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 205f13f6-f278-436f-9446-ff52a8430397
          stepCounter: 2d84dc99-7aec-4a21-b0b4-02b0c6bc06d4
        config: {}
        dataType: NUMBER(19,4)
        description: ""
        name: NET_PRICE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 767f7963-803c-4d45-8627-edc8389cd87b
                stepCounter: a999c6b5-0f58-4e4e-a95a-a429ea2b4ee2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c1dfa151-5c29-4cb8-bb08-c86d42a1f91d
          stepCounter: 2d84dc99-7aec-4a21-b0b4-02b0c6bc06d4
        config: {}
        dataType: NUMBER(17,4)
        description: ""
        name: COST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e9c5719d-ab46-4b19-b040-a48d73f2e0be
                stepCounter: a999c6b5-0f58-4e4e-a95a-a429ea2b4ee2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 99e04d3a-3022-4361-bf88-3339a440e89a
          stepCounter: 2d84dc99-7aec-4a21-b0b4-02b0c6bc06d4
        config: {}
        dataType: BOOLEAN
        description: ""
        name: DROP_SHIP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 44033ac0-d140-4e95-9260-78f090229cb2
                stepCounter: a999c6b5-0f58-4e4e-a95a-a429ea2b4ee2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fa313816-35e7-48f1-8e97-becfc1ae5729
          stepCounter: 2d84dc99-7aec-4a21-b0b4-02b0c6bc06d4
        config: {}
        dataType: VARCHAR(6)
        description: ""
        name: PURCHASE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 22f5ef65-585d-45b1-be7a-f2b93735daa7
                stepCounter: a999c6b5-0f58-4e4e-a95a-a429ea2b4ee2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4fa8a58c-963e-48f3-a928-2415154ef094
          stepCounter: 2d84dc99-7aec-4a21-b0b4-02b0c6bc06d4
        config: {}
        dataType: VARCHAR(80)
        description: ""
        name: FIELD_9
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 21e7854a-135f-4e32-8747-8ce273e0132b
                stepCounter: a999c6b5-0f58-4e4e-a95a-a429ea2b4ee2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9ad2c90e-26a7-4ae9-93ce-4f302ae6bf1c
          stepCounter: 2d84dc99-7aec-4a21-b0b4-02b0c6bc06d4
        config: {}
        dataType: VARCHAR(16)
        description: ""
        name: DOCUMENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a5de8df1-d4cf-4633-b584-fc8835f85bf4
                stepCounter: a999c6b5-0f58-4e4e-a95a-a429ea2b4ee2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 437fc784-63bc-4215-a9db-04a4c9b2f009
          stepCounter: 2d84dc99-7aec-4a21-b0b4-02b0c6bc06d4
        config: {}
        dataType: TIMESTAMP_NTZ(9)
        description: ""
        name: INVOICE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1d19c61b-d6ff-48b2-ab04-e2f682ddc07e
                stepCounter: a999c6b5-0f58-4e4e-a95a-a429ea2b4ee2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8ef0522f-99c6-42b8-a014-de0cddec2cdf
          stepCounter: 2d84dc99-7aec-4a21-b0b4-02b0c6bc06d4
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: YR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4e56812c-65ee-41ae-bef1-c42dbfcd7023
                stepCounter: a999c6b5-0f58-4e4e-a95a-a429ea2b4ee2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e853f121-79a8-422a-8149-db877cee6ca0
          stepCounter: 2d84dc99-7aec-4a21-b0b4-02b0c6bc06d4
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: PRD
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 581db9d7-70f8-48e7-841f-fed19ac97f4c
                stepCounter: a999c6b5-0f58-4e4e-a95a-a429ea2b4ee2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c94e479f-8aa7-4664-851f-332f7b10f9be
          stepCounter: 2d84dc99-7aec-4a21-b0b4-02b0c6bc06d4
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: INVOICE_ORDER_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a78e8093-fb60-4813-aa33-fbde0c4e6b60
                stepCounter: a999c6b5-0f58-4e4e-a95a-a429ea2b4ee2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5d2af203-65f6-4c6b-bf00-bb9e75d95dd9
          stepCounter: 2d84dc99-7aec-4a21-b0b4-02b0c6bc06d4
        config: {}
        dataType: VARCHAR(100)
        description: ""
        name: SHIP_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a20c10dc-c5a8-4d3b-8b54-5e28ec1f917c
                stepCounter: a999c6b5-0f58-4e4e-a95a-a429ea2b4ee2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 53ac175f-f553-43c3-a307-b545e72e2d16
          stepCounter: 2d84dc99-7aec-4a21-b0b4-02b0c6bc06d4
        config: {}
        dataType: VARCHAR(40)
        description: ""
        name: FIELD_1
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2851433a-2ab3-4c47-a7e8-058fd39dd96c
                stepCounter: a999c6b5-0f58-4e4e-a95a-a429ea2b4ee2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1a7c17fa-1218-432d-8515-3df6e0622e19
          stepCounter: 2d84dc99-7aec-4a21-b0b4-02b0c6bc06d4
        config: {}
        dataType: VARCHAR(40)
        description: ""
        name: FIELD_2
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b726eade-922a-4062-b8d2-6238d4d5c3b5
                stepCounter: a999c6b5-0f58-4e4e-a95a-a429ea2b4ee2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e0857b54-ad1c-4ffd-9aa8-a6a0cbd8eeeb
          stepCounter: 2d84dc99-7aec-4a21-b0b4-02b0c6bc06d4
        config: {}
        dataType: VARCHAR(40)
        description: ""
        name: FIELD_7
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f6558716-62c2-48a5-8449-982c36d9dcf0
                stepCounter: a999c6b5-0f58-4e4e-a95a-a429ea2b4ee2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b28e3738-31b1-4288-92f3-89ab005317f9
          stepCounter: 2d84dc99-7aec-4a21-b0b4-02b0c6bc06d4
        config: {}
        dataType: VARCHAR(40)
        description: ""
        name: ORDER_FIELD_9
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bcc3fafe-c974-4693-921a-a3118f151b50
                stepCounter: a999c6b5-0f58-4e4e-a95a-a429ea2b4ee2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d8ee2075-c4da-4b18-9bf1-3f496f03da4a
          stepCounter: 2d84dc99-7aec-4a21-b0b4-02b0c6bc06d4
        config: {}
        dataType: TIMESTAMP_NTZ(9)
        description: ""
        name: CREATEDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 684dd894-5564-453c-ac42-83592fa3f1d5
                stepCounter: a999c6b5-0f58-4e4e-a95a-a429ea2b4ee2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d9de1a72-0a64-42ba-9cad-8c8bae2cfae7
          stepCounter: 2d84dc99-7aec-4a21-b0b4-02b0c6bc06d4
        config: {}
        dataType: VARCHAR(8)
        description: ""
        name: PROD_GROUP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f4e2cde4-4c49-4a45-a4ac-7edeba515570
                stepCounter: a999c6b5-0f58-4e4e-a95a-a429ea2b4ee2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2043bd75-d9a6-4892-9e95-08e68aa17e50
          stepCounter: 2d84dc99-7aec-4a21-b0b4-02b0c6bc06d4
        config: {}
        dataType: VARCHAR(8)
        description: ""
        name: PR_PROD_GROUP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 401acbd7-aadb-4223-93c9-65f190812897
                stepCounter: a999c6b5-0f58-4e4e-a95a-a429ea2b4ee2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 525f9238-33e6-4e1d-9e2f-0063260596ca
          stepCounter: 2d84dc99-7aec-4a21-b0b4-02b0c6bc06d4
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: UNIT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d54028f2-2d67-4cab-9929-4401291458d2
                stepCounter: a999c6b5-0f58-4e4e-a95a-a429ea2b4ee2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7289c839-a044-4f78-b0db-4a28947c9933
          stepCounter: 2d84dc99-7aec-4a21-b0b4-02b0c6bc06d4
        config: {}
        dataType: VARCHAR(44)
        description: ""
        name: SLSPN_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: aa4dd463-a7f9-46cb-9f0f-fb712e5b180d
                stepCounter: a999c6b5-0f58-4e4e-a95a-a429ea2b4ee2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 654ef78a-e9cd-4ce6-95f1-2ef06c7d7d86
          stepCounter: 2d84dc99-7aec-4a21-b0b4-02b0c6bc06d4
        config: {}
        dataType: VARCHAR(8)
        description: ""
        name: SLSPN_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 82dc906c-8f8d-4cfb-a67e-ccd44598f43c
                stepCounter: a999c6b5-0f58-4e4e-a95a-a429ea2b4ee2
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 22342d08-45f2-4fc1-bb35-34409560848b
          stepCounter: 2d84dc99-7aec-4a21-b0b4-02b0c6bc06d4
        config: {}
        dataType: NUMBER(7,4)
        description: ""
        name: COMMRATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2391a952-f1f3-4288-9c74-c0f34964d2c8
                stepCounter: a999c6b5-0f58-4e4e-a95a-a429ea2b4ee2
            transform: |-
              CASE 
                  WHEN "SLSPN_CODE" = '930'
                      AND (CASE WHEN LENGTH("FIELD_7") > 3 THEN 'Yes' ELSE 'No' END) = 'No'
                  THEN 15.0
                  ELSE COALESCE("STG_SALES_TRANSACTIONS"."COMMRATE", 0.0)
              END
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: ea7ab546-4b49-442c-bb83-91ee36278066
          stepCounter: 2d84dc99-7aec-4a21-b0b4-02b0c6bc06d4
        config: {}
        dataType: NUMBER(38, 2)
        defaultValue: ""
        description: ""
        keyColumnType: None
        name: REVENUE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: |-
              CASE
                  WHEN "STG_SALES_TRANSACTIONS"."UNIT" = 100
                  THEN
              ("STG_SALES_TRANSACTIONS"."QTY_SHIPPED" * "STG_SALES_TRANSACTIONS"."NET_PRICE") / 100
                  ELSE "STG_SALES_TRANSACTIONS"."QTY_SHIPPED" * "STG_SALES_TRANSACTIONS"."NET_PRICE"
              END
        systemColumnType: None
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: fa21e3b1-3597-40b7-b53b-532d02e4a07f
          stepCounter: 2d84dc99-7aec-4a21-b0b4-02b0c6bc06d4
        config: {}
        dataType: NUMBER(38, 2)
        defaultValue: ""
        description: ""
        keyColumnType: None
        name: TOTAL_COST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: |-
              CASE
                  WHEN "STG_SALES_TRANSACTIONS"."UNIT" = 100
                  THEN
              ("STG_SALES_TRANSACTIONS"."QTY_SHIPPED" * "STG_SALES_TRANSACTIONS"."COST") / 100
                  ELSE "STG_SALES_TRANSACTIONS"."QTY_SHIPPED" * "STG_SALES_TRANSACTIONS"."COST"
              END
        systemColumnType: None
    cteString: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases: {}
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: RMH_SQL_SERVER_SERVICE_STG
            nodeName: STG_SALES_TRANSACTIONS
        join:
          joinCondition: FROM {{ ref('RMH_SQL_SERVER_SERVICE_STG', 'STG_SALES_TRANSACTIONS') }} "STG_SALES_TRANSACTIONS"
        name: STG_SALES_TRANSACTIONS_WITH_CALCULATIONS
        noLinkRefs: []
  name: STG_SALES_TRANSACTIONS_WITH_CALCULATIONS
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node

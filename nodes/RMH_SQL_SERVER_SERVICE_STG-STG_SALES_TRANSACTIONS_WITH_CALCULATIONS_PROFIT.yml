fileVersion: 1
id: a8dc3768-318c-40bf-8190-ae4883daa82a
name: STG_SALES_TRANSACTIONS_WITH_CALCULATIONS_PROFIT
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: RMH_SQL_SERVER_SERVICE_STG
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7c31d0e4-2776-4fe4-a95c-53f1dbcbd3d9
          stepCounter: a8dc3768-318c-40bf-8190-ae4883daa82a
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: SEQ_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d9df0204-7bc1-4d60-ab8b-bc4e2df0d617
                stepCounter: 2d84dc99-7aec-4a21-b0b4-02b0c6bc06d4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 620deeff-f795-4b58-9667-6e3cd7d32f7b
          stepCounter: a8dc3768-318c-40bf-8190-ae4883daa82a
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: ORDER_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 79b72ec8-6fc7-4646-92b1-1b8d5266b02c
                stepCounter: 2d84dc99-7aec-4a21-b0b4-02b0c6bc06d4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: eacb7e92-1edd-4651-9f1b-61386dad4fb9
          stepCounter: a8dc3768-318c-40bf-8190-ae4883daa82a
        config: {}
        dataType: VARCHAR(32)
        description: ""
        name: ITEM_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0e1ecbc6-27d4-40df-9793-2088543e2043
                stepCounter: 2d84dc99-7aec-4a21-b0b4-02b0c6bc06d4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 256bf39a-a98d-4066-a1c2-f90461dac16b
          stepCounter: a8dc3768-318c-40bf-8190-ae4883daa82a
        config: {}
        dataType: VARCHAR(16)
        description: ""
        name: CUST_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c7e0288b-3c33-4245-9983-537924d17427
                stepCounter: 2d84dc99-7aec-4a21-b0b4-02b0c6bc06d4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 11a9dc4b-4590-48f3-9afd-8732b728bc58
          stepCounter: a8dc3768-318c-40bf-8190-ae4883daa82a
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: QTY_SHIPPED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2efab453-8828-4ef9-b343-e34fbf3e07db
                stepCounter: 2d84dc99-7aec-4a21-b0b4-02b0c6bc06d4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9937b02a-60d4-498a-bdc5-052f5a4b74a6
          stepCounter: a8dc3768-318c-40bf-8190-ae4883daa82a
        config: {}
        dataType: NUMBER(19,4)
        description: ""
        name: NET_PRICE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 205f13f6-f278-436f-9446-ff52a8430397
                stepCounter: 2d84dc99-7aec-4a21-b0b4-02b0c6bc06d4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 09a2c37c-22d2-4be9-9a95-c17ef6e7a5a8
          stepCounter: a8dc3768-318c-40bf-8190-ae4883daa82a
        config: {}
        dataType: NUMBER(17,4)
        description: ""
        name: COST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c1dfa151-5c29-4cb8-bb08-c86d42a1f91d
                stepCounter: 2d84dc99-7aec-4a21-b0b4-02b0c6bc06d4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b8fe2667-ffd0-4334-b5c3-d8c37e1e8526
          stepCounter: a8dc3768-318c-40bf-8190-ae4883daa82a
        config: {}
        dataType: BOOLEAN
        description: ""
        name: DROP_SHIP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 99e04d3a-3022-4361-bf88-3339a440e89a
                stepCounter: 2d84dc99-7aec-4a21-b0b4-02b0c6bc06d4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 474fcbd8-b838-4908-85a2-a5780f43fdb0
          stepCounter: a8dc3768-318c-40bf-8190-ae4883daa82a
        config: {}
        dataType: VARCHAR(6)
        description: ""
        name: PURCHASE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fa313816-35e7-48f1-8e97-becfc1ae5729
                stepCounter: 2d84dc99-7aec-4a21-b0b4-02b0c6bc06d4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b0ec1a19-2fad-4c68-88e1-d43d8d1fb513
          stepCounter: a8dc3768-318c-40bf-8190-ae4883daa82a
        config: {}
        dataType: VARCHAR(80)
        description: ""
        name: FIELD_9
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4fa8a58c-963e-48f3-a928-2415154ef094
                stepCounter: 2d84dc99-7aec-4a21-b0b4-02b0c6bc06d4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5bfa6537-6742-4eba-a9b9-035840e63810
          stepCounter: a8dc3768-318c-40bf-8190-ae4883daa82a
        config: {}
        dataType: VARCHAR(16)
        description: ""
        name: DOCUMENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9ad2c90e-26a7-4ae9-93ce-4f302ae6bf1c
                stepCounter: 2d84dc99-7aec-4a21-b0b4-02b0c6bc06d4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 13793f0b-0726-4172-885c-c873e418e0f3
          stepCounter: a8dc3768-318c-40bf-8190-ae4883daa82a
        config: {}
        dataType: TIMESTAMP_NTZ(9)
        description: ""
        name: INVOICE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 437fc784-63bc-4215-a9db-04a4c9b2f009
                stepCounter: 2d84dc99-7aec-4a21-b0b4-02b0c6bc06d4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 29f9328c-989c-4f3f-a931-925f07ec97df
          stepCounter: a8dc3768-318c-40bf-8190-ae4883daa82a
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: YR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8ef0522f-99c6-42b8-a014-de0cddec2cdf
                stepCounter: 2d84dc99-7aec-4a21-b0b4-02b0c6bc06d4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ecf755ae-c566-4b34-b698-f036f15c1983
          stepCounter: a8dc3768-318c-40bf-8190-ae4883daa82a
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: PRD
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e853f121-79a8-422a-8149-db877cee6ca0
                stepCounter: 2d84dc99-7aec-4a21-b0b4-02b0c6bc06d4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 332cbda7-8a97-4abc-9d20-ff53b33e1583
          stepCounter: a8dc3768-318c-40bf-8190-ae4883daa82a
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: INVOICE_ORDER_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c94e479f-8aa7-4664-851f-332f7b10f9be
                stepCounter: 2d84dc99-7aec-4a21-b0b4-02b0c6bc06d4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f813ca12-1dcb-400e-8e5d-e7fd6fdcd0b9
          stepCounter: a8dc3768-318c-40bf-8190-ae4883daa82a
        config: {}
        dataType: VARCHAR(100)
        description: ""
        name: SHIP_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5d2af203-65f6-4c6b-bf00-bb9e75d95dd9
                stepCounter: 2d84dc99-7aec-4a21-b0b4-02b0c6bc06d4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8a9efee3-ada7-410d-ad05-f55135e9aa6f
          stepCounter: a8dc3768-318c-40bf-8190-ae4883daa82a
        config: {}
        dataType: VARCHAR(40)
        description: ""
        name: FIELD_1
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 53ac175f-f553-43c3-a307-b545e72e2d16
                stepCounter: 2d84dc99-7aec-4a21-b0b4-02b0c6bc06d4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2836efde-e341-4eff-a8c4-ae28d1481dec
          stepCounter: a8dc3768-318c-40bf-8190-ae4883daa82a
        config: {}
        dataType: VARCHAR(40)
        description: ""
        name: FIELD_2
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1a7c17fa-1218-432d-8515-3df6e0622e19
                stepCounter: 2d84dc99-7aec-4a21-b0b4-02b0c6bc06d4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: af080b71-2452-4cbd-88fa-38bbc7be020b
          stepCounter: a8dc3768-318c-40bf-8190-ae4883daa82a
        config: {}
        dataType: VARCHAR(40)
        description: ""
        name: FIELD_7
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e0857b54-ad1c-4ffd-9aa8-a6a0cbd8eeeb
                stepCounter: 2d84dc99-7aec-4a21-b0b4-02b0c6bc06d4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7edf4e12-a636-450b-b89f-8ff2f3123dd7
          stepCounter: a8dc3768-318c-40bf-8190-ae4883daa82a
        config: {}
        dataType: VARCHAR(40)
        description: ""
        name: ORDER_FIELD_9
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b28e3738-31b1-4288-92f3-89ab005317f9
                stepCounter: 2d84dc99-7aec-4a21-b0b4-02b0c6bc06d4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b379159a-b995-44cf-8555-73e2eabb2984
          stepCounter: a8dc3768-318c-40bf-8190-ae4883daa82a
        config: {}
        dataType: TIMESTAMP_NTZ(9)
        description: ""
        name: CREATEDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d8ee2075-c4da-4b18-9bf1-3f496f03da4a
                stepCounter: 2d84dc99-7aec-4a21-b0b4-02b0c6bc06d4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5a26bdf5-6990-48b0-a9db-bc7ac7f19d1b
          stepCounter: a8dc3768-318c-40bf-8190-ae4883daa82a
        config: {}
        dataType: VARCHAR(8)
        description: ""
        name: PROD_GROUP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d9de1a72-0a64-42ba-9cad-8c8bae2cfae7
                stepCounter: 2d84dc99-7aec-4a21-b0b4-02b0c6bc06d4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 24adbb1e-7216-433e-9329-fe8568f75b4d
          stepCounter: a8dc3768-318c-40bf-8190-ae4883daa82a
        config: {}
        dataType: VARCHAR(8)
        description: ""
        name: PR_PROD_GROUP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2043bd75-d9a6-4892-9e95-08e68aa17e50
                stepCounter: 2d84dc99-7aec-4a21-b0b4-02b0c6bc06d4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c4e49e08-5286-46b6-91af-de95a165f7e7
          stepCounter: a8dc3768-318c-40bf-8190-ae4883daa82a
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: UNIT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 525f9238-33e6-4e1d-9e2f-0063260596ca
                stepCounter: 2d84dc99-7aec-4a21-b0b4-02b0c6bc06d4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 71eff65c-f23c-42b4-a351-fc612d1e61b3
          stepCounter: a8dc3768-318c-40bf-8190-ae4883daa82a
        config: {}
        dataType: VARCHAR(44)
        description: ""
        name: SLSPN_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7289c839-a044-4f78-b0db-4a28947c9933
                stepCounter: 2d84dc99-7aec-4a21-b0b4-02b0c6bc06d4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d7bb7e82-0f11-41e6-87fb-c0de22ad93db
          stepCounter: a8dc3768-318c-40bf-8190-ae4883daa82a
        config: {}
        dataType: VARCHAR(8)
        description: ""
        name: SLSPN_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 654ef78a-e9cd-4ce6-95f1-2ef06c7d7d86
                stepCounter: 2d84dc99-7aec-4a21-b0b4-02b0c6bc06d4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e94e2ea6-2a14-4150-bcbb-0a6787c679eb
          stepCounter: a8dc3768-318c-40bf-8190-ae4883daa82a
        config: {}
        dataType: NUMBER(7,4)
        description: ""
        name: COMMRATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 22342d08-45f2-4fc1-bb35-34409560848b
                stepCounter: 2d84dc99-7aec-4a21-b0b4-02b0c6bc06d4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ad1d9f2b-d413-4fe6-98a2-08187ae4eaa6
          stepCounter: a8dc3768-318c-40bf-8190-ae4883daa82a
        config: {}
        dataType: NUMBER(38, 2)
        description: ""
        name: REVENUE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ea7ab546-4b49-442c-bb83-91ee36278066
                stepCounter: 2d84dc99-7aec-4a21-b0b4-02b0c6bc06d4
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3b3a6896-b27c-42ae-a86b-b53017421f76
          stepCounter: a8dc3768-318c-40bf-8190-ae4883daa82a
        config: {}
        dataType: NUMBER(38, 2)
        description: ""
        name: TOTAL_COST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fa21e3b1-3597-40b7-b53b-532d02e4a07f
                stepCounter: 2d84dc99-7aec-4a21-b0b4-02b0c6bc06d4
            transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: d64cc702-98be-4c73-a62e-493adaebd9e2
          stepCounter: a8dc3768-318c-40bf-8190-ae4883daa82a
        config: {}
        dataType: NUMBER(38, 2)
        defaultValue: ""
        description: ""
        keyColumnType: None
        name: PROFIT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: "\"STG_SALES_TRANSACTIONS_WITH_CALCULATIONS\".\"REVENUE\" - \"STG_SALES_TRANSACTIONS_WITH_CALCULATIONS\".\"TOTAL_COST\""
        systemColumnType: None
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: d47131be-e1ef-41d4-bb69-68c12470a679
          stepCounter: a8dc3768-318c-40bf-8190-ae4883daa82a
        config: {}
        dataType: VARCHAR
        defaultValue: ""
        description: ""
        keyColumnType: None
        name: COMM_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: |-
              CASE
                  WHEN "STG_SALES_TRANSACTIONS_WITH_CALCULATIONS"."FIELD_9" = 'DIRECT' THEN 'DIR'
                  WHEN "STG_SALES_TRANSACTIONS_WITH_CALCULATIONS"."FIELD_9" = 'INSTOCK' THEN 'INS'
                  WHEN COALESCE("STG_SALES_TRANSACTIONS_WITH_CALCULATIONS"."FIELD_9", '') = '' AND "STG_SALES_TRANSACTIONS_WITH_CALCULATIONS"."ORDER_FIELD_9" = 'DIRECT' THEN 'DIR'
                  WHEN COALESCE("STG_SALES_TRANSACTIONS_WITH_CALCULATIONS"."FIELD_9", '') = '' AND "STG_SALES_TRANSACTIONS_WITH_CALCULATIONS"."ORDER_FIELD_9" = 'INSTOCK' THEN 'INS'
                  ELSE ''
              END
        systemColumnType: None
    cteString: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases: {}
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: RMH_SQL_SERVER_SERVICE_RAW
            nodeName: STG_SALES_TRANSACTIONS_WITH_CALCULATIONS
        join:
          joinCondition: FROM {{ ref('RMH_SQL_SERVER_SERVICE_RAW', 'STG_SALES_TRANSACTIONS_WITH_CALCULATIONS') }} "STG_SALES_TRANSACTIONS_WITH_CALCULATIONS"
        name: STG_SALES_TRANSACTIONS_WITH_CALCULATIONS_PROFIT
        noLinkRefs: []
  name: STG_SALES_TRANSACTIONS_WITH_CALCULATIONS_PROFIT
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node

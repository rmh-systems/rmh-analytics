fileVersion: 1
id: a29fdaad-1d10-4540-a980-ff24ed2f2a64
name: STG_BOOKINGS_BR_JOB_SLSPN1
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: RMH_SQL_SERVER_SERVICE_STG
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0f42db41-5f6e-4bfa-b177-d3a88d40a7dc
          stepCounter: a29fdaad-1d10-4540-a980-ff24ed2f2a64
        config: {}
        dataType: VARCHAR(50)
        description: ""
        name: TRANS_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 962752fc-cde0-4b4d-8838-144e4c1fc6df
                stepCounter: a6664eba-bfce-4e3e-aa7b-50312cb6cd43
            transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 6ce64868-ee56-424e-b136-60d4acea9030
          stepCounter: a29fdaad-1d10-4540-a980-ff24ed2f2a64
        config: {}
        dataType: VARCHAR(50)
        defaultValue: ""
        description: ""
        keyColumnType: None
        name: SLSPN_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: |-
              CASE
                  WHEN IFNULL("STG_JOB_ORDER"."FIELD_1",'') IN ('House Account','House Account PKG') AND "STG_JOB"."USER_ID" IN ('kreeves','birmiter','pcrawford','dwiley','kskinner','aburgraff','bborchardt','bborchar','kgrandgenett','nwelch','tchafa','rscholl','tbruns','jmetz') THEN 'House Acct - IA'
                  WHEN IFNULL("STG_JOB_ORDER"."FIELD_1",'') IN ('House Account','House Account PKG') AND"STG_JOB"."USER_ID" IN ('rwilkins','aforeman','bhoover','mwalker') THEN 'House Acct - NE'
                  WHEN IFNULL("STG_JOB_ORDER"."FIELD_1",'') IN ('House Account','House Account PKG') AND"STG_JOB"."USER_ID" IN ('ccocasse','pmlsna','rholland') THEN 'House Acct - MN'
                  WHEN IFNULL("STG_JOB_ORDER"."FIELD_1",'') IN ('House Account','House Account PKG') AND"STG_JOB"."USER_ID" IN ('sprisant','igarlanger','jfernandez') THEN 'House Acct - IL'
                  WHEN IFNULL("STG_JOB_ORDER"."FIELD_1",'') IN ('House Account - IL') THEN 'House Acct - IL'
                  WHEN IFNULL("STG_JOB_ORDER"."FIELD_1",'') IN ('House Account','House Account PKG') AND "STG_JOB"."ST" IN ('MN') THEN 'House Acct - MN'
                  ELSE IFNULL("STG_JOB_ORDER"."FIELD_1",'') 
              END
        systemColumnType: None
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 03769f3a-944a-4d00-bbd9-2f697862f5e3
          stepCounter: a29fdaad-1d10-4540-a980-ff24ed2f2a64
        config: {}
        dataType: NUMBER(4,0)
        description: ""
        name: YEAR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2336403f-5568-4f10-9b29-117e42e96d20
                stepCounter: a6664eba-bfce-4e3e-aa7b-50312cb6cd43
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 75225bbb-4db8-4bed-b1a4-58310d4ba28c
          stepCounter: a29fdaad-1d10-4540-a980-ff24ed2f2a64
        config: {}
        dataType: NUMBER(4,0)
        description: ""
        name: PRD
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 09886366-c4dd-4872-afbd-987a57f907d5
                stepCounter: a6664eba-bfce-4e3e-aa7b-50312cb6cd43
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ec265608-7c16-4736-822d-ec2a3476d1a0
          stepCounter: a29fdaad-1d10-4540-a980-ff24ed2f2a64
        config: {}
        dataType: VARCHAR(16)
        description: ""
        name: ORDER_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7ffdff86-2c8b-46c7-a040-7b6301c4c4e8
                stepCounter: a6664eba-bfce-4e3e-aa7b-50312cb6cd43
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0a589d8b-eaf1-4e55-bb87-cc75a7a25a64
          stepCounter: a29fdaad-1d10-4540-a980-ff24ed2f2a64
        config: {}
        dataType: VARCHAR(8)
        description: ""
        name: TYPE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3a2292b0-c635-46cf-9e41-cddea2ebb553
                stepCounter: 27720352-8ff5-4e56-8f86-14485d69316e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8ea07c41-8423-46ea-9163-ff446e979402
          stepCounter: a29fdaad-1d10-4540-a980-ff24ed2f2a64
        config: {}
        dataType: DATE
        description: ""
        name: ORDER_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d6d7fa53-5f88-44ed-ae12-5ea01cc38576
                stepCounter: a6664eba-bfce-4e3e-aa7b-50312cb6cd43
            transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 864113bd-ee02-4ec9-b785-634d609853c8
          stepCounter: a29fdaad-1d10-4540-a980-ff24ed2f2a64
        config: {}
        dataType: VARCHAR(32)
        defaultValue: ""
        description: ""
        keyColumnType: None
        name: ORDER_TYPE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: |-
              CASE
                  WHEN RIGHT("STG_PR_GROUP"."DESCRIPTION",9) IN ('- FREIGHT') THEN SUBSTRING("STG_PR_GROUP"."DESCRIPTION",1,LEN("STG_PR_GROUP"."DESCRIPTION")-10)
                  WHEN RIGHT("STG_PR_GROUP"."DESCRIPTION",8) IN ('- FREIGH') THEN SUBSTRING("STG_PR_GROUP"."DESCRIPTION",1,LEN("STG_PR_GROUP"."DESCRIPTION")-9)
                  WHEN RIGHT("STG_PR_GROUP"."DESCRIPTION",7) IN ('- FREIG') THEN SUBSTRING("STG_PR_GROUP"."DESCRIPTION",1,LEN("STG_PR_GROUP"."DESCRIPTION")-8)
                  WHEN RIGHT("STG_PR_GROUP"."DESCRIPTION",6) IN ('- FREI') THEN SUBSTRING("STG_PR_GROUP"."DESCRIPTION",1,LEN("STG_PR_GROUP"."DESCRIPTION")-7)
                  WHEN RIGHT("STG_PR_GROUP"."DESCRIPTION",5) IN ('- FRE') THEN SUBSTRING("STG_PR_GROUP"."DESCRIPTION",1,LEN("STG_PR_GROUP"."DESCRIPTION")-6)
                  WHEN RIGHT("STG_PR_GROUP"."DESCRIPTION",4) IN ('- FR') THEN SUBSTRING("STG_PR_GROUP"."DESCRIPTION",1,LEN("STG_PR_GROUP"."DESCRIPTION")-5)
                  WHEN RIGHT("STG_PR_GROUP"."DESCRIPTION",3) IN ('- F') THEN SUBSTRING("STG_PR_GROUP"."DESCRIPTION",1,LEN("STG_PR_GROUP"."DESCRIPTION")-4)
                  WHEN RIGHT("STG_PR_GROUP"."DESCRIPTION",2) IN ('- ') THEN SUBSTRING("STG_PR_GROUP"."DESCRIPTION",1,LEN("STG_PR_GROUP"."DESCRIPTION")-3)
                  WHEN RIGHT("STG_PR_GROUP"."DESCRIPTION",1) IN ('-') THEN SUBSTRING("STG_PR_GROUP"."DESCRIPTION",1,LEN("STG_PR_GROUP"."DESCRIPTION")-2)
                  ELSE "STG_PR_GROUP"."DESCRIPTION"
              END
        systemColumnType: None
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 43fb7f51-99ea-4b9e-ae41-165275e0b8d1
          stepCounter: a29fdaad-1d10-4540-a980-ff24ed2f2a64
        config: {}
        dataType: VARCHAR(60)
        defaultValue: ""
        description: ""
        keyColumnType: None
        name: SHIP_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ffdbabf6-7115-40d7-8dd5-e5a6f0711410
                stepCounter: 27720352-8ff5-4e56-8f86-14485d69316e
            transform: "\"STG_JOB\".\"NAME\""
        systemColumnType: None
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 7fc32de6-1b81-44f2-aa94-ecb62b6e9bbb
          stepCounter: a29fdaad-1d10-4540-a980-ff24ed2f2a64
        config: {}
        dataType: VARCHAR(32)
        defaultValue: ""
        description: ""
        keyColumnType: None
        name: SHIP_CITY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0d1475d4-44df-4ab3-bfea-b027b0210bde
                stepCounter: 27720352-8ff5-4e56-8f86-14485d69316e
            transform: ""
        systemColumnType: None
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 0cd0c8d3-69f4-4b7d-be0e-7ac3fd2e64ab
          stepCounter: a29fdaad-1d10-4540-a980-ff24ed2f2a64
        config: {}
        dataType: VARCHAR(32)
        defaultValue: ""
        description: ""
        keyColumnType: None
        name: SHIP_STATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d2f56137-3338-48cf-96c6-cf3ed95efa5a
                stepCounter: 27720352-8ff5-4e56-8f86-14485d69316e
            transform: ""
        systemColumnType: None
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 3f92723d-a49d-4876-97f8-c47618526206
          stepCounter: a29fdaad-1d10-4540-a980-ff24ed2f2a64
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: ""
        keyColumnType: None
        name: BOOKINGS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: "\"STG_BOOKINGS_TJ\".\"SALE_AMT\" * \"STG_JOB_ORDER\".\"FIELD_6\" / 100"
        systemColumnType: None
    cteString: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          STG_BOOKINGS_TJ: a6664eba-bfce-4e3e-aa7b-50312cb6cd43
          STG_JOB: 27720352-8ff5-4e56-8f86-14485d69316e
          STG_JOB_ORDER: 21b6706f-2ac8-4bac-801b-8121fee9a187
          STG_JOB_TYPE: 22ec5440-d364-4300-a552-c74cc32143bd
          STG_PR_GROUP: ff14b386-d96c-4cb6-ac64-244703e4ef8e
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: RMH_SQL_SERVER_SERVICE_STG
            nodeName: STG_BOOKINGS_TJ
          - locationName: RMH_SQL_SERVER_SERVICE_STG
            nodeName: STG_JOB
          - locationName: RMH_SQL_SERVER_SERVICE_STG
            nodeName: STG_JOB_ORDER
          - locationName: RMH_SQL_SERVER_SERVICE_STG
            nodeName: STG_JOB_TYPE
          - locationName: RMH_SQL_SERVER_SERVICE_STG
            nodeName: STG_PR_GROUP
          - locationName: RMH_SQL_SERVER_SERVICE_STG
            nodeName: STG_SALESPER
        join:
          joinCondition: |-
            FROM {{ ref('RMH_SQL_SERVER_SERVICE_STG', 'STG_JOB_ORDER') }} "STG_JOB_ORDER"
            INNER JOIN {{ ref('RMH_SQL_SERVER_SERVICE_STG', 'STG_BOOKINGS_TJ') }} "STG_BOOKINGS_TJ"
            ON "STG_JOB_ORDER"."JOB_NO" = "STG_BOOKINGS_TJ"."ORDER_NO"
            INNER JOIN {{ ref('RMH_SQL_SERVER_SERVICE_STG', 'STG_JOB') }} "STG_JOB"
            ON "STG_JOB_ORDER"."JOB_NO" = "STG_JOB"."JOB_NO"
            INNER JOIN {{ ref('RMH_SQL_SERVER_SERVICE_STG', 'STG_JOB_TYPE') }} "STG_JOB_TYPE"
            ON "STG_JOB"."TYPE_CODE" = "STG_JOB_TYPE"."TYPE_CODE"
            INNER JOIN {{ ref('RMH_SQL_SERVER_SERVICE_STG', 'STG_PR_GROUP') }} "STG_PR_GROUP"
            ON "STG_JOB"."TYPE_CODE" = "STG_PR_GROUP"."PROD_GROUP"
            --LEFT OUTER JOIN {{ ref('RMH_SQL_SERVER_SERVICE_STG', 'STG_SALESPER') }} "STG_SALESPER"
            --ON "STG_JOB_ORDER"."FIELD_1" = "STG_SALESPER"."SLSPN_NAME"
        name: STG_BOOKINGS_BR_JOB_SLSPN1
        noLinkRefs: []
  name: STG_BOOKINGS_BR_JOB_SLSPN1
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node

fileVersion: 1
id: 9bb7512e-3ed2-4f9d-b247-efd9cf96e76b
name: STG_SALES_JO_W_CALCULATIONS
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: RMH_SQL_SERVER_SERVICE_STG
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 14cd3d93-87fd-417c-8f0f-c9635ee75863
          stepCounter: 9bb7512e-3ed2-4f9d-b247-efd9cf96e76b
        config: {}
        dataType: VARCHAR(16)
        description: ""
        name: JOB_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a3c2008b-896d-40e1-8f57-e1faca3e2a93
                stepCounter: 0483ff8b-a0ef-4de3-9f39-8831dc2b27da
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: aa6ee32a-03db-4f87-a353-d3a8c8133336
          stepCounter: 9bb7512e-3ed2-4f9d-b247-efd9cf96e76b
        config: {}
        dataType: TIMESTAMP_NTZ(9)
        description: ""
        name: CREATEDDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3f91897a-4e74-4628-bb93-61257763095d
                stepCounter: 0483ff8b-a0ef-4de3-9f39-8831dc2b27da
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6e6db2b6-f586-4035-8cd9-0dbe4630f492
          stepCounter: 9bb7512e-3ed2-4f9d-b247-efd9cf96e76b
        config: {}
        dataType: VARCHAR(60)
        description: ""
        name: SHIP_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 02567ac1-8b21-4de5-8436-635cbf5a7fbe
                stepCounter: 0483ff8b-a0ef-4de3-9f39-8831dc2b27da
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1e36be7d-e31e-41d2-90e1-88506dbe2911
          stepCounter: 9bb7512e-3ed2-4f9d-b247-efd9cf96e76b
        config: {}
        dataType: VARCHAR(50)
        description: ""
        name: SHIP_COMPLETE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 35107fa4-3275-40f9-a588-e35951106782
                stepCounter: 0483ff8b-a0ef-4de3-9f39-8831dc2b27da
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 96ba5f58-f3c0-4877-9a67-9ebca5d03dff
          stepCounter: 9bb7512e-3ed2-4f9d-b247-efd9cf96e76b
        config: {}
        dataType: VARCHAR(40)
        description: ""
        name: SHIP_COUNTRY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: fb3bc54e-2ff4-480f-a0d0-248fd33e4259
                stepCounter: 0483ff8b-a0ef-4de3-9f39-8831dc2b27da
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0b4e3c45-328f-4b98-a7b4-77d5f0cadaee
          stepCounter: 9bb7512e-3ed2-4f9d-b247-efd9cf96e76b
        config: {}
        dataType: VARCHAR(10)
        description: ""
        name: SHIP_STATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6ef168a8-ee0f-4cd0-b353-b3192470e894
                stepCounter: 0483ff8b-a0ef-4de3-9f39-8831dc2b27da
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9caec696-4434-4cd1-9419-687dd4855782
          stepCounter: 9bb7512e-3ed2-4f9d-b247-efd9cf96e76b
        config: {}
        dataType: VARCHAR(20)
        description: ""
        name: SHIP_ZIP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a8241fac-9bd9-47b2-8198-789aea33451e
                stepCounter: 0483ff8b-a0ef-4de3-9f39-8831dc2b27da
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3539a0e9-ddca-4ef1-9bed-a1d6f41ed81f
          stepCounter: 9bb7512e-3ed2-4f9d-b247-efd9cf96e76b
        config: {}
        dataType: VARCHAR(40)
        description: ""
        name: SHIP_CITY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 270e6ba0-0187-4965-b9aa-6ad93e826297
                stepCounter: 0483ff8b-a0ef-4de3-9f39-8831dc2b27da
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 42521848-e84c-465c-bf86-17403cd9d24b
          stepCounter: 9bb7512e-3ed2-4f9d-b247-efd9cf96e76b
        config: {}
        dataType: NUMBER(15,2)
        description: ""
        name: GROSS_AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d7b045f9-9c6e-476d-8bc7-e5a0c1771b1b
                stepCounter: 0483ff8b-a0ef-4de3-9f39-8831dc2b27da
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2934e7e3-8ca7-4d46-9215-174f7ee3c382
          stepCounter: 9bb7512e-3ed2-4f9d-b247-efd9cf96e76b
        config: {}
        dataType: NUMBER(16,2)
        description: ""
        name: CREDIT_AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8814e9f3-0fcd-402b-a1f2-a4c369cc1547
                stepCounter: 0483ff8b-a0ef-4de3-9f39-8831dc2b27da
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 96cddd2e-678d-46d4-b51a-c58cea636efe
          stepCounter: 9bb7512e-3ed2-4f9d-b247-efd9cf96e76b
        config: {}
        dataType: VARCHAR(40)
        description: ""
        name: SOURCE_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7f2b8e91-820d-4e00-9c9e-254538807c43
                stepCounter: 0483ff8b-a0ef-4de3-9f39-8831dc2b27da
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8517ee7c-0472-4f2c-93ad-28473bd88f0f
          stepCounter: 9bb7512e-3ed2-4f9d-b247-efd9cf96e76b
        config: {}
        dataType: NUMBER(38,2)
        description: ""
        name: GL_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 495cef36-5fb9-4e51-af59-26c4fae1e06b
                stepCounter: 0483ff8b-a0ef-4de3-9f39-8831dc2b27da
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 53876cae-4fa6-43b0-8552-36675b9ab1df
          stepCounter: 9bb7512e-3ed2-4f9d-b247-efd9cf96e76b
        config: {}
        dataType: NUMBER(16,2)
        description: ""
        name: DEBIT_AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4ef57846-9ad0-4a61-b3cd-55d66bfae66f
                stepCounter: 0483ff8b-a0ef-4de3-9f39-8831dc2b27da
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ae892209-7a8a-46ee-af8e-2f3be1b01a2f
          stepCounter: 9bb7512e-3ed2-4f9d-b247-efd9cf96e76b
        config: {}
        dataType: TIMESTAMP_NTZ(9)
        description: ""
        name: ATIME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a800b0df-c218-4bff-8cbb-5ad43f69ba8a
                stepCounter: 0483ff8b-a0ef-4de3-9f39-8831dc2b27da
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ba7e3ab1-74b6-4e15-987c-5b7ad5aabc83
          stepCounter: 9bb7512e-3ed2-4f9d-b247-efd9cf96e76b
        config: {}
        dataType: TIMESTAMP_NTZ(9)
        description: ""
        name: JO_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 436a6339-0d87-4f1e-871c-b801a573aa4f
                stepCounter: 0483ff8b-a0ef-4de3-9f39-8831dc2b27da
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 450a14c8-be15-462e-a6c1-805355352ebc
          stepCounter: 9bb7512e-3ed2-4f9d-b247-efd9cf96e76b
        config: {}
        dataType: VARCHAR(16)
        description: ""
        name: CUST_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 275925b7-5280-46e3-8ce8-8e9a9fb31c57
                stepCounter: 0483ff8b-a0ef-4de3-9f39-8831dc2b27da
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d20ffb21-0dec-46f7-a97a-5e3336358925
          stepCounter: 9bb7512e-3ed2-4f9d-b247-efd9cf96e76b
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: SEQ_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: be31dc6e-f383-4cf5-a91e-b96a5578b1fa
                stepCounter: 0483ff8b-a0ef-4de3-9f39-8831dc2b27da
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 188c1f4a-da12-40e1-a79b-8bf59eb833c0
          stepCounter: 9bb7512e-3ed2-4f9d-b247-efd9cf96e76b
        config: {}
        dataType: VARCHAR(2000)
        description: ""
        name: FIELD_7
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 72675527-15ae-4ca5-b189-7dde842ad25b
                stepCounter: 0483ff8b-a0ef-4de3-9f39-8831dc2b27da
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dbf4ce6e-0489-415c-b20c-da265c3869dd
          stepCounter: 9bb7512e-3ed2-4f9d-b247-efd9cf96e76b
        config: {}
        dataType: VARCHAR(8)
        description: ""
        name: ITEM_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a1dac8bc-b878-4615-a304-8fb8cb723399
                stepCounter: 0483ff8b-a0ef-4de3-9f39-8831dc2b27da
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8c2c6cf0-af85-4079-a205-ea579e403742
          stepCounter: 9bb7512e-3ed2-4f9d-b247-efd9cf96e76b
        config: {}
        dataType: VARCHAR(8)
        description: ""
        name: PROD_GROUP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 055e8d28-621f-472f-b6d8-c6317f9b9d07
                stepCounter: 0483ff8b-a0ef-4de3-9f39-8831dc2b27da
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 635705b3-5e36-45b0-8c57-880803136eba
          stepCounter: 9bb7512e-3ed2-4f9d-b247-efd9cf96e76b
        config: {}
        dataType: VARCHAR(50)
        description: ""
        name: DESCRIPTION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c0323ac0-1e97-45db-8f69-9a2c184887f8
                stepCounter: 0483ff8b-a0ef-4de3-9f39-8831dc2b27da
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c8625c03-f16a-4eab-b22e-dab2c542ad2a
          stepCounter: 9bb7512e-3ed2-4f9d-b247-efd9cf96e76b
        config: {}
        dataType: VARCHAR(44)
        description: ""
        name: SLSPN_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: eef7f284-bbf9-4b97-a7f9-a63e79ba7389
                stepCounter: 0483ff8b-a0ef-4de3-9f39-8831dc2b27da
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d4642c3c-5cde-4dad-8387-76d39f3f68bc
          stepCounter: 9bb7512e-3ed2-4f9d-b247-efd9cf96e76b
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: PRD
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5cc65ae3-e633-438a-b46d-b54b61a936fd
                stepCounter: 0483ff8b-a0ef-4de3-9f39-8831dc2b27da
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 342cb980-e2f1-453a-9d19-29f06ab1a001
          stepCounter: 9bb7512e-3ed2-4f9d-b247-efd9cf96e76b
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: YR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7568815d-faeb-495d-9692-6a1fb94ba498
                stepCounter: 0483ff8b-a0ef-4de3-9f39-8831dc2b27da
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: e446ba4d-a185-4384-8326-b5a5cd27be14
          stepCounter: 9bb7512e-3ed2-4f9d-b247-efd9cf96e76b
        config: {}
        dataType: TIMESTAMP_NTZ(9)
        description: ""
        name: GL_CREATEDDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4a7831ea-f1a8-4afe-b39f-dfd625414528
                stepCounter: 0483ff8b-a0ef-4de3-9f39-8831dc2b27da
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 60082170-9e5e-409e-896b-6d5e78a1d97d
          stepCounter: 9bb7512e-3ed2-4f9d-b247-efd9cf96e76b
        config: {}
        dataType: NUMBER(15,2)
        description: ""
        name: EDF
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3f42069e-52ed-4978-bd4a-e320088cc962
                stepCounter: 0483ff8b-a0ef-4de3-9f39-8831dc2b27da
            transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: e40e7695-f7a8-40b1-b656-0f9504c26506
          stepCounter: 9bb7512e-3ed2-4f9d-b247-efd9cf96e76b
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: ""
        keyColumnType: None
        name: REVENUE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: |
              CASE 
                  WHEN "SOURCE_CODE" = 'SA' OR
                  ("SOURCE_CODE" = 'CS' AND "GL_CODE" BETWEEN 40000 and 49999)
                  THEN ("CREDIT_AMT" - "DEBIT_AMT") * ("STG_SALES_JO_TRANSACTIONS"."COMM_ALLOCATION" / 100)
                  ELSE 0
              END
        systemColumnType: None
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: cf4fa027-49c6-4def-9802-385ed119d4cd
          stepCounter: 9bb7512e-3ed2-4f9d-b247-efd9cf96e76b
        config: {}
        dataType: NUMBER(38,2)
        defaultValue: ""
        description: ""
        keyColumnType: None
        name: TOTAL_COST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: |-
              CASE 
                  WHEN "SOURCE_CODE" = 'CS' AND "GL_CODE" NOT BETWEEN 40000 and 49999
                  THEN "DEBIT_AMT" - "CREDIT_AMT"
                  ELSE 0
              END
        systemColumnType: None
    cteString: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          STG_SALES_JO_TRANSACTIONS: d40723b3-287c-4e05-8876-482e52254957
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: RMH_SQL_SERVER_SERVICE_STG
            nodeName: STG_SALES_JO_TRANSACTIONS
        join:
          joinCondition: |
            FROM {{ ref('RMH_SQL_SERVER_SERVICE_STG', 'STG_SALES_JO_TRANSACTIONS') }} "STG_SALES_JO_TRANSACTIONS"
        name: STG_SALES_JO_W_CALCULATIONS
        noLinkRefs: []
  name: STG_SALES_JO_W_CALCULATIONS
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node

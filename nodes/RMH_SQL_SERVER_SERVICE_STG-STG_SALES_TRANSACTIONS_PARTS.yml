fileVersion: 1
id: c03e5a0a-2a00-488b-88b6-1b36b73df046
name: STG_SALES_TRANSACTIONS_PARTS
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: RMH_SQL_SERVER_SERVICE_STG
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 3becbb1a-38f0-4a6c-a1f9-844135cabfee
          stepCounter: c03e5a0a-2a00-488b-88b6-1b36b73df046
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: ORDER_NO
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 43e4aaef-031c-40d5-8150-618320a86a10
                stepCounter: baf88c36-1be1-415d-9501-0d76524ba4f0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7ce1a739-61ae-4c3b-830d-5a3cd7e973a5
          stepCounter: c03e5a0a-2a00-488b-88b6-1b36b73df046
        config: {}
        dataType: TIMESTAMP_NTZ(9)
        description: ""
        name: CREATEDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 918e3e58-0435-4d9f-9adc-c19e4a1cfefc
                stepCounter: baf88c36-1be1-415d-9501-0d76524ba4f0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6a2cc868-bf2d-4dec-b38e-41c13e5f73f8
          stepCounter: c03e5a0a-2a00-488b-88b6-1b36b73df046
        config: {}
        dataType: VARCHAR(100)
        description: ""
        name: SHIP_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8b1504d3-2232-4566-82e3-5487b5f732c0
                stepCounter: baf88c36-1be1-415d-9501-0d76524ba4f0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6135b501-50e6-4e6f-9b94-f83e9bcdaecb
          stepCounter: c03e5a0a-2a00-488b-88b6-1b36b73df046
        config: {}
        dataType: BOOLEAN
        description: ""
        name: SHIP_COMPLETE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a226cf23-a0ab-4a6e-ba80-4c1f4bc20ee5
                stepCounter: baf88c36-1be1-415d-9501-0d76524ba4f0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0e4528e7-4ba7-4156-885f-4d91962985c3
          stepCounter: c03e5a0a-2a00-488b-88b6-1b36b73df046
        config: {}
        dataType: VARCHAR(80)
        description: ""
        name: SHIP_COUNTRY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9f2f38e1-5676-4f83-a56c-0fca6f5016a2
                stepCounter: baf88c36-1be1-415d-9501-0d76524ba4f0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a8e236f0-d9f0-421c-b1d4-61bcc5a97b48
          stepCounter: c03e5a0a-2a00-488b-88b6-1b36b73df046
        config: {}
        dataType: VARCHAR(10)
        description: ""
        name: SHIP_ST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bd2114b5-5c4f-41ce-9be4-996f7b3bd035
                stepCounter: baf88c36-1be1-415d-9501-0d76524ba4f0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a7559d99-2be0-4d8b-a7aa-7781a66be5c6
          stepCounter: c03e5a0a-2a00-488b-88b6-1b36b73df046
        config: {}
        dataType: VARCHAR(20)
        description: ""
        name: SHIP_ZIP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 351f7378-e0f8-41a7-9fe0-602e2ca781d6
                stepCounter: baf88c36-1be1-415d-9501-0d76524ba4f0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 538f4a98-9932-4fee-ba9b-742805abca1f
          stepCounter: c03e5a0a-2a00-488b-88b6-1b36b73df046
        config: {}
        dataType: VARCHAR(40)
        description: ""
        name: SHIP_CITY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ce15d226-67de-4673-ba80-dab86db6b2b6
                stepCounter: baf88c36-1be1-415d-9501-0d76524ba4f0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c05bd2f4-280a-4ec5-96cf-41c2aa440f66
          stepCounter: c03e5a0a-2a00-488b-88b6-1b36b73df046
        config: {}
        dataType: NUMBER(16,2)
        description: ""
        name: GROSS_AMT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 312411d9-bd6b-40f8-ae3d-373003a29379
                stepCounter: baf88c36-1be1-415d-9501-0d76524ba4f0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 037e8d04-6a22-4a18-9eb8-787a9a0379b4
          stepCounter: c03e5a0a-2a00-488b-88b6-1b36b73df046
        config: {}
        dataType: VARCHAR(8)
        description: ""
        name: SLSPN_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6d89690c-3540-4e15-8047-d6cd6f2ce387
                stepCounter: baf88c36-1be1-415d-9501-0d76524ba4f0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a369a523-61a9-4d56-b8e1-e78e1e51a292
          stepCounter: c03e5a0a-2a00-488b-88b6-1b36b73df046
        config: {}
        dataType: VARCHAR(40)
        description: ""
        name: SLSPN_NAME
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: "'Parts'"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 271eed67-5f58-4030-9ae2-c0b3462a074f
          stepCounter: c03e5a0a-2a00-488b-88b6-1b36b73df046
        config: {}
        dataType: VARCHAR(10)
        description: ""
        name: ATIME
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a1f67142-819a-4fc6-8804-a9e9dc8dbf37
                stepCounter: baf88c36-1be1-415d-9501-0d76524ba4f0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4692356c-0db2-46ef-b9d9-c653f977c849
          stepCounter: c03e5a0a-2a00-488b-88b6-1b36b73df046
        config: {}
        dataType: VARCHAR(16)
        description: ""
        name: JOB_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5e4e6bf6-96d8-4342-b546-e7b2698e6b55
                stepCounter: baf88c36-1be1-415d-9501-0d76524ba4f0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0cd3dfb3-2174-4922-af55-3c64ba3a2566
          stepCounter: c03e5a0a-2a00-488b-88b6-1b36b73df046
        config: {}
        dataType: TIMESTAMP_NTZ(9)
        description: ""
        name: ORDER_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 458687ad-3755-4da3-ad40-8734922a4f98
                stepCounter: baf88c36-1be1-415d-9501-0d76524ba4f0
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d04cbed3-0934-496d-9cdf-15ba34d84e0a
          stepCounter: c03e5a0a-2a00-488b-88b6-1b36b73df046
        config: {}
        dataType: VARCHAR(12)
        description: ""
        name: VENDOR_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1d6f2f94-8c2e-4dca-a7e9-d83c30f6177f
                stepCounter: 1b7e4ba2-1e35-469e-89a2-8f4a4c0b58a7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 46fdbb59-a388-43e3-9a98-31dd17686eb4
          stepCounter: c03e5a0a-2a00-488b-88b6-1b36b73df046
        config: {}
        dataType: VARCHAR(16)
        description: ""
        name: CUST_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7f23fd79-0e60-409e-80e7-c944e58f588b
                stepCounter: 1b7e4ba2-1e35-469e-89a2-8f4a4c0b58a7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b983c71b-936f-4386-89d2-72d111559ffd
          stepCounter: c03e5a0a-2a00-488b-88b6-1b36b73df046
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: SEQ_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a8c4811f-bd99-4ffa-9f9a-cbb1fad82302
                stepCounter: 1b7e4ba2-1e35-469e-89a2-8f4a4c0b58a7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f07ee844-df37-4da9-b2aa-34986a80ac86
          stepCounter: c03e5a0a-2a00-488b-88b6-1b36b73df046
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: QTY_SHIPPED
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bc179312-bbf8-46e1-8630-81dfe942a37f
                stepCounter: 1b7e4ba2-1e35-469e-89a2-8f4a4c0b58a7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d024d009-2274-4962-b890-a03dd2de7fb8
          stepCounter: c03e5a0a-2a00-488b-88b6-1b36b73df046
        config: {}
        dataType: NUMBER(17,4)
        description: ""
        name: COST
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 15e4d3da-897b-4db5-a8eb-1208d3fe9ac5
                stepCounter: 1b7e4ba2-1e35-469e-89a2-8f4a4c0b58a7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5ec7c253-4380-4fc9-a97c-4b42bc3ef9a1
          stepCounter: c03e5a0a-2a00-488b-88b6-1b36b73df046
        config: {}
        dataType: VARCHAR(40)
        description: ""
        name: FIELD_7
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8bc87336-715d-468a-86cf-8ea8c556781f
                stepCounter: 1b7e4ba2-1e35-469e-89a2-8f4a4c0b58a7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 34ed35c4-f0d7-4cad-a50d-487c065f766b
          stepCounter: c03e5a0a-2a00-488b-88b6-1b36b73df046
        config: {}
        dataType: VARCHAR(40)
        description: ""
        name: COMM_ALLOCATION
        nullable: true
        sourceColumnReferences:
          - columnReferences: []
            transform: "100"
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c264dbc2-cb28-43b5-a6fd-60240a94a408
          stepCounter: c03e5a0a-2a00-488b-88b6-1b36b73df046
        config: {}
        dataType: VARCHAR(32)
        description: ""
        name: ITEM_NO
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 974ab70c-0540-4cbc-a99b-349922af02d7
                stepCounter: 1b7e4ba2-1e35-469e-89a2-8f4a4c0b58a7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 62e8d119-15b6-4b4c-b91c-6306e1036837
          stepCounter: c03e5a0a-2a00-488b-88b6-1b36b73df046
        config: {}
        dataType: VARCHAR(8)
        description: ""
        name: UOM_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cee26fac-b398-4f3e-a497-167f606e056b
                stepCounter: 1b7e4ba2-1e35-469e-89a2-8f4a4c0b58a7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ed35d4af-1c6f-46d4-ba7a-2bdc85b65b91
          stepCounter: c03e5a0a-2a00-488b-88b6-1b36b73df046
        config: {}
        dataType: VARCHAR(8)
        description: ""
        name: COMM_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dece6967-3546-4830-a44c-6833267df59a
                stepCounter: 1b7e4ba2-1e35-469e-89a2-8f4a4c0b58a7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: dba6d75f-b893-4649-b30b-d49765e589a7
          stepCounter: c03e5a0a-2a00-488b-88b6-1b36b73df046
        config: {}
        dataType: NUMBER(7,2)
        description: ""
        name: COMM_RATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1d8b7293-0d0f-42c6-b115-84ce3ed2c583
                stepCounter: 1b7e4ba2-1e35-469e-89a2-8f4a4c0b58a7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c6d290d8-ac6b-4689-a31a-e9d9dc66d5e2
          stepCounter: c03e5a0a-2a00-488b-88b6-1b36b73df046
        config: {}
        dataType: NUMBER(19,4)
        description: ""
        name: NET_PRICE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 61065fa5-37bd-4234-99e6-15057be6f868
                stepCounter: 1b7e4ba2-1e35-469e-89a2-8f4a4c0b58a7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d9f10b36-a78f-459b-ba5d-7bd09f7b5b66
          stepCounter: c03e5a0a-2a00-488b-88b6-1b36b73df046
        config: {}
        dataType: VARCHAR(256)
        description: ""
        name: ITEM_VENDOR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c3ed559e-b40c-4b67-bc25-696972ea5853
                stepCounter: 1b7e4ba2-1e35-469e-89a2-8f4a4c0b58a7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: ef670f84-e355-4b1c-bc4e-1f8e52d79f4a
          stepCounter: c03e5a0a-2a00-488b-88b6-1b36b73df046
        config: {}
        dataType: NUMBER(18,4)
        description: ""
        name: GROSS_PRICE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c0c83dec-8de0-424e-940f-01b52dfbc8d4
                stepCounter: 1b7e4ba2-1e35-469e-89a2-8f4a4c0b58a7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1dac424c-910e-4805-88a9-709bc4085247
          stepCounter: c03e5a0a-2a00-488b-88b6-1b36b73df046
        config: {}
        dataType: VARCHAR(8)
        description: ""
        name: INVOICE_SLSPN_CODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cd9dbb1d-8880-4b0a-9677-43729e2377f9
                stepCounter: 1b7e4ba2-1e35-469e-89a2-8f4a4c0b58a7
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0bfbad0f-1447-41ed-afc6-803cde004eaf
          stepCounter: c03e5a0a-2a00-488b-88b6-1b36b73df046
        config: {}
        dataType: VARCHAR(16)
        description: ""
        name: DOCUMENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 50a190be-262d-4c92-bd7f-570852dafe00
                stepCounter: b4ffac55-8cb6-480d-8822-bda521cdbf24
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 92f643df-ee26-4ae7-8e28-3076ba8a80c6
          stepCounter: c03e5a0a-2a00-488b-88b6-1b36b73df046
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: PRD
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c302ecdf-e32a-432f-8038-249b61cecb63
                stepCounter: b4ffac55-8cb6-480d-8822-bda521cdbf24
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 293b0494-785c-4b33-8a8c-70d14fc5ebcd
          stepCounter: c03e5a0a-2a00-488b-88b6-1b36b73df046
        config: {}
        dataType: TIMESTAMP_NTZ(9)
        description: ""
        name: INVOICE_DATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 22e127a7-0aa6-4c7b-a794-c5e1c4d60a4f
                stepCounter: b4ffac55-8cb6-480d-8822-bda521cdbf24
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1c9e1169-8558-42ce-9958-4a889541b5e3
          stepCounter: c03e5a0a-2a00-488b-88b6-1b36b73df046
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: UNIT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c9be4938-4130-4718-8f77-a7cfd9513504
                stepCounter: 85deb06d-fa39-4a43-886a-872cc4b5d22d
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 21a721b9-9c3d-45be-9631-3e8ad41c0efc
          stepCounter: c03e5a0a-2a00-488b-88b6-1b36b73df046
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: YR
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 36cafd48-cc34-4688-9216-054f118dde94
                stepCounter: b4ffac55-8cb6-480d-8822-bda521cdbf24
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fb08fe6b-73e2-42a3-8247-69f318ecb796
          stepCounter: c03e5a0a-2a00-488b-88b6-1b36b73df046
        config: {}
        dataType: VARCHAR(8)
        description: ""
        name: PROD_GROUP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e2eecae4-12d4-4837-8a16-1ad76223ecdc
                stepCounter: cad668ae-9b21-4063-b9da-af244d04642b
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 866ea1dd-f530-4626-b152-2b679fcabfd1
          stepCounter: c03e5a0a-2a00-488b-88b6-1b36b73df046
        config: {}
        dataType: VARCHAR(8)
        description: ""
        name: PR_PROD_GROUP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8accbf1e-0807-47ed-b0d9-3a38b774188e
                stepCounter: ff14b386-d96c-4cb6-ac64-244703e4ef8e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4e5af175-1296-4d37-b0df-071af9ec2391
          stepCounter: c03e5a0a-2a00-488b-88b6-1b36b73df046
        config: {}
        dataType: VARCHAR(50)
        description: ""
        name: DESCRIPTION
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1c7c3504-2fa8-401d-955d-d8071abed474
                stepCounter: ff14b386-d96c-4cb6-ac64-244703e4ef8e
            transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: dc72431c-c0e6-4f9b-9843-28432930ae03
          stepCounter: c03e5a0a-2a00-488b-88b6-1b36b73df046
        config: {}
        dataType: NUMBER(15,2)
        defaultValue: ""
        description: ""
        keyColumnType: None
        name: EDF
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: |-
              CASE
                  WHEN "STG_INVOICE"."ORDER_NO" IN ('135367') AND "STG_UOM"."UNIT" = '100' AND LEFT("STG_ITEM"."PROD_GROUP",3) IN ('100','146','171','147','172','173','174','175','176','177','178','179','183','184','185','186','187','188','189','190','400','402','404','406','408','411','412','414','416','420','424','426','427','448','550','551','552') THEN ("STG_INVOICE_LINE"."QTY_SHIPPED" / CAST(100 AS NUMERIC(10,2))) * "STG_INVOICE_LINE"."COST" * 1.5 / 100
                  WHEN "STG_INVOICE"."ORDER_NO" IN ('135367') AND "STG_UOM"."UNIT" <> '100' AND LEFT("STG_ITEM"."PROD_GROUP",3) IN ('100','146','171','147','172','173','174','175','176','177','178','179','183','184','185','186','187','188','189','190','400','402','404','406','408','411','412','414','416','420','424','426','427','448','550','551','552') THEN ("STG_INVOICE_LINE"."QTY_SHIPPED" / CAST(100 AS NUMERIC(10,2))) * "STG_INVOICE_LINE"."COST" * 1.5 / 100
                  WHEN "STG_ORDER"."CREATEDATE" < '01/01/2025' THEN 0
                  WHEN "STG_UOM"."UNIT" = '100' AND LEFT("STG_ITEM"."PROD_GROUP",3) IN ('180','181') THEN (("STG_INVOICE_LINE"."QTY_SHIPPED"  / CAST(100 AS NUMERIC(10,2))) * "STG_INVOICE_LINE"."NET_PRICE") * 2 / 100
                  WHEN "STG_UOM"."UNIT" <> '100' AND LEFT("STG_ITEM"."PROD_GROUP",3) IN ('180','181') THEN ("STG_INVOICE_LINE"."QTY_SHIPPED"  * "STG_INVOICE_LINE"."NET_PRICE") * 2 / 100
                  WHEN "STG_UOM"."UNIT" = '100' AND LEFT("STG_ITEM"."PROD_GROUP",3) IN ('100','146','171','147','172','173','174','175','176','177','178','179','183','184','185','186','187','188','189','190','400','402','404','406','408','411','412','414','416','420','424','426','427','448','550','551','552') THEN (("STG_INVOICE_LINE"."QTY_SHIPPED"  / CAST(100 AS NUMERIC(10,2))) * "STG_INVOICE_LINE"."NET_PRICE") * 1 / 100
                  WHEN "STG_UOM"."UNIT" <> '100' AND LEFT("STG_ITEM"."PROD_GROUP",3) IN ('100','146','171','147','172','173','174','175','176','177','178','179','183','184','185','186','187','188','189','190','400','402','404','406','408','411','412','414','416','420','424','426','427','448','550','551','552') THEN ("STG_INVOICE_LINE"."QTY_SHIPPED"  * "STG_INVOICE_LINE"."NET_PRICE") * 1 / 100
                  WHEN "STG_ORDER"."CREATEDATE" > '11/14/2025' AND "STG_UOM"."UNIT" = '100' AND LEFT("STG_ITEM"."PROD_GROUP",3) IN ('326') THEN ("STG_INVOICE_LINE"."QTY_SHIPPED" / CAST(100 AS NUMERIC(10,2))) * "STG_INVOICE_LINE"."COST" * 2 / 100
                  WHEN "STG_ORDER"."CREATEDATE" > '11/14/2025' AND "STG_UOM"."UNIT" <> '100' AND LEFT("STG_ITEM"."PROD_GROUP",3) IN ('326') THEN ("STG_INVOICE_LINE"."QTY_SHIPPED"  * "STG_INVOICE_LINE"."NET_PRICE") * 2 / 100
                  ELSE 0 
              END
        systemColumnType: None
    cteString: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          STG_INVOICE: b4ffac55-8cb6-480d-8822-bda521cdbf24
          STG_INVOICE_LINE: 1b7e4ba2-1e35-469e-89a2-8f4a4c0b58a7
          STG_ITEM: cad668ae-9b21-4063-b9da-af244d04642b
          STG_ORDER: baf88c36-1be1-415d-9501-0d76524ba4f0
          STG_PR_GROUP: ff14b386-d96c-4cb6-ac64-244703e4ef8e
          STG_UOM: 85deb06d-fa39-4a43-886a-872cc4b5d22d
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: RMH_SQL_SERVER_SERVICE_STG
            nodeName: STG_INVOICE
          - locationName: RMH_SQL_SERVER_SERVICE_STG
            nodeName: STG_INVOICE_LINE
          - locationName: RMH_SQL_SERVER_SERVICE_STG
            nodeName: STG_ITEM
          - locationName: RMH_SQL_SERVER_SERVICE_STG
            nodeName: STG_ORDER
          - locationName: RMH_SQL_SERVER_SERVICE_STG
            nodeName: STG_PR_GROUP
          - locationName: RMH_SQL_SERVER_SERVICE_STG
            nodeName: STG_UOM
        join:
          joinCondition: |-
            FROM {{ ref('RMH_SQL_SERVER_SERVICE_STG', 'STG_ORDER') }} "STG_ORDER"
            LEFT JOIN {{ ref('RMH_SQL_SERVER_SERVICE_STG', 'STG_INVOICE_LINE') }} "STG_INVOICE_LINE"
            ON "STG_INVOICE_LINE"."ORDER_NO" = "STG_ORDER"."ORDER_NO"
            LEFT JOIN {{ ref('RMH_SQL_SERVER_SERVICE_STG', 'STG_INVOICE') }} "STG_INVOICE"
            ON "STG_INVOICE_LINE"."SEQ_NO" = "STG_INVOICE"."SEQ_NO"
            LEFT JOIN {{ ref('RMH_SQL_SERVER_SERVICE_STG', 'STG_ITEM') }} "STG_ITEM"
            ON "STG_INVOICE_LINE"."ITEM_NO" = "STG_ITEM"."ITEM_NO"
            LEFT JOIN {{ ref('RMH_SQL_SERVER_SERVICE_STG', 'STG_PR_GROUP') }} "STG_PR_GROUP"
            ON "STG_ITEM"."PROD_GROUP" = "STG_PR_GROUP"."PROD_GROUP"
            LEFT JOIN {{ ref('RMH_SQL_SERVER_SERVICE_STG', 'STG_UOM') }} "STG_UOM"
            ON "STG_INVOICE_LINE"."UOM_CODE" = "STG_UOM"."UOM_CODE"

            WHERE "STG_PR_GROUP"."PROD_GROUP" IN ('103', '103F', '199', '199F', '331', '331F', '333', '333F', '399', '399F', '450', '450F', '453', '453F', '490', '490F', '499', '499F')
        name: STG_SALES_TRANSACTIONS_PARTS
        noLinkRefs: []
  name: STG_SALES_TRANSACTIONS_PARTS
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
